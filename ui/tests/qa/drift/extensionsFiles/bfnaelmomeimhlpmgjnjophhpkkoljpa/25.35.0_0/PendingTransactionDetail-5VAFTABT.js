import{a as R,c as Ve}from"./chunk-PSHZSAJN.js";import{a as Ge}from"./chunk-AX6TAEMW.js";import"./chunk-D54DG5S6.js";import{s as Z,u as Ne,w as Ae,ya as He}from"./chunk-XZRRLELF.js";import"./chunk-HTEWVCFR.js";import"./chunk-5F2VOKO3.js";import"./chunk-VTQFUHCP.js";import{s as k}from"./chunk-MOTGUR2H.js";import"./chunk-J26VE65N.js";import"./chunk-KKMQB65C.js";import"./chunk-7JKUY6KU.js";import"./chunk-YY4B3XV7.js";import"./chunk-L2LS7YZE.js";import"./chunk-GROXNBTY.js";import"./chunk-OZFKX4E3.js";import"./chunk-57E56ETC.js";import"./chunk-HO6FHTKM.js";import"./chunk-H6IC2DCX.js";import"./chunk-WF3NVBQY.js";import{g as O}from"./chunk-TALMQQTZ.js";import"./chunk-WSJ272XI.js";import{a as de}from"./chunk-S32BDL22.js";import{a as Be}from"./chunk-GQ5HEJWI.js";import"./chunk-KGWRBMZX.js";import"./chunk-BSK64RRL.js";import"./chunk-BUTFRTU6.js";import{c as Fe}from"./chunk-HX3WMS5S.js";import{P as ge,rc as Ue}from"./chunk-ZYPI3ESJ.js";import"./chunk-6EZHAYJL.js";import"./chunk-BRQKCECY.js";import"./chunk-YOO3KN23.js";import"./chunk-YITPJN7X.js";import"./chunk-CQIC5IDD.js";import{p as be}from"./chunk-BHIJKWN7.js";import"./chunk-6N4GZCP2.js";import"./chunk-5OF7XKWY.js";import"./chunk-5AA7BGLC.js";import{Aa as ve,Ca as W,Q as Ee,Xa as Ie,ca as Q,ga as Se,ha as De,qa as ke,xa as ce}from"./chunk-QSYOXIBV.js";import"./chunk-O7KQ5SYD.js";import"./chunk-V76BEUYF.js";import"./chunk-3U4MKOCV.js";import"./chunk-63PE5ZXT.js";import{a as Y,d as L}from"./chunk-ZTFOFBVC.js";import{B as pe,R as Me,db as S,m as f,p as le,q as me}from"./chunk-FVUSQHVT.js";import"./chunk-HUS6FTFG.js";import"./chunk-NCSBB2TA.js";import"./chunk-4BKJE7YB.js";import"./chunk-KY4L2TTE.js";import"./chunk-W47K3OCY.js";import{a as we,c as $}from"./chunk-25TPEQ2Q.js";import"./chunk-E7B2SEGG.js";import"./chunk-XD32MQ4W.js";import{Kb as Pe,R as Ce,Rb as z,_a as ne}from"./chunk-LHPEWMJX.js";import{aa as H,g as A,i as G,o as V}from"./chunk-HTY647YJ.js";import{Nd as it,gf as N,mc as J,xb as P}from"./chunk-E2A6YDRV.js";import{S as q,u as se}from"./chunk-4XTMHWN2.js";import{X as M,c as ae,cb as X,ya as s}from"./chunk-BEUYJGED.js";import"./chunk-3C334UTS.js";import"./chunk-3JLWNHUO.js";import"./chunk-KHOMEOLW.js";import{f as oe,h as B,n as F}from"./chunk-64CIGK2X.js";B();F();var a=oe(ae());B();F();var T=oe(ae());var st=f.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: scroll;
`,ct=f.div`
  flex: 1;
  padding-top: 20px;
  padding-bottom: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
`,lt=f(S)`
  margin-top: 20px;
  margin-bottom: 20px;
`,mt=f(S)`
  margin-top: 16px;
`,pt=f.div`
  margin-top: 16px;
  padding-bottom: 20px;
`,Le=({pendingTransaction:e,onSuccess:i})=>{let{t:o}=M(),[g,n]=(0,T.useState)(void 0),{popDetailView:u}=O(),t=e.networkID,p=P.getAddressType(t),I=e.data.transactions[e.data.transactions.length-1],{data:c}=N(),{data:r,status:v}=ce(e,()=>u(),c),{data:y}=Q(t,r),w=y?.gasEstimationPriceUSD??"",{data:D}=H(),U=[];if(D){let x=D.explorers[t]??A.get(t).defaultExplorer,d=V({networkID:t,endpoint:"transaction",explorerType:x,param:I.hash});d!==""&&U.push({label:o("richTransactionDetailViewOnExplorer",{explorer:G[x]}),value:d,type:"link"})}let{data:b,status:_}=W(t,r?.maxFeePerGas,r?.maxPriorityFeePerGas),h=z(o,_,b),E=[{label:o("richTransactionDetailNetworkFee"),value:w.length>0?o("gasUpTo",{amount:w}):T.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},{label:o("transactionEstimatedTime"),value:h!==""?h:T.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},...U],{mutateAsync:C}=be(),ee=(0,T.useCallback)(async()=>{if(!c||!r)return;let x=c.addresses.find(d=>d.networkID===t);if(x){e.type==="cancel"?$.capture("transactionPrioritizeCancelConfirmClicked",{data:{chainID:t,chainType:p}}):$.capture("transactionCancelConfirmClicked",{data:{chainID:t,chainType:p}});try{n("inflight");let d=Ie({ethereumNetworkID:t,sender:x.address,destination:x.address,value:new q("0",10),nonce:e.data.nonce});await C({multichainTransaction:{networkID:t,unsignedTransaction:d},pendingTransactionInput:{networkID:t,pendingTransactionId:e.id,hash:"",unsignedTransaction:se.parse({from:e.ownerAddress})},senderAddress:x,gasEstimation:r}),u(),i(),n(void 0)}catch(d){J.captureError(d,"transaction"),n("error")}}},[c,t,p,e,r,C,u,i]);return T.default.createElement(st,null,T.default.createElement(ct,null,T.default.createElement(Ne,{image:{type:"icon",preset:"x-bold"},size:64}),T.default.createElement(lt,{size:28,weight:600},e.type==="cancel"?o("transactionPrioritizeCancel"):o("transactionCancel")),T.default.createElement(R,{rows:E}),g!=="error"&&T.default.createElement(mt,{lineHeight:16,color:s.colors.legacy.textDiminished,size:14},o("transactionCancelHelperText")),g==="error"&&T.default.createElement(pt,null,T.default.createElement(Z,{color:s.colors.legacy.spotNegative,title:T.default.createElement(S,{color:s.colors.legacy.spotNegative,lineHeight:16,size:14,weight:400},o("transactionReplaceError"))}))),T.default.createElement(L,{onSecondaryClicked:()=>u(),onPrimaryClicked:ee,primaryTheme:"warning",primaryText:g==="inflight"?T.default.createElement(Y,{trackColor:s.colors.legacy.spotNegative,color:"white",diameter:20}):o("commandConfirm"),primaryDisabled:!r?.maxFeePerGas||v==="error",secondaryText:o("commandClose")}))};B();F();var Oe=oe(it()),l=oe(ae());var ft=f.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: scroll;
`,ut=f.div`
  flex: 1;
  padding-top: 20px;
  padding-bottom: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
`,gt=f(S)`
  margin-top: 20px;
  margin-bottom: 20px;
`,Tt=f(S)`
  margin-top: 16px;
`,xt=f.div`
  margin-top: 16px;
  padding-bottom: 20px;
`,ht=({size:e})=>l.default.createElement(me,{size:e},l.default.createElement(le,{shape:"circle",color:de(s.colors.legacy.spotPositive,.1)},l.default.createElement(pe,{width:32}))),_e=({pendingTransaction:e,onSuccess:i})=>{let{t:o}=M(),[g,n]=(0,l.useState)(void 0),{popDetailView:u}=O(),t=e.networkID,{data:p}=N(),{data:I,status:c}=Ee({networkID:t}),r=I?.fast,v=ne.get(t).transactionSpeedSeconds("fast"),{data:y}=H(),w=[];if(y){let h=y.explorers[t]??A.get(t).defaultExplorer,E=V({networkID:t,endpoint:"transaction",explorerType:h,param:e.data.txID});E!==""&&w.push({label:o("richTransactionDetailViewOnExplorer",{explorer:G[h]}),value:E,type:"link"})}let D=z(o,c,v?{timeToMineSeconds:v}:void 0),U=[{label:o("richTransactionDetailNetworkFee"),value:r?`${Ce(r.btcPerKilobyte)} sats/vB`:l.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},{label:o("transactionEstimatedTime"),value:D!==""?D:l.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},...w],b=ke(),_=(0,l.useCallback)(async()=>{if(!p||!r?.btcPerKilobyte)return;let h=p.addresses.filter(C=>C.networkID===t),E=h[0];h.length>1&&(E=h.find(C=>C.addressType==="bip122_p2wpkh")),$.capture("transactionSpeedUpConfirmClicked",{data:{chainID:t}});try{n("inflight"),await Pe(Ue(),{addressType:E.addressType,accountIdentifier:p.identifier,pendingTransaction:e,pendingTransactionInput:{...(0,Oe.default)(e)},desiredFeeRateInBtcPerKilobyte:r.btcPerKilobyte,safeToSendUtxos:await b.getSafeToSendUtxos(E.address),utxoManager:b},new we),u(),i(),n(void 0)}catch(C){J.captureError(C,"transaction"),n("error")}},[p,t,e,r?.btcPerKilobyte,u,i,b]);return l.default.createElement(ft,null,l.default.createElement(ut,null,l.default.createElement(ht,{size:64}),l.default.createElement(gt,{size:28,weight:600},o("transactionSpeedUp")),l.default.createElement(R,{rows:U}),g!=="error"&&l.default.createElement(Tt,{lineHeight:16,color:s.colors.legacy.textDiminished,size:14},o("transactionSpeedUplHelperText")),g==="error"&&l.default.createElement(xt,null,l.default.createElement(Z,{color:s.colors.legacy.spotNegative,title:l.default.createElement(S,{color:s.colors.legacy.spotNegative,lineHeight:16,size:14,weight:400},o("transactionReplaceError"))}))),l.default.createElement(L,{onSecondaryClicked:()=>u(),onPrimaryClicked:_,primaryText:g==="inflight"?l.default.createElement(Y,{color:"white",diameter:20}):o("commandConfirm"),primaryDisabled:c==="error"&&!r?.btcPerKilobyte,secondaryText:o("commandClose")}))};B();F();var m=oe(ae());var yt=f.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: scroll;
`,Ct=f.div`
  flex: 1;
  padding-top: 20px;
  padding-bottom: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
`,Pt=f(S)`
  margin-top: 20px;
  margin-bottom: 20px;
`,wt=f(S)`
  margin-top: 16px;
`,Et=f.div`
  margin-top: 16px;
  padding-bottom: 20px;
`,St=({size:e})=>m.default.createElement(me,{size:e},m.default.createElement(le,{shape:"circle",color:de(s.colors.legacy.spotPositive,.1)},m.default.createElement(pe,{width:32}))),Ke=({pendingTransaction:e,onSuccess:i})=>{let{t:o}=M(),[g,n]=(0,m.useState)(void 0),{popDetailView:u}=O(),t=e.networkID,p=P.getAddressType(t),I=e.data.transactions[e.data.transactions.length-1],{data:c}=N(),{data:r,status:v}=ce(e,()=>u(),c),{data:y}=Q(t,r),w=y?.gasEstimationPriceUSD??"",{data:D}=H(),U=[];if(D){let x=D.explorers[t]??A.get(t).defaultExplorer,d=V({networkID:t,endpoint:"transaction",explorerType:x,param:I.hash});d!==""&&U.push({label:o("richTransactionDetailViewOnExplorer",{explorer:G[x]}),value:d,type:"link"})}let{data:b,status:_}=W(t,r?.maxFeePerGas,r?.maxPriorityFeePerGas),h=z(o,_,b),E=[{label:o("richTransactionDetailNetworkFee"),value:w.length>0?o("gasUpTo",{amount:w}):m.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},{label:o("transactionEstimatedTime"),value:h!==""?h:m.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},...U],{mutateAsync:C}=ve(),ee=(0,m.useCallback)(async()=>{if(!(!c||!r||!c.addresses.find(d=>d.networkID===t))){$.capture("transactionSpeedUpConfirmClicked",{data:{chainID:t,chainType:p}});try{n("inflight"),await C({chainType:"eip155",accountIdentifier:c.identifier,pendingTransaction:e,pendingTransactionInput:{networkID:t,pendingTransactionId:e.id,hash:"",unsignedTransaction:se.parse({from:e.ownerAddress})},gasEstimation:r,nonce:e.data.nonce}),u(),i(),n(void 0)}catch(d){J.captureError(d,"transaction"),n("error")}}},[c,t,p,e,r,C,i,u]);return m.default.createElement(yt,null,m.default.createElement(Ct,null,m.default.createElement(St,{size:64}),m.default.createElement(Pt,{size:28,weight:600},o("transactionSpeedUp")),m.default.createElement(R,{rows:E}),g!=="error"&&m.default.createElement(wt,{lineHeight:16,color:s.colors.legacy.textDiminished,size:14},o("transactionSpeedUplHelperText")),g==="error"&&m.default.createElement(Et,null,m.default.createElement(Z,{color:s.colors.legacy.spotNegative,title:m.default.createElement(S,{color:s.colors.legacy.spotNegative,lineHeight:16,size:14,weight:400},o("transactionReplaceError"))}))),m.default.createElement(L,{onSecondaryClicked:()=>u(),onPrimaryClicked:ee,primaryText:g==="inflight"?m.default.createElement(Y,{color:"white",diameter:20}):o("commandConfirm"),primaryDisabled:!r?.maxFeePerGas||v==="error",secondaryText:o("commandClose")}))};var Dt=e=>{let{networkID:i}=e,[o,g]=(0,a.useState)(Date.now());(0,a.useEffect)(()=>{let K=setInterval(()=>g(Date.now()),5e3);return()=>clearInterval(K)},[g]);let{t:n}=M(),{pushDetailView:u}=O(),{handleHideModalVisibility:t}=He(),p=(0,a.useCallback)(()=>t("pendingTransaction"),[t]),{data:I}=N(),{data:c}=De(I?.addresses||[]),r=c?.pendingTransaction.filter(K=>e.networkID===K.networkID),v=r?r[r.length-1]?.id:void 0,y=ne.get(e.networkID).isPendingTransactionConfirmed(e),w=!1,D=e.type??"dappInteraction",U=Ge(e.timestamp??0,n("richTransactionDetailAt")),{header:b,assetSymbol:_,tokenUSDPrice:h,uiRecipient:E,logoUri:C}=(0,a.useMemo)(()=>({header:e.display.detail?.header??"",assetSymbol:e.display.detail?.assetSymbol??"",tokenUSDPrice:e.display.detail?.tokenUSDPrice??"",uiRecipient:e.display.detail?.uiRecipient??"",logoUri:e.display.detail?.logoUri??""}),[e]),ee=P.getNetworkName(i),x="",d=s.colors.legacy.textDiminished;y?w?(x=n("transactionsFailed"),d=s.colors.legacy.spotNegative):(x=n("transactionsSuccess"),d=s.colors.legacy.spotPositive):e.type==="cancel"?(x=n("pendingTransactionCancelling"),d=s.colors.legacy.spotNegative):x=n("pendingTransactionPending");let te;if("transactions"in e.data&&P.isEVMNetworkID(i)){let j=e.data.transactions[e.data.transactions.length-1].unsignedTransaction,ie=new q(j.maxFeePerGas??"0"),rt=new q(j.maxPriorityFeePerGas??"0");te={networkID:i,gasLimit:new q(j.gas??"0"),maxFeePerGas:ie,maxPriorityFeePerGas:rt},w=!!e.data?.transactions?.[e.data?.transactions?.length-1]?.error}let{data:je}=Q(i,te),Xe=n("gasUpTo",{amount:je?.gasEstimationPriceUSD}),{data:$e,status:qe}=W(i,te?.maxFeePerGas,te?.maxPriorityFeePerGas),xe=z(n,qe,$e),{data:he}=H(),ye=[];if(he){let K=he.explorers[i]??A.get(i).defaultExplorer,j="";P.isEVMNetworkID(e.networkID)&&"transactions"in e.data&&(j=e.data.transactions[e.data.transactions.length-1].hash),P.isBitcoinNetworkID(e.networkID)&&(j=e.data.txID);let ie=V({networkID:i,endpoint:"transaction",explorerType:K,param:j});ie!==""&&ye.push({label:n("richTransactionDetailViewOnExplorer",{explorer:G[K]}),value:ie,type:"link"})}let Je=P.getNetworkName(i),Qe={label:n("pendingTransactionDate"),value:U},We={label:n("pendingTransactionStatus"),value:x,color:d},Ye={label:n("transactionsTo"),value:E??""},Ze={label:n("historyNetwork"),value:ee},Re={label:n("pendingTransactionNetworkFee"),value:Xe,tooltipContent:n("networkFeesTooltipDescription",{chainName:Je})},et={label:n("pendingTransactionEstimatedTime"),value:xe!==""?xe:a.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished}),tooltipContent:n("sendFungibleSummaryEstimatedTimeDescription")},fe=a.default.createElement(Ae,{pendingTransactionType:D,isError:w,isConfirmed:y,logoUri:C,size:"medium"}),re,tt=!y&&ge.get(i).showFeeRowInPendingTransactionDetail,ot=ge.get(i).showTimeToMineRowInPendingTransactionDetail&&!y,nt=e.display.detail?.secondaryHeader,ue=[Qe,We,Ye,Ze,...tt?[Re]:[],...ot?[et]:[],...ye];switch(D){case"send":{re={sections:[{rows:ue}],title:y?n("richTransactionDetailSent"):n("pendingTransactionsSendingTitle",{assetSymbol:_}),primaryText:{value:b},secondaryText:{value:h},image:fe};break}case"cancel":{re={sections:[{rows:ue}],title:n(y?"transactionCancelled":"pendingTransactionCancelling"),primaryText:{value:b},secondaryText:{value:h},image:fe};break}case"dappInteraction":default:{re={sections:[{rows:ue}],title:n(y?"richTransactionDetailAppInteraction":"pendingTransactionPendingInteraction"),primaryText:{value:""},secondaryText:{value:nt??n("pendingTransactionUnknownApp")},image:fe};break}}return{detailsProps:re,pendingTransaction:e,isOldestPendingTx:v===e.id,leftButton:a.default.createElement(kt,{onClick:p},a.default.createElement(Me,null)),showCancelEvmTransactionModal:()=>{u(a.default.createElement(Le,{onSuccess:p,pendingTransaction:e}))},showSpeedUpEvmTransactionModal:()=>{u(a.default.createElement(Ke,{onSuccess:p,pendingTransaction:e}))},showSpeedUpBitcoinTransactionModal:()=>{u(a.default.createElement(_e,{onSuccess:p,pendingTransaction:e}))},hidePendingTransactionModal:p,now:o}},kt=f(Fe)`
  position: absolute;
  left: 5px;
`,vt=({pendingTransaction:e})=>{let i=Dt(e);return a.default.createElement(It,{...i})},bt=({pendingTransactionId:e})=>{let{data:i}=Se(e),[o,g]=(0,a.useState)();return(0,a.useEffect)(()=>{i&&g(i)},[i]),o?a.default.createElement(vt,{pendingTransaction:o}):null},kn=bt,It=a.default.memo(({detailsProps:e,showCancelEvmTransactionModal:i,showSpeedUpEvmTransactionModal:o,showSpeedUpBitcoinTransactionModal:g,hidePendingTransactionModal:n,leftButton:u,pendingTransaction:t,isOldestPendingTx:p,now:I})=>{let{t:c}=M(),r=a.default.createElement(X,{onClick:n},c("commandClose"));if(t&&(p||t.type!=="cancel")&&!ne.get(t.networkID).isPendingTransactionMined(t)){if(P.isPolygonNetworkID(t.networkID)){t=t;let v=t.data.transactions[t.data.transactions.length-1];I-v.timestamp>6e4&&(t.type==="cancel"?r=a.default.createElement(X,{theme:"warning",onClick:i},c("transactionPrioritizeCancel")):r=a.default.createElement(X,{theme:"warning",onClick:i},c("pendingTransactionCancel")))}P.isEthereumNetworkID(t.networkID)&&(t.type==="cancel"?r=a.default.createElement(X,{theme:"warning",onClick:i},c("transactionPrioritizeCancel")):p?r=a.default.createElement(L,{primaryText:c("pendingTransactionSpeedUp"),secondaryText:c("pendingTransactionCancel"),onPrimaryClicked:o,onSecondaryClicked:i,primaryTheme:"default",secondaryTheme:"warning"}):r=a.default.createElement(X,{theme:"warning",onClick:i},c("pendingTransactionCancel"))),P.isBitcoinNetworkID(t.networkID)&&(r=a.default.createElement(X,{onClick:g},c("pendingTransactionSpeedUp")))}return a.default.createElement(a.default.Fragment,null,a.default.createElement(Ve,{...e,leftButton:u}),a.default.createElement(Be,null,r))});export{bt as PendingTransactionDetail,kn as default};
//# sourceMappingURL=PendingTransactionDetail-5VAFTABT.js.map
