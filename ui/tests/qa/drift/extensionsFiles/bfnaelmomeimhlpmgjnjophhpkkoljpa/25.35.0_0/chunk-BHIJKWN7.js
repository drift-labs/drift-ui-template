import{A as hr,B as Tr,Ea as kr,Fa as Bt,M as br,Qa as Sr,Ua as _t,Va as Ve,Z as wr,Za as Ut,a as ot,ab as vr,b as ie,c as st,j as pr,ja as it,k as mr,n as fr,p as gr,qa as Ar,r as yr,ra as Rt,v as Le,w as z,x as H}from"./chunk-QSYOXIBV.js";import{e as Er,f as xr,g as Cr}from"./chunk-KY4L2TTE.js";import{$b as De,Ac as lr,Bc as dr,Db as tr,Hb as nr,Ib as rr,N as zn,Q as Hn,Qb as or,R as Jn,S as tt,T as Yn,U as Zn,V as nt,_a as Xn,bb as er,bc as sr,cc as Ot,ec as ir,fc as ar,hc as cr,uc as rt,yc as ur}from"./chunk-LHPEWMJX.js";import{aa as qn,g as $n,i as Gn,o as jn}from"./chunk-HTY647YJ.js";import{Bb as Un,Cb as Xe,Db as ee,Dc as Vn,Ec as Qn,Fc as Wn,Gb as xe,Gc as Kn,Ic as Z,Kc as re,Nc as q,Nd as ys,R as Rn,Rb as Nn,S as G,Td as I,X as Y,_ as ne,cg as Fe,ea as Ne,ec as Dn,gf as se,i as fs,jf as et,ma as Bn,mc as F,nd as Te,ub as _n,wc as he,x as gs,xb as L,yc as Ln}from"./chunk-E2A6YDRV.js";import{R as B,u as On}from"./chunk-4XTMHWN2.js";import{X as oe,c as D,f as ye,l as p}from"./chunk-BEUYJGED.js";import{f as U,h as l,i as y,m as Buffer,n as d}from"./chunk-64CIGK2X.js";l();d();var hs=0;function k(e,t){let n=`atom${++hs}`,r={toString(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?r.read=e:(r.init=e,r.read=Ts,r.write=bs),t&&(r.write=t),r}function Ts(e){return e(this)}function bs(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}var Pr=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,Dt=e=>"init"in e,Nt=e=>!!e.write,ct=new WeakMap,Lt=e=>{var t;return Vt(e)&&!((t=ct.get(e))!=null&&t[1])},ws=(e,t)=>{let n=ct.get(e);if(n)n[1]=!0,n[0].forEach(r=>r(t));else if((import.meta.env?import.meta.env.MODE:void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},As=e=>{if(ct.has(e))return;let t=[new Set,!1];ct.set(e,t);let n=()=>{t[1]=!0};e.then(n,n),e.onCancel=r=>{t[0].add(r)}},Vt=e=>typeof e?.then=="function",Ir=e=>"v"in e||"e"in e,at=e=>{if("e"in e)throw e.e;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},Fr=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},ks=(e,t,n,r)=>{var o;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&n===e)throw new Error("[Bug] atom cannot depend on itself");t.d.set(n,r.n),Lt(t.v)&&Fr(e,t.v,r),(o=r.m)==null||o.t.add(e)},Ss=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),Mr=(...e)=>{let[t,n,r,o,s,a]=e,i=A=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!A)throw new Error("Atom is undefined or null");let T=t(A);return T||(T={d:new Map,p:new Set,n:0},n(A,T),s?.(A,Ee)),T},u=new WeakMap,c=new Map,m=new Set,f=new Set,g=()=>{var A;let T=[],S=w=>{try{w()}catch(v){T.push(v)}};do{(A=Ee[Ss])==null||A.call(Ee);let w=new Set,v=w.add.bind(w);c.forEach(E=>{var P;return(P=E.m)==null?void 0:P.l.forEach(v)}),c.clear(),m.forEach(v),m.clear(),f.forEach(v),f.clear(),w.forEach(S),c.size&&Q()}while(c.size||m.size||f.size);if(T.length)throw T[0]},h=(A,T,S)=>{let w="v"in T,v=T.v,E=Lt(T.v)?T.v:null;if(Vt(S)){As(S);for(let P of T.d.keys())Fr(A,S,i(P));T.v=S}else T.v=S;delete T.e,(!w||!Object.is(v,T.v))&&(++T.n,E&&ws(E,S))},b=A=>{var T;let S=i(A);if(Ir(S)&&(S.m&&u.get(A)!==S.n||Array.from(S.d).every(([O,me])=>b(O).n===me)))return S;S.d.clear();let w=!0,v=()=>{S.m&&(ve(A,S),Q(),g())},E=O=>{if(Pr(A,O)){let Mt=i(O);if(!Ir(Mt))if(Dt(O))h(O,Mt,O.init);else throw new Error("no atom init");return at(Mt)}let me=b(O);try{return at(me)}finally{ks(A,S,O,me),w||v()}},P,R,j={get signal(){return P||(P=new AbortController),P.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!Nt(A)&&console.warn("setSelf function cannot be used with read-only atom"),!R&&Nt(A)&&(R=(...O)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&w&&console.warn("setSelf function cannot be called in sync"),!w)return ge(A,...O)}),R}};try{let O=r(A,E,j);return h(A,S,O),Vt(O)&&((T=O.onCancel)==null||T.call(O,()=>P?.abort()),O.then(v,v)),S}catch(O){return delete S.v,S.e=O,++S.n,S}finally{w=!1}},C=A=>at(b(A)),M=A=>{var T;let S=new Map;for(let w of((T=A.m)==null?void 0:T.t)||[]){let v=i(w);v.m&&S.set(w,v)}for(let w of A.p)S.set(w,i(w));return S},_=A=>{let T=[A];for(;T.length;){let S=T.pop();for(let[w,v]of M(S))u.has(w)||(u.set(w,v.n),T.push(v))}},Q=()=>{var A;let T=[],S=new WeakSet,w=new WeakSet,v=Array.from(c);for(;v.length;){let[E,P]=v[v.length-1];if(w.has(E)){v.pop();continue}if(S.has(E)){u.get(E)===P.n?T.push([E,P,P.n]):(u.delete(E),c.set(E,P)),w.add(E),v.pop();continue}S.add(E);for(let[R,j]of M(P))S.has(R)||v.push([R,j])}for(let E=T.length-1;E>=0;--E){let[P,R,j]=T[E],O=!1;for(let me of R.d.keys())if(me!==P&&c.has(me)){O=!0;break}O&&(b(P),ve(P,R),j!==R.n&&(c.set(P,R),(A=R.u)==null||A.call(R))),u.delete(P)}},$=(A,...T)=>{let S=!0,w=E=>at(b(E)),v=(E,...P)=>{var R;let j=i(E);try{if(Pr(A,E)){if(!Dt(E))throw new Error("atom not writable");let O=j.n,me=P[0];h(E,j,me),ve(E,j),O!==j.n&&(c.set(E,j),(R=j.u)==null||R.call(j),_(j));return}else return $(E,...P)}finally{S||(Q(),g())}};try{return o(A,w,v,...T)}finally{S=!1}},ge=(A,...T)=>{try{return $(A,...T)}finally{Q(),g()}},ve=(A,T)=>{var S;if(T.m&&!Lt(T.v)){for(let[w,v]of T.d)if(!T.m.d.has(w)){let E=i(w);le(w,E).t.add(A),T.m.d.add(w),v!==E.n&&(c.set(w,E),(S=E.u)==null||S.call(E),_(E))}for(let w of T.m.d||[])if(!T.d.has(w)){T.m.d.delete(w);let v=W(w,i(w));v?.t.delete(A)}}},le=(A,T)=>{var S;if(!T.m){b(A);for(let w of T.d.keys())le(w,i(w)).t.add(A);if(T.m={l:new Set,d:new Set(T.d.keys()),t:new Set},(S=T.h)==null||S.call(T),Nt(A)){let w=T.m,v=()=>{let E=!0,P=(...R)=>{try{return $(A,...R)}finally{E||(Q(),g())}};try{let R=a(A,P);R&&(w.u=()=>{E=!0;try{R()}finally{E=!1}})}finally{E=!1}};f.add(v)}}return T.m},W=(A,T)=>{var S;if(T.m&&!T.m.l.size&&!Array.from(T.m.t).some(w=>{var v;return(v=i(w).m)==null?void 0:v.d.has(A)})){let w=T.m.u;w&&m.add(w),delete T.m,(S=T.h)==null||S.call(T);for(let v of T.d.keys()){let E=W(v,i(v));E?.t.delete(A)}return}return T.m},Ee={get:C,set:ge,sub:(A,T)=>{let S=i(A),v=le(A,S).l;return v.add(T),g(),()=>{v.delete(T),W(A,S),g()}},unstable_derive:A=>Mr(...A(...e))};return Ee},vs=e=>{let t=new Set,n,r=0,o=e.unstable_derive((...i)=>{let[u,c,,m]=i;return n=u,i[1]=function(g,h){c(g,h);let b=h.h;h.h=()=>{b?.(),h.m?t.add(g):t.delete(g)}},i[3]=function(g,h,b,...C){return r?b(g,...C):m(g,h,b,...C)},i}),s=o.set;return Object.assign(o,{dev4_get_internal_weak_map:()=>({get:i=>{let u=n(i);if(!(!u||u.n===0))return u}}),dev4_get_mounted_atoms:()=>t,dev4_restore_atoms:i=>{s({read:()=>null,write:(c,m)=>{++r;try{for(let[f,g]of i)Dt(f)&&m(f,g)}finally{--r}}})}})},Qt=()=>{let e=new WeakMap,t=Mr(n=>e.get(n),(n,r)=>e.set(n,r).get(n),(n,...r)=>n.read(...r),(n,...r)=>n.write(...r),(n,...r)=>{var o;return(o=n.unstable_onInit)==null?void 0:o.call(n,...r)},(n,...r)=>{var o;return(o=n.onMount)==null?void 0:o.call(n,...r)});return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?vs(t):t},Qe,Or=()=>(Qe||(Qe=Qt(),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Qe),globalThis.__JOTAI_DEFAULT_STORE__!==Qe&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Qe);l();d();var N=U(D(),1);var Br=(0,N.createContext)(void 0),_r=e=>{let t=(0,N.useContext)(Br);return e?.store||t||Or()},mc=({children:e,store:t})=>{let n=(0,N.useRef)(void 0);return!t&&!n.current&&(n.current=Qt()),(0,N.createElement)(Br.Provider,{value:t||n.current},e)},Kt=e=>typeof e?.then=="function",Ur=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},Es=N.default.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(Ur(e),e)}),Wt=new WeakMap,Rr=e=>{let t=Wt.get(e);return t||(t=new Promise((n,r)=>{let o=e,s=u=>c=>{o===u&&n(c)},a=u=>c=>{o===u&&r(c)},i=u=>{"onCancel"in u&&typeof u.onCancel=="function"&&u.onCancel(c=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&c===u)throw new Error("[Bug] p is not updated even after cancelation");Kt(c)?(Wt.set(c,t),o=c,c.then(s(c),a(c)),i(c)):n(c)})};e.then(s(e),a(e)),i(e)}),Wt.set(e,t)),t};function K(e,t){let n=_r(t),[[r,o,s],a]=(0,N.useReducer)(c=>{let m=n.get(e);return Object.is(c[0],m)&&c[1]===n&&c[2]===e?c:[m,n,e]},void 0,()=>[n.get(e),n,e]),i=r;(o!==n||s!==e)&&(a(),i=n.get(e));let u=t?.delay;if((0,N.useEffect)(()=>{let c=n.sub(e,()=>{if(typeof u=="number"){let m=n.get(e);Kt(m)&&Ur(Rr(m)),setTimeout(a,u);return}a()});return a(),c},[n,e,u]),(0,N.useDebugValue)(i),Kt(i)){let c=Rr(i);return Es(c)}return i}function We(e,t){let n=_r(t);return(0,N.useCallback)((...o)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...o)},[n,e])}function fc(e,t){return[K(e,t),We(e,t)]}l();d();var Cs=p.object({data:p.string(),from:p.string(),to:p.string()}),Ps=p.object({transaction:Cs});async function Is({caip19:e,amount:t,owner:n}){let r=await Y.api().post("/tokens/v1/unwrap",{owner:n,caip19:e,amount:t.toNumber()}),o=Ps.safeParse(r.data);if(!o.success){let{error:s}=o;throw F.captureError(s,"fungibles"),new Le(`Failed to get unwrap transaction: ${s.message}`)}return o.data.transaction}var Fs=({caip19:e,amount:t,owner:n})=>q({gcTime:ot.Medium,staleTime:1/0,enabled:n!==""&&t.isGreaterThan(0),queryKey:z.unwrapTransaction({caip19:e,amount:t,owner:n}),async queryFn(){return await Is({caip19:e,amount:t,owner:n})}});l();d();function Ms(){let e=Ln(),t=et(),n=Z();return re({async mutationFn({accountId:r,mutations:o}){await Tr(e,t,{accountId:r,mutations:o})},async onSuccess(r,o){await Promise.all([n.invalidateQueries({queryKey:z.hiddenMints(o.accountId)}),n.invalidateQueries({queryKey:H.visibilityOverrides({accountId:o.accountId})})])}})}l();d();var zt=U(ys());l();d();l();d();var V=[];for(let e=0;e<256;++e)V.push((e+256).toString(16).slice(1));function Nr(e,t=0){return(V[e[t+0]]+V[e[t+1]]+V[e[t+2]]+V[e[t+3]]+"-"+V[e[t+4]]+V[e[t+5]]+"-"+V[e[t+6]]+V[e[t+7]]+"-"+V[e[t+8]]+V[e[t+9]]+"-"+V[e[t+10]]+V[e[t+11]]+V[e[t+12]]+V[e[t+13]]+V[e[t+14]]+V[e[t+15]]).toLowerCase()}l();d();var $t,Os=new Uint8Array(16);function Gt(){if(!$t){if(typeof self.crypto>"u"||!self.crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");$t=self.crypto.getRandomValues.bind(self.crypto)}return $t(Os)}l();d();l();d();var Rs=typeof self.crypto<"u"&&self.crypto.randomUUID&&self.crypto.randomUUID.bind(self.crypto),jt={randomUUID:Rs};function Bs(e,t,n){if(jt.randomUUID&&!t&&!e)return jt.randomUUID();e=e||{};let r=e.random??e.rng?.()??Gt();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let o=0;o<16;++o)t[n+o]=r[o];return t}return Nr(r)}var qt=Bs;l();d();var ut={recipient:"",recipientHandle:"",addressBookRecipient:void 0,amountAsset:new B(0),amountUsd:0,transactionSpeed:"standard",solana:{references:[]},multichainTransaction:void 0},Dr=class extends Error{constructor(t){super(t),this.name="SendFungibleFlowError"}};var Lr={sendSessionId:"",encodedCaip19:void 0,fungibleKey:void 0,splTokenAccount:void 0,analyticsRecipient:void 0,sendFormValues:ut,shouldShowFiatValues:!1,retryArgs:void 0,confirmedFungibleAndSender:null,gasEstimation:void 0},Ht=Fe((e,t)=>({...(0,zt.default)(Lr),resetSendSlice:()=>{let n=(0,zt.default)(Lr);n.sendSessionId=qt(),e(n)},setAnalyticsRecipient:n=>{e({analyticsRecipient:n})},setSendFungibleKey:(n,r,o)=>{e({fungibleKey:n,splTokenAccount:r,encodedCaip19:o})},setSendFormValues:n=>{e({sendFormValues:n})},setInputAmount:n=>{let r=t();e({sendFormValues:{...r.sendFormValues,inputAmount:n}})},setShouldShowFiatValues:n=>{e({shouldShowFiatValues:n})},setRetryArgs:n=>{e({retryArgs:n})},setGasEstimation:n=>{e({gasEstimation:n})}}));l();d();var Vr={collectible:void 0,sendFormValues:ut,shouldRequireAmount:!1},_s=Fe(e=>({...Vr,resetSendSlice:()=>{e({...Vr})},setSendCollectible:t=>{e({collectible:t})},setSendFormValues:t=>{e({sendFormValues:t})},setShouldRequireAmount:t=>{e({shouldRequireAmount:t})}}));l();d();l();d();var Us={query:""},Ns=Fe(e=>({...Us,setQuery:t=>{e({query:t})}}));l();d();l();d();l();d();var lt=U(fs(),1),Wr=U(gs(),1);var Qr=(0,lt.struct)([(0,lt.u8)("instruction")]);function Kr(e,t,n,r=[],o=De){let s=cr([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],n,r),a=Buffer.alloc(Qr.span);return Qr.encode({instruction:ir.CloseAccount},a),new Wr.TransactionInstruction({keys:s,programId:o,data:a})}var Gr=U(D());var Ds=()=>{let{connection:e}=it(),{data:t}=se(),{solanaChainAddress:n,accountIdentifier:r}=(0,Gr.useMemo)(()=>({solanaChainAddress:t?.addresses.find(xe),accountIdentifier:t?.identifier??""}),[t]),o=he(),s=Te(),{t:a}=oe();return re({mutationFn:async i=>{if(!n)throw new Error("solanaChainAddress not loaded");if(i.type!=="CompressedSPL")throw new Error("SPL is not compressed");let u=await ur({owner:i.data.walletAddress,mint:i.data.mintAddress,amount:i.data.amount,programId:i.data.programId,connection:e}),{networkID:c,address:m}=n,f={ownerAddress:m,networkID:c,data:{signature:""},type:"decompress",display:{summary:{topLeft:{text:a("assetDetailClaiming")}}}};await rt({accountIdentifier:r,accountSigner:s,connection:e,feePayer:new G.PublicKey(m),pendingTransactionInput:f,storage:o,transaction:u,useSubmissionService:!1})}})};l();d();var Je=U(D());l();d();l();d();l();d();var Me=k(new Kn);function Jt(){return Jt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jt.apply(this,arguments)}y.NODE_ENV!=="production"&&(Me.debugPrivate=!0);var Ls=(e,t,n)=>e?.suspense&&Vs(t,n),Vs=(e,t)=>e.isPending&&!t,Qs=({result:e,throwOnError:t,query:n})=>e.isError&&!e.isFetching&&Ws(t,[e.error,n]);function Ws(e,t){return typeof e=="function"?e(...t):!!e}var Ks=e=>e.suspense&&typeof e.staleTime!="number"?Jt({},e,{staleTime:1e3}):e;function jr(e,t,n=r=>r(Me)){let r=k(0),o=k(n);y.NODE_ENV!=="production"&&(o.debugPrivate=!0);let s=k(()=>new WeakMap);y.NODE_ENV!=="production"&&(s.debugPrivate=!0);let a=k(c=>{let m=c(o),f=e(c),g=m.defaultQueryOptions(f),h=c(s).get(m);return g._optimisticResults="optimistic",h&&h.setOptions(g,{listeners:!1}),Ks(g)});y.NODE_ENV!=="production"&&(a.debugPrivate=!0);let i=k(c=>{let m=c(o),f=c(a),g=c(s),h=g.get(m);if(h)return h;let b=new t(m,f);return g.set(m,b),b});y.NODE_ENV!=="production"&&(i.debugPrivate=!0);let u=k(c=>{let m=c(i),f=c(a),g=m.getOptimisticResult(f),h=k(g);return y.NODE_ENV!=="production"&&(h.debugPrivate=!0),h.onMount=b=>{let C=m.subscribe(Vn.batchCalls(b));return()=>{m.getCurrentResult().isError&&m.getCurrentQuery().reset(),C()}},h});return y.NODE_ENV!=="production"&&(u.debugPrivate=!0),k(c=>{c(r);let m=c(i),f=c(a),g=c(c(u));if(Ls(f,g,!1))return m.fetchOptimistic(f);if(Qs({result:g,query:m.getCurrentQuery(),throwOnError:f.throwOnError}))throw g.error;return g},(c,m)=>{m(r,f=>f+1)})}function dt(e,t=n=>n(Me)){return jr(e,Qn,t)}function qr(e,t=n=>n(Me)){return jr(e,Wn,t)}l();d();var ol=Symbol((import.meta.env?import.meta.env.MODE:void 0)!=="production"?"RESET":"");var Yt=(e,t,n)=>(t.has(n)?t:t.set(n,e())).get(n),$s=new WeakMap,Gs=(e,t,n,r)=>{let o=Yt(()=>new WeakMap,$s,t),s=Yt(()=>new WeakMap,o,n);return Yt(e,s,r)};function X(e,t,n=Object.is){return Gs(()=>{let r=Symbol(),o=([a,i])=>{if(i===r)return t(a);let u=t(a,i);return n(i,u)?i:u},s=k(a=>{let i=a(s),u=a(e);return o([u,i])});return s.init=r,s},e,t,n)}var js=e=>typeof e?.then=="function";function qs(e=()=>{try{return self.localStorage}catch(n){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof self<"u"&&console.warn(n);return}},t){var n;let r,o,s={getItem:(u,c)=>{var m,f;let g=b=>{if(b=b||"",r!==b){try{o=JSON.parse(b,t?.reviver)}catch{return c}r=b}return o},h=(f=(m=e())==null?void 0:m.getItem(u))!=null?f:null;return js(h)?h.then(g):g(h)},setItem:(u,c)=>{var m;return(m=e())==null?void 0:m.setItem(u,JSON.stringify(c,t?.replacer))},removeItem:u=>{var c;return(c=e())==null?void 0:c.removeItem(u)}},a=u=>(c,m,f)=>u(c,g=>{let h;try{h=JSON.parse(g||"")}catch{h=f}m(h)}),i;try{i=(n=e())==null?void 0:n.subscribe}catch{}return!i&&typeof self<"u"&&typeof self.addEventListener=="function"&&self.Storage&&(i=(u,c)=>{if(!(e()instanceof self.Storage))return()=>{};let m=f=>{f.storageArea===e()&&f.key===u&&c(f.newValue)};return self.addEventListener("storage",m),()=>{self.removeEventListener("storage",m)}}),i&&(s.subscribe=a(i)),s}var sl=qs();l();d();l();d();l();d();var zs=e=>{let t=st(e);if(ie(t))return t==="BitcoinNative",t;if(t==="SPL"&&e.resourceType==="address"||t==="ERC20"&&e.resourceType==="address")return e.address;if(t==="BRC20"&&e.resourceType==="address")return`${e.address}-${Bn[0]}`;if(t==="SuiCoin"&&e.resourceType==="address")return e.address},zr=zs;function Hs({caip19:e,...t}){let n=Xe(e);return{...t,type:e.includes("/nativeToken:")?"native":"fungible",chainName:L.getChainName(n.chainId).toLowerCase(),encodedCaip19:e,decodedCaip19:n,legacyKey:zr(n)??e}}var Oe=Hs;var Js=p.object({account:p.string(),quantity:p.number(),quantityString:p.string()}),$e=p.object({address:p.string(),quantity:p.number(),quantityString:p.string(),lastTransferredDate:p.coerce.date().nullish(),subaccounts:p.array(Js).optional()}),Re=p.object({price:p.number(),priceChange24h:p.number().optional(),lastUpdatedAt:p.coerce.date(),marketCap:p.number().optional()}).nullish(),Zt=p.object({id:p.string(),name:p.string(),imageUri:p.string().nullish().transform(e=>e??""),numTokens:p.number()}),Ge=p.object({compression:p.object({compressed:p.boolean()}).optional(),creators:p.array(p.object({address:p.string(),share:p.number(),verified:p.boolean()})).nullish(),tokenProgram:p.string().nullish(),extensions:gr(yr).nullish()}),pt=p.enum(["TRUSTED","VERIFIED","NOT_VERIFIED","POSSIBLE_SPAM","SPAM"]),El=p.object({totalValueUsdCentsCurrent:p.number().optional(),totalValueUsdStringCurrent:p.string().optional(),totalValueUsdCents24h:p.number().optional(),totalValueUsdString24h:p.string().optional(),totalPercentChange24h:p.number().optional()}),Hr=p.object({name:p.string().nullish(),symbol:p.string().nullish(),decimals:p.number(),logoUri:p.string().nullish(),extraMetadata:Ge.optional(),price:Re}),mt=Hr.extend({type:p.enum(["native","fungible"]),encodedCaip19:p.string(),decodedCaip19:Un,spamStatus:pt,chainName:p.string(),legacyKey:p.string()}),Ys=Hr.extend({caip19:p.string(),spamStatus:pt.nullish().transform(e=>e??"NOT_VERIFIED")}),Jr=p.union([Ys.transform(e=>Oe(e)),mt]),xl=mt.extend({extraMetadata:Ge.extend({id:p.string().nullish().default(null),description:p.string().nullish().default(null),marketCap:p.coerce.number().optional(),circulatingSupply:p.coerce.number().optional(),totalSupply:p.coerce.number().optional(),liquidity:p.coerce.number().optional(),holders:p.coerce.number().optional(),links:p.array(p.object({type:p.string(),url:p.string()})).optional(),volume24hUSD:p.coerce.number().optional(),volume24hUSDChangePercentage:p.coerce.number().optional(),trades24h:p.coerce.number().optional(),trades24hChangePercentage:p.coerce.number().optional(),uniqueWallets24h:p.coerce.number().optional(),uniqueWallets24hChangePercentage:p.coerce.number().optional(),top10HoldersPercent:p.coerce.number().optional(),mintable:p.boolean().optional(),freezable:p.boolean().optional(),mutableMetadata:p.boolean().optional(),ownershipRenounced:p.boolean().optional(),updateAuthority:p.string().optional(),createdDate:p.string().datetime().nullish().default(null)}).optional(),categories:p.array(Zt),createdDate:p.coerce.date().nullish().default(null)}),Yr=mt.extend({totalQuantity:p.number(),totalQuantityString:p.string(),walletAddress:p.string().optional(),queriedWalletBalances:p.array($e),livePrice:Re}),Zr=mt.extend({timestamp:p.string().nullish(),totalQuantityString:p.string(),totalQuantity:p.number(),queriedWalletBalances:p.array($e)});l();d();l();d();l();d();function te(e){let t=k(0),n=k(()=>({i:0}),(u,c)=>{let m=u(n);return Object.assign(m,{m:!0,peek:u,set:c}),c(t,f=>f+1),()=>{m.m=!1,a(m),i(m)}});n.onMount=u=>u();let r=k(u=>{u(t);let c=u(n);if(!c.m||c.irc||c.i&&!c.irf)return c.p;i(c);let m=new Map,f=C=>{let M=u(C);return m.set(C,M),M};f.peek=c.peek;let g=(...C)=>{try{return++c.i,c.set(...C)}finally{Array.from(m.keys(),u),--c.i}};g.recurse=(C,...M)=>{if(c.fc){if(y.NODE_ENV!=="production")throw new Error("set.recurse is not allowed in cleanup");return}try{return c.irc=!0,c.set(C,...M)}finally{c.irc=!1,Array.from(m).some(h)&&s(c)}};function h([C,M]){return u(C)!==M}++c.i;function b(){try{if(c.irf=!1,!c.m)return;a(c),c.c=o.effect(f,g)}catch(C){c.e=C,s(c)}finally{c.p=void 0,--c.i}}return c.irf?b():c.p=Promise.resolve().then(b)});if(y.NODE_ENV!=="production"){let u=function(c,m){Object.defineProperty(c,"debugLabel",{get:()=>`${o.debugLabel??"effect"}:${m}`}),c.debugPrivate=!0};u(t,"refresh"),u(n,"ref"),u(r,"base")}let o=k(u=>void u(r));return o.effect=e,o;function s(u){try{u.irf=!0,u.set(t,c=>c+1)}finally{u.irf=!1}}function a(u){if(typeof u.c=="function")try{u.fc=!0,u.c()}finally{u.fc=!1,u.c=void 0}}function i(u){if("e"in u){let c=u.e;throw delete u.e,c}}}l();d();var Zs=()=>{try{return typeof chrome<"u"&&(chrome.runtime?.id!==void 0||typeof browser<"u")}catch(e){return console.error("Error checking for extension context:",e),!1}},Xt=class{browser;storage;constructor(t){if(!t||!t.storage||!t.storage.local)throw new Error("[ExtensionStorage] Invalid 'browser' object received.");this.browser=t,this.storage=this.browser.storage.local}async get(t){try{let r=(await this.storage.get(t))[t];return r==null||typeof r!="string"?null:JSON.parse(r)}catch(n){return console.error(`[ExtensionStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){try{let n=await this.storage.get(t),r={};for(let o in n)if(Object.prototype.hasOwnProperty.call(n,o)){let s=n[o];if(s==null||typeof s!="string")r[o]=null;else try{r[o]=JSON.parse(s)}catch(a){console.error(`[ExtensionStorage.getAll] Error parsing key (${o}):`,a),r[o]=null}}return r}catch(n){let r=`[ExtensionStorage.getAll] Error getting keys (${t}): ${n}`;throw console.error(r),new Error(r)}}async remove(t){try{await this.storage.remove(t)}catch(n){let r=`[ExtensionStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(r),new Error(r)}}async set(t,n){try{let r=JSON.stringify(n);await this.storage.set({[t]:r})}catch(r){let o=`[ExtensionStorage.set] Error setting/stringifying key (${t}): ${r}`;throw console.error(o),new Error(o)}}async setAll(t){try{let n={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=JSON.stringify(t[r]));await this.storage.set(n)}catch(n){let o=`[ExtensionStorage.setAll] Error setting/stringifying keys (${Object.keys(t)}): ${n}`;throw console.error(o),new Error(o)}}async update(t,n){if(!navigator.locks){let r=await this.get(t),o=await n(r);o===null?await this.remove(t):await this.set(t,o);return}try{await navigator.locks.request(`storage.${t}`,async r=>{let o=await this.get(t),s=await n(o);s===null?await this.remove(t):await this.set(t,s)})}catch(r){let o=`[ExtensionStorage.update] Error updating key (${t}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{await this.storage.clear()}catch(t){let n=`[ExtensionStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},ft=class{storage=self.localStorage;async get(t){try{let n=this.storage.getItem(t);return n===null||typeof n!="string"?null:JSON.parse(n)}catch(n){return console.error(`[WebLocalStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){let n={},r=t??Object.keys(this.storage);for(let o of r)try{let s=this.storage.getItem(o);if(t&&s===null)continue;if(s===null||typeof s!="string")n[o]=null;else try{n[o]=JSON.parse(s)}catch(a){console.error(`[WebLocalStorage.getAll] Error parsing key (${o}):`,a),n[o]=null}}catch(s){console.error(`[WebLocalStorage.getAll] Error reading key (${o}) from storage:`,s),t||(n[o]=null)}return n}async remove(t){try{let n=Array.isArray(t)?t:[t];for(let r of n)this.storage.removeItem(r)}catch(n){let r=`[WebLocalStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(r),new Error(r)}}async set(t,n){try{let r=JSON.stringify(n);this.storage.setItem(t,r)}catch(r){let o=`[WebLocalStorage.set] Error setting/stringifying key (${t}): ${r}`;throw console.error(o),new Error(o)}}async setAll(t){let n=!1,r=Object.keys(t);for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o))try{await this.set(o,t[o])}catch{n=!0}if(n)throw new Error(`[WebLocalStorage.setAll] One or more errors occurred while setting keys (${r})`)}async update(t,n){if(!navigator.locks){let r=await this.get(t),o=await n(r);o===null?await this.remove(t):await this.set(t,o);return}try{await navigator.locks.request(`storage.${t}`,async r=>{let o=await this.get(t),s=await n(o);s===null?await this.remove(t):await this.set(t,s)})}catch(r){let o=`[WebLocalStorage.update] Error updating key (${t}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{this.storage.clear()}catch(t){let n=`[WebLocalStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},en=class{initPromise;storageImpl=null;constructor(){this.initPromise=this._initialize(),this.initPromise.catch(t=>{console.error("LocalStorage initialization failed:",t)})}async _initialize(){if(!this.storageImpl)if(Zs())try{let n=(await import("./browser-polyfill-GANWF6O6.js")).default;if(!n||!n.storage||!n.storage.local)throw new Error("webextension-polyfill loaded but missing storage.local API.");this.storageImpl=new Xt(n)}catch{this.storageImpl=new ft}else this.storageImpl=new ft}async ensureInitialized(){if(await this.initPromise,!this.storageImpl)throw new Error("LocalStorage is not initialized. Initialization may have failed.")}async get(t){return await this.ensureInitialized(),this.storageImpl.get(t)}async getAll(t){return await this.ensureInitialized(),this.storageImpl.getAll(t)}async remove(t){return await this.ensureInitialized(),this.storageImpl.remove(t)}async set(t,n){return await this.ensureInitialized(),this.storageImpl.set(t,n)}async setAll(t){return await this.ensureInitialized(),this.storageImpl.setAll(t)}async update(t,n){return await this.ensureInitialized(),this.storageImpl.update(t,n)}async clear(){return await this.ensureInitialized(),this.storageImpl.clear()}},tn=new en;l();d();l();d();var je=class{namespaceKey;ttlMilliseconds;storage;onError;data={};isLoaded=!1;constructor(t){this.namespaceKey=t.namespaceKey,this.ttlMilliseconds=t.ttlMilliseconds,this.storage=t.storage,this.onError=t.onError,this._load().then(()=>{if(this._cleanupExpired())return this._save()}).catch(n=>{console.error("Failed to load data",n)})}async _load(){if(!this.isLoaded){try{let t=await this.storage.get(this.namespaceKey);t?(this.data=t,(typeof this.data!="object"||this.data===null)&&(this.onError?.(new Error("Stored data is not a valid object."),"load"),this.data={})):this.data={}}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to parse stored data"),"load"),this.data={}}this.isLoaded=!0}}async _save(){try{await this.storage.set(this.namespaceKey,this.data)}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to serialize data for storage"),"save")}}_cleanupExpired(){let t=Date.now(),n=!1;for(let r in this.data)Object.prototype.hasOwnProperty.call(this.data,r)&&this.data[r].expiresAt<=t&&(delete this.data[r],n=!0);return n}_updateExpiration(t){return this.data[t]?(this.data[t].expiresAt=Date.now()+this.ttlMilliseconds,!0):!1}async set(t,n){this.isLoaded||await this._load(),this._cleanupExpired(),this.data[t]={value:n,expiresAt:Date.now()+this.ttlMilliseconds},await this._save()}async get(t,n){this.isLoaded||await this._load();let r=this._cleanupExpired(),o=this.data[t];if(!o)return r&&await this._save(),null;let s=this._updateExpiration(t),a=n.safeParse(o.value);return a.success?((r||s)&&await this._save(),a.data):(this.onError?.(new ye(a.error.issues),`get (validation failed for key: ${t})`),delete this.data[t],await this._save(),null)}async remove(t){let n=this._cleanupExpired(),r=!1;Object.prototype.hasOwnProperty.call(this.data,t)&&(delete this.data[t],r=!0),(n||r)&&await this._save()}async clear(){this.data={},await this._save()}};var Xr=new Map;function Xs({storage:e,namespaceKey:t,ttlMs:n}){let r=Xr.get(t);if(r)return r;if(!e)throw new Error("Storage is required");let o=new je({storage:e,namespaceKey:t,ttlMilliseconds:n,onError:(s,a)=>{console.error(`[PersistentStore Error - ${a}]:`,s.message),s instanceof ye&&console.error("Zod Issues:",s.issues)}});return Xr.set(t,o),o}var nn=Xs;function ei({atomToStoreOffline:e,namespaceKey:t,ttlMs:n,initialValue:r,schema:o,...s}){let a=k({status:"pending",value:r}),i=k(f=>{if("offlineKey"in s)return f(s.offlineKey);let g=f(e);if("offlineKey"in g&&typeof g.offlineKey=="string")return g.offlineKey;throw new Error("No key provided")}),u=te((f,g)=>{nn({storage:tn,namespaceKey:`.offline.${t}`,ttlMs:n}).get(f(i),o).then(h=>{h&&g(a,{status:"offline",value:h})}).catch(h=>{console.error(h)})}),c=te((f,g)=>{f(i),g(a,{status:"pending",value:r})}),m=te((f,g)=>{let h=f(e),b=f(i);h.status==="success"&&h.data&&h.data!==f(a).value&&(g(a,{status:"live",value:h.data}),nn({storage:tn,namespaceKey:`.offline.${t}`,ttlMs:n}).set(b,h.data).catch(C=>{F.addBreadcrumb("tokens","Error storing offline data","error",{namespaceKey:t,error:C.toString()})}))});return X(k(f=>{let g=f(e);f(c),f(u),f(m);let h=f(a);return g.data?{status:"live",value:g.data}:{status:"offline",value:h.value}}),f=>f.value)}var gt=ei;l();d();l();d();var rn=p.object({caip19:p.string(),name:p.string().nullish(),symbol:p.string().nullish(),decimals:p.number(),spamStatus:pt.nullish().transform(e=>e??"NOT_VERIFIED"),logoUri:p.string().nullish()}),eo=rn.extend({totalQuantity:p.number(),totalQuantityString:p.string(),queriedWalletBalances:p.array($e),extraMetadata:Ge.optional(),price:Re}),to=eo.transform(Oe),no=p.object({items:p.array(eo),cursor:p.string().nullish().default(null),errors:p.array(p.object({code:p.string(),message:p.string(),details:p.object({chainId:p.string(),address:p.string()})})).optional()}).transform(e=>{let{items:t,cursor:n,errors:r,...o}=e;return{...o,nextCursor:n,tokens:t,errors:r||[],updatedAt:Date.now()}}),ro=rn.extend({timestamp:p.string().nullish(),postQuantityString:p.string(),postQuantity:p.number(),price:Re,queriedWalletBalances:p.array($e)}),oo=ro.transform(e=>{let{postQuantity:t,postQuantityString:n,...r}=Oe(e);return{...r,totalQuantity:t,totalQuantityString:n}}),so=p.object({cursor:p.string().nullish().default(null),items:p.array(ro)}).transform(e=>({nextCursor:e.cursor,transfers:e.items})),cd=p.object({totalValueUsdCentsCurrent:p.number(),totalValueUsdStringCurrent:p.string(),totalValueUsdCents24h:p.number(),totalValueUsdString24h:p.string(),totalPercentChange24h:p.number(),errors:p.array(p.object({code:p.string(),message:p.string(),details:p.object({chainId:p.string(),address:p.string()})})).optional()}),on=rn.extend({createdDate:p.coerce.date().nullish().default(null),extraMetadata:Ge.extend({id:p.string().nullish().default(null),description:p.string().nullish().default(null),marketCap:p.coerce.number().optional(),circulatingSupply:p.coerce.number().optional(),totalSupply:p.coerce.number().optional(),liquidity:p.coerce.number().optional(),holders:p.coerce.number().optional(),links:p.array(p.object({type:p.string(),url:p.string()})).optional(),volume24hUSD:p.coerce.number().optional(),volume24hUSDChangePercentage:p.coerce.number().optional(),trades24h:p.coerce.number().optional(),trades24hChangePercentage:p.coerce.number().optional(),uniqueWallets24h:p.coerce.number().optional(),uniqueWallets24hChangePercentage:p.coerce.number().optional(),top10HoldersPercent:p.coerce.number().optional(),mintable:p.boolean().optional(),freezable:p.boolean().optional(),mutableMetadata:p.boolean().optional(),ownershipRenounced:p.boolean().optional(),updateAuthority:p.string().optional(),createdDate:p.string().datetime().nullish().default(null)}).optional(),categories:p.array(Zt).optional().default([]),price:Re}),io=on.transform(Oe);l();d();var ti=e=>L.isBitcoinNetworkID(e.decodedCaip19.chainId)&&e.decodedCaip19.resourceType==="nativeToken"?e.queriedWalletBalances.map(r=>{let o=mr(e.decodedCaip19.chainId,r.address);if(!o)throw new Error("No legacy key found for bitcoin native token");return{...e,legacyKey:o,queriedWalletBalances:[r],totalQuantity:r.quantity,totalQuantityString:r.quantityString,walletAddress:r.address}}):[e],ni=e=>t=>t.map(n=>e.parse(n)),yd=ni(Jr),ri=e=>t=>t.flatMap(n=>{let r=e.parse(n);return ti(r)}),ao=ri(to),oi=e=>t=>t.map(n=>e.parse(n)),co=oi(oo);async function si(e){let t={walletAddresses:e.walletCaip19s.join(","),includePrices:"true"};"cursor"in e&&(t.cursor=e.cursor),"fromMicroseconds"in e?t.fromTimestamp=e.fromMicroseconds.toString():"from"in e&&(t.fromTimestamp=e.from.toString());let n=await Y.api().timeout(I({seconds:30})).get("/portfolio/v1/fungibles/updates",{params:t}).then(r=>{if(ne(r))return r.data;throw new Error(r.data?.message||r.data?.error||r.statusText||`Status: ${r.status}`,{cause:r.data?.code??r.data?.name})}).catch(r=>{throw F.addBreadcrumb("tokens","getTokenBalanceUpdates","error",{message:r.message,cause:r.cause,...t}),F.captureError(r,"tokens"),r});try{return so.parse(n)}catch(r){throw r instanceof ye&&F.addBreadcrumb("tokens","getTokenBalanceUpdates parse error","error",{message:r.message,...r.issues?{issues:JSON.stringify(r.issues)}:{},result:JSON.stringify(n)}),r}}async function uo(e){let t=[],n=()=>t.at(-1)?.nextCursor;do{let r=n(),o=await si(r?{walletCaip19s:e.walletCaip19s,cursor:r}:e);t.push(o)}while(n());return co(t.flatMap(r=>r.transfers))}l();d();l();d();function ii(e){let t=st(e.decodedCaip19);return t==="SPL"?e.extraMetadata?.compression?.compressed||"queriedWalletBalances"in e&&e.queriedWalletBalances.some(n=>!n.subaccounts?.length)?"CompressedSPL":"SPL":t}var lo=ii;function sn({newUpdates:e,existingUpdates:t={}}){return e.reduce((n,r)=>n[r.encodedCaip19]?.totalQuantityString===r.totalQuantityString?n:lo(r)==="CompressedSPL"?{...n,[`${r.encodedCaip19}-compressed`]:r}:r?{...n,[r.encodedCaip19]:r}:n,t)}l();d();function ai(e){let t=e.match(/(.*\d{2}:\d{2}:\d{2})\.(?<fraction>\d+)Z/);if(!t||!t.groups?.fraction)throw new Error("Invalid date format");let n=new Date(e).getTime(),s=t.groups.fraction.padEnd(6,"0").slice(-3);return n*1e3+parseInt(s,10)}var an=ai;l();d();var ci=k(!1),po=ci;l();d();l();d();l();d();var ui=I({minutes:5}),ze=0;function Yd(){if(!ze){ze=Math.floor(Math.random()*1e6);return}ze++}async function cn({walletCaip19s:e,fungibleCaip19s:t,cursor:n,cacheBust:r}){let o={walletAddresses:e.join(","),includePrices:"true"};n&&(o.cursor=n),(r||ze)&&(o.cacheBust=r?.toString()||ze.toString()),t&&t.length>0&&(o.fungibleAddresses=t.sort().join(","));try{let s=await Y.api().timeout(I({seconds:30})).get("/portfolio/v1/fungibles/balances",{params:o}).then(i=>{if(ne(i))return i.data;throw new Error(i.data?.message||i.data?.error||i.statusText||`Status: ${i.status}`,{cause:i.data?.code})}),a=no.parse(s);return a.errors&&a.errors.length>0&&a.errors.forEach(i=>{F.addBreadcrumb("tokens","getTokenBalances_partialError","info",{code:i.code,message:i.message,chainId:i.details.chainId,address:i.details.address})}),{...a,tokens:ao(a.tokens)}}catch(s){throw s instanceof Error&&(F.addBreadcrumb("tokens","getTokenBalances","error",{...o,message:s.message,...typeof s.cause=="string"||typeof s.cause=="number"?{cause:s.cause}:{}}),F.captureError(s,"tokens")),s}}function mo({walletCaip19s:e,isEnabled:t=!0,cacheBust:n}){return{staleTime:ui,gcTime:I({days:3}),queryKey:H.infiniteTokenBalances({walletCaip19s:e}),enabled:t&&!!e.length,queryFn:async({pageParam:r})=>cn({walletCaip19s:e,cursor:r,cacheBust:n}),initialPageParam:"",getNextPageParam:r=>r?.nextCursor||void 0}}function fo(e){let{walletCaip19s:t,encodedCaip19:n,queryOptions:r={enabled:!0}}=e;return{staleTime:I({seconds:10}),gcTime:I({days:3}),queryKey:H.tokenBalance({wallets:t,encodedCaip19:n}),enabled:r.enabled&&!!t.length,queryFn:async()=>(await cn({walletCaip19s:t,fungibleCaip19s:[n]})).tokens}}l();d();l();d();var li=k(null),yt=li;var di=k(e=>{let t=e(yt);return t?t.addresses.map(n=>ee({chainId:n.networkID,address:n.address,resourceType:"address"})).sort():[]}),Be=di;var pi=qr(e=>{let t=e(Be);return mo({walletCaip19s:t})}),ae=pi;var mi=k(e=>{let{data:t}=e(ae),n=t?.pages[0];return!n||!n.tokens.length?0:n.updatedAt}),go=mi;l();d();var fi=X(yt,e=>e?.identifier),we=fi;var gi=1e3,yo=5e3,ho=Math.ceil(yo*2.25);function To(e){return I(e)*1e3}function yi(e){if(!e?.length)return null;let t=new Date(Date.now()-ho).toISOString();return Math.floor(Math.max(...e.map(({timestamp:n})=>an(n||t))))}function hi(e){let t=yi(e);return t?t-To({seconds:1}):null}var Ti=dt(e=>{let t=e(Me),n=e(go),r=Math.floor(n-I({minutes:10})),o=e(Be),s=e(po),a=r>Date.now()-I({days:10}),i=H.tokenUpdates({walletCaip19s:o,from:r}),u=async()=>{let c=t.getQueryData(i)?.lastTimestamp;if(!c){let h=new Date(r-ho).toISOString();return{updates:{},lastTimestamp:an(h)}}let m=await uo({walletCaip19s:o,fromMicroseconds:c-To({seconds:30})}),f=t.getQueryData(i)?.updates??{};return{updates:sn({newUpdates:m,existingUpdates:f}),lastTimestamp:Math.max(hi(m)??0,c)}};return{meta:{fetchCount:0},enabled:a&&!s&&o.length>0,queryKey:i,refetchInterval:c=>{let m=Number(c.meta?.fetchCount??0);return c.meta&&(c.meta.fetchCount=m+1),Math.min(Math.max(m*250,gi),yo)},queryFn:u}}),bi=gt({atomToStoreOffline:Ti,offlineKey:k(e=>`${e(we)??""}:token-balance-updates`),namespaceKey:"fungible-tokens",ttlMs:I({days:10}),initialValue:{updates:{},lastTimestamp:0},schema:p.object({updates:p.record(p.string(),Zr),lastTimestamp:p.number()})}),wi=X(bi,e=>e?.updates??{},(e,t)=>JSON.stringify(e)===JSON.stringify(t)),ht=wi;l();d();l();d();function Tt(e){return t=>{let n=!1,r={...t};for(let[o,s]of Object.entries(e)){let a=s?.price,i=s?.lastUpdatedAt?new Date(s.lastUpdatedAt):null;if(!a||!i)continue;let u=t[o]?.price!==a&&(!t[o]?.lastUpdatedAt||i>t[o].lastUpdatedAt);n=n||u,u&&(r[o]={price:s.price,priceChange24h:s.priceChange24h,lastUpdatedAt:i})}return n?r:t}}l();d();var Ai=k(e=>{let{data:t,status:n}=e(ae);return{data:t?.pages.flatMap(r=>r.tokens),status:n}}),ki=gt({atomToStoreOffline:Ai,offlineKey:k(e=>`${e(we)??""}:infinite-tokens`),namespaceKey:"fungible-tokens",ttlMs:I({days:10}),initialValue:[],schema:p.array(Yr)}),Ae=ki;var bt=k({}),Si=k(e=>e(Ae).slice(-100).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})),vi=te((e,t)=>{let n=e(Si);!n||Object.keys(n).length===0||t(bt,Tt(n))}),Ei=k(e=>{let t=e(ht);return Object.values(t).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})}),xi=te((e,t)=>{let n=e(Ei);!n||Object.keys(n).length===0||t(bt,Tt(n))}),Ci=k(e=>(e(vi),e(xi),e(bt)),(e,t,n)=>{t(bt,n)}),ke=Ci;l();d();l();d();var Pi=X(ae,e=>e.hasNextPage),_e=Pi;var He=k(1/0),wt=k(e=>(e(Ii),e(Fi),e(_e)?e(He):0),(e,t,n)=>{if(n===null){t(He,1/0);return}let r=Math.min(e(He),n);r!==e(He)&&t(He,r)}),bo=wt,Ii=te((e,t)=>{let{hasNextPage:n}=e(ae),r=e(Ae),o=e(ke);if(r.length>0&&!n){t(wt,0);return}let s=r.slice(-100).filter(a=>a.type==="fungible").map(a=>{let i=o[a.encodedCaip19]??a.price;return i?a.totalQuantity*i.price/10**a.decimals:1/0});t(wt,Math.min(...s))}),Fi=te((e,t)=>{e(we)&&t(wt,1/0)});function Mi(e,t){if(e.type==="native"&&t.type!=="native")return-1;if(e.type!=="native"&&t.type==="native")return 1;if(e.type==="native"&&t.type==="native")return e.name&&t.name?e.name.localeCompare(t.name):0}function Oi(e,t){if(!e&&t)return 1;if(e&&!t)return-1}function wo(e,t){if(e&&t)return e.localeCompare(t);if(e&&!t)return-1;if(!e&&t)return 1}function Ao(e,t){if(e!==t)return t-e}function Ri(e){return{totalQuantity:e.totalQuantity,totalQuantityString:e.totalQuantityString}}var Bi=k(e=>{let t=e(Ae),n=e(ht),r=new Set(Object.keys(n));if(t.length===0)return[];let o=t.map(s=>{let a=s.extraMetadata?.compression?.compressed?`${s.encodedCaip19}-compressed`:s.encodedCaip19,i=n[a];return i?(r.delete(a),{...s,...Ri(i)}):s});return r.forEach(s=>{let a=n[s];a&&o.push(a)}),o}),_i=k(e=>{let t=e(ke),n=e(Bi),r=e(bo),o=n.filter(s=>s.totalQuantity>0||s.type==="native").map(s=>({...s,livePrice:t[s.encodedCaip19]??s.price})).sort((s,a)=>{let i=s.livePrice?.price,u=a.livePrice?.price,c=Oi(i,u);if(c)return c;let m=s.totalQuantity/10**s.decimals,f=a.totalQuantity/10**a.decimals;if(!i&&!u){let C=Mi(s,a);if(C)return C;let M=Ao(m,f);if(M)return M;let _=wo(s.name,a.name);return _||0}let g=(i??0)*m,h=(u??0)*f,b=Ao(g,h);return b||(wo(s.name,a.name)??0)});return r?o.filter(s=>{let a=s.livePrice?.price,i=s.totalQuantity/10**s.decimals;return(a??0)*i>=r}):o}),Se=_i;l();d();function Ui(e){if(e)return typeof e=="string"||typeof e=="number"?new Date(e):e}function Ni(e,{key:t,newPriceData:n}){let r=e[t];if(!n||r?.price===n?.price)return e;let o=Ui(n.lastUpdatedAt);return!o||!(!r?.lastUpdatedAt||o>r.lastUpdatedAt)?e:{...e,[t]:{price:n.price,priceChange24h:n.priceChange24h??n.usd_24h_change,lastUpdatedAt:o}}}var At=Ni;var Di=(e,t,n)=>{let r=e.extraMetadata?.compression?.compressed,o=t.extraMetadata?.compression?.compressed;if(r!==o)return n?r?-1:1:r?1:-1},Li=(e,t,n)=>{let r=e.legacyKey===n,o=t.legacyKey===n;if(r!==o)return r?-1:1},Vi=({isSplCompressed:e,legacyKey:t},n)=>n.length?n.length===1?n[0]:[...n].sort((o,s)=>{if(e!==void 0&&(o.encodedCaip19.includes("solana:")||s.encodedCaip19.includes("solana:"))){let a=Di(o,s,e);if(a)return a}if(t){let a=Li(o,s,t);if(a)return a}return s.totalQuantity-o.totalQuantity})[0]:null,kt=e=>{let t=K(Be),n=K(Se),r=(0,Je.useMemo)(()=>n.filter(i=>i.encodedCaip19===e.encodedCaip19&&(!e.legacyKey||i.legacyKey===e.legacyKey)),[e.encodedCaip19,e.legacyKey]),o=fo({...e,walletCaip19s:t});o.refetchInterval||(o.refetchInterval=I({seconds:3}));let s=q({...o,select:i=>Vi(e,i),placeholderData:r}),a=We(ke);return(0,Je.useEffect)(()=>{let i=s.data;i&&!s.isPlaceholderData&&i.price&&a(u=>{let c=i.encodedCaip19,m=i.price;return At(u,{key:c,newPriceData:m})})},[s.data,s.isPlaceholderData,a]),s},St=({networkID:e,queryOptions:t,addressType:n})=>{let r={chainId:e,slip44:L.getSlip44(e),resourceType:"nativeToken"},o=pr(e,n),s=ee(r);return kt({encodedCaip19:s,legacyKey:o,queryOptions:t})},Qi=()=>{let{data:e}=se(),t=(0,Je.useMemo)(()=>e?.addresses.find(n=>L.isSolanaNetworkID(n.networkID)),[e]);return St({networkID:t?.networkID||"solana:101",addressType:t?.addressType})};l();d();l();d();l();d();l();d();function un(e,t){return{gcTime:ot.Long,staleTime:1/0,enabled:!!t&&!!e,queryKey:H.visibilityOverrides({accountId:t??""}),async queryFn(){return!t||!e?new Map:await hr(e,t)}}}l();d();var Wi=k(null),ko=Wi;var Ki=new Map,So=dt(e=>{let t=e(ko),n=e(we);return un(t,n)}),vo=X(So,e=>e.status),$i=k(e=>e(So).data??Ki),Ue=$i;var Gi=k(e=>{let{isLoading:t}=e(ae),n=e(Ae),r=e(vo);return t&&n.length===0||r==="pending"}),vt=X(Gi,e=>e);function Eo(){let e=K(Se),t=K(vt),n=K(_e),r=K(Ue);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:r}}l();d();l();d();var xo=U(D());var ji=({wallets:e,encodedCaip19:t,isSplCompressed:n=!1})=>{let r=Z();return(0,xo.useCallback)(()=>void r.invalidateQueries({queryKey:H.tokenBalance({wallets:e,encodedCaip19:t,isSplCompressed:n})}),[r,e,t,n])},qi=ji;l();d();function Co({tokens:e}){return fr({tokens:e}).catch(t=>{throw F.addBreadcrumb("tokens","getTokenPrices","error",{message:t.message,cause:t.cause,tokens:e.map(ee).join(",")}),F.captureError(t,"tokens"),t})}l();d();l();d();var zi=k(e=>{let t=e(Ue);return e(Se).filter(r=>br(t??new Map,{key:r.legacyKey??"",spamStatus:r.spamStatus}))}),Po=zi;function Io(){let e=K(Po),t=K(vt),n=K(_e),r=K(Ue);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:r}}l();d();var Ye=U(D());l();d();l();d();function Hi(e){let t={message:"Failed to parse token details response"};if(e instanceof ye)try{t.zodIssuesJson=JSON.stringify(e.issues.map(n=>({path:n.path.join("."),message:n.message,code:n.code})))}catch{t.zodIssuesJson="Failed to stringify Zod issues"}else t.errorMessage=e instanceof Error?e.message:String(e);return t}var Fo=Hi;function Mo(e){return e.resourceType==="nativeToken"?`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.slip44}`:`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.address}`}function Ji(e){return Mo(Xe(e))}function Yi(e){let t=new URLSearchParams,n="encodedCaip19"in e?Ji(e.encodedCaip19):Mo(e.decodedCaip19);return e.includePrice&&t.append("includePrice","true"),e.includeFungibleDetails&&t.append("includeFungibleDetails","true"),[n,{params:t}]}async function ln(e){let t=await Y.api().timeout(I({seconds:10})).get(...Yi(e)).then(n=>{if(ne(n))return n.data;throw new Error(n.data?.message||n.data?.error||n.statusText||`Status: ${n.status}`,{cause:n.data?.code})}).catch(n=>{throw F.addBreadcrumb("tokens","getTokenDetails","error",{message:n.message,cause:n.cause,..."encodedCaip19"in e&&{caip19:e.encodedCaip19},..."decodedCaip19"in e&&{caip19:ee(e.decodedCaip19)}}),F.captureError(n,"tokens"),n});try{return on.parse(t)}catch(n){console.error(n);let r=Fo(n);throw"encodedCaip19"in e&&typeof e.encodedCaip19=="string"?r.caip19=e.encodedCaip19:"decodedCaip19"in e&&(r.caip19=ee(e.decodedCaip19)),F.addBreadcrumb("tokens","getTokenDetails.ParseError","error",r),n}}function Zi({caip19:e,includePrice:t}){let n=(0,Ye.useMemo)(()=>typeof e=="string"?e:ee(e),[e]),r=K(Se),o=(0,Ye.useMemo)(()=>{let i=r.find(u=>u.encodedCaip19===n);return i?{chainName:i.chainName,encodedCaip19:n,decodedCaip19:i.decodedCaip19,type:i.type,categories:[],price:i.price,symbol:i.symbol??"",name:i.name??"",decimals:i.decimals,legacyKey:i.legacyKey??n,spamStatus:i.spamStatus??"NOT_VERIFIED",logoUri:i.logoUri??null,extraMetadata:{description:"",id:"",isMutable:!0,createdDate:null,...i.extraMetadata},createdDate:null}:null},[n,t]),s=q({refetchInterval:I({seconds:t?5:30}),queryKey:H.tokenDetails({caip19:n,includePrice:t}),queryFn:async()=>{let i=await ln(typeof e=="string"?{encodedCaip19:e,includeFungibleDetails:!0,includePrice:t}:{decodedCaip19:e,includeFungibleDetails:!0,includePrice:t});return io.parse(i)},...o&&{placeholderData:o}}),a=We(ke);return(0,Ye.useEffect)(()=>{let i=s.data;i&&!s.isPlaceholderData&&t&&i.price&&a(u=>{let c=i.encodedCaip19,m=i.price;return At(u,{key:c,newPriceData:m})})},[s.data,s.isPlaceholderData,a,t]),s}var dn=Zi;l();d();var fn=U(D());l();d();var pn=new B(0),mn=({chainAddress:e,type:t,balance:n,decimals:r,recipient:o,gasEstimation:s,clampToZero:a=!0})=>{let{data:i,isPending:u}=Rt(e);if(!t||!n)return pn;let c=new B(n).multipliedBy(zn(r));if(!ie(t))return c;if(!s)return;let m=new B(0);if(tt(s))m=c.minus(new B(s.value));else if(Zn(s)){let{gasLimit:f,maxFeePerGas:g,l1Fee:h=new B(0)}=s,b=f.times(g).plus(h);m=c.minus(b)}else if(nt(s)){if(!e||u)return;let f=e.addressType,g=i?.safeToSendUtxos??[],h=Jn(s.btcPerKilobyte),b=o&&_n.safeParse(o).success?o:"bc1p",M=[{value:g.reduce((Q,$)=>Q.plus(new B($.value)),new B(0)).toNumber(),address:b}],_=tr(f,g,M,h.toNumber(),[]);if(_.type==="error")m=new B(_.maxAmount).integerValue(B.ROUND_DOWN);else{let{inputs:Q,fee:$}=_;m=Q.reduce((ve,le)=>ve.plus(new B(le.value)),new B(0)).minus($).integerValue(B.ROUND_DOWN)}}else if(Yn(s))m=c.minus(s.gasBudget);else return Ne(s);return m.isGreaterThan(pn)?m:a?pn:m};var Xi=({networkID:e,addressType:t,gasEstimation:n,transactionValue:r=new B(0),recipient:o})=>{let{data:s,isLoading:a,isError:i}=St({networkID:e,addressType:t}),u=kr.get(e).nativeFungibleTokenType,c="unknown",m="",f=(0,fn.useMemo)(()=>{let h=s?.queriedWalletBalances[0]?.address;if(!h)return;let b=Nn(e,h);return{networkID:e,address:h,addressType:b}},[s?.queriedWalletBalances,e]),g=mn({chainAddress:f,type:u,balance:s?.totalQuantityString?new B(s?.totalQuantityString):void 0,decimals:s?.decimals??0,recipient:o,gasEstimation:n,clampToZero:!1});return!i&&s&&g&&(g.gte(r)?c="sufficient":c="insufficient",m=s?.symbol||""),(0,fn.useMemo)(()=>({hasSufficientFunds:c,nativeTokenSymbol:m,isLoading:a,isError:i}),[c,m,a,i])};l();d();var _o=U(D());l();d();var gn=U(D());l();d();var Oo=({chainAddresses:e=[]})=>{let t=z.tokensErrorCount(e);return q({queryKey:t,queryFn:()=>{throw new Error("This query is cache-only")},enabled:!1,initialData:0,staleTime:1/0})};l();d();var ea=({errors:e})=>e;function Ro({chainAddresses:e,queryOptions:t}){return Sr({select:ea,chainAddresses:e,queryOptions:t})}var Bo=3,ta=1,yn=({networkID:e,chainAddresses:t=[]})=>{let{data:n=[]}=Ro({chainAddresses:t}),{data:r=0}=Oo({chainAddresses:t}),o=r>=Bo,{data:s=0}=wr(),a=s>=Bo,i=n.length===ta&&n.some(m=>m.code==="TokensTrimmed"),{t:u}=oe(),c=(0,gn.useMemo)(()=>{if(o)return u("partialErrorGeneric");let m=n.filter(g=>e?g.details.chainId===e:!0),f=m.length+(a?1:0);return f?f>1?u("partialErrorGeneric"):a?u("partialErrorTokenPrices"):i?u("partialErrorTokensTrimmed"):e?u("partialErrorTokenDetail"):u("partialErrorBalanceChainName",{chainName:L.getChainName(m[0].details.chainId)}):""},[o,n,a,e,i,u]);return(0,gn.useMemo)(()=>({partialErrorMessage:c,shouldShowPartialError:c!==""}),[c])};function na(e){let{onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o,account:s}=e,{shouldShowPartialError:a,partialErrorMessage:i}=yn({chainAddresses:s?.addresses});return{ctaActions:ra({onTappingBuy:t,onTappingReceive:n,onTappingSend:r,onTappingSwap:o}),shouldShowPartialError:a,partialErrorMessage:i}}function ra(e){let{t}=oe(),n=Dn("enable-replace-classic-ngs");return(0,_o.useMemo)(()=>{let o=[];return o.push({text:t("commandSend"),type:"send",onClick:e.onTappingSend}),n?o.push({text:t("commandTrade"),type:"trade",onClick:e.onTappingSwap}):o.push({text:t("commandSwap"),type:"swap",onClick:e.onTappingSwap}),o.push({text:t("commandReceive"),type:"receive",onClick:e.onTappingReceive}),o.push({text:t("commandBuy"),type:"buy",onClick:e.onTappingBuy}),o.sort((s,a)=>(Ut.get(s.type)??100)-(Ut.get(a.type)??100)),{primary:o,more:[]}},[t,n,e.onTappingSend,e.onTappingSwap,e.onTappingReceive,e.onTappingBuy])}l();d();var Uo=U(D());var oa=({networkID:e,unsignedTransaction:t,pendingActivityRows:n,accountIdentifier:r,accountSigner:o,storage:s,includeCallPayload:a})=>({accountSigner:o,accountIdentifier:r,networkID:e,unsignedTransaction:t,...a&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:"swap",display:{summary:n}},storage:s}),sa=async({t:e,fungible:t,unsignedUnwrapTx:n,gasEstimation:r,storage:o,accountMetadata:s,accountSigner:a})=>{if(!n)throw new Error("Unsigned unwrap transaction is required");if(!r)throw new Error("Gas estimation is required");let{chain:i,balance:u}=t.data;if(!L.isEthereumNetworkID(i.id))throw new Error(`Chain is not supported: ${i.id}`);let c=i.id,m={topRight:{text:`+${u} ${i.symbol}`},topLeft:{text:e("transactionsPendingSwapping")},bottomRight:{text:`-${u} ${t.data.symbol}`},bottomLeft:{text:`${t.data.name}`}},f=On.parse({type:"0x2",chainId:L.getEVMNetworkIDValue(c),gas:`0x${r.gasLimit.toString(16)}`,maxFeePerGas:`0x${r.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${r.maxPriorityFeePerGas.toString(16)}`,...n}),g=oa({storage:o,accountSigner:a,pendingActivityRows:m,includeCallPayload:!1,networkID:c,unsignedTransaction:f,accountIdentifier:s.accountIdentifier});return or(g)},ia=()=>{let{data:e}=se();return(0,Uo.useMemo)(()=>{let n=e?.type,r=e?.name??"",o=e?.identifier??"";return{accountName:r,accountType:n,accountIdentifier:o}},[e])},aa=e=>{let t=he(),n=Z(),{t:r}=oe(),o=ia(),s=Te();return re({async mutationFn({fungible:a,unsignedUnwrapTx:i,gasEstimation:u}){return await sa({t:r,fungible:a,unsignedUnwrapTx:i,gasEstimation:u,accountMetadata:o,storage:t,accountSigner:s})},async onSuccess(){await n.invalidateQueries({queryKey:z.tokens(e)})}})};l();d();l();d();l();d();var No=()=>{let{setRetryArgs:e}=Ht();return t=>{if(t instanceof rr){let{successfulTxIds:n}=t,[r,o]=n;e({type:"BRC20",commitTxId:r,revealTxId:o})}}};function ca(){let e=he(),{data:t}=se({select:a=>a.identifier}),n=No(),r=Ar(),o=Te();return re({mutationFn:async({multichainTransaction:a,pendingTransactionInput:i,senderAddress:u,gasEstimation:c})=>{if(!t)throw new Error("No account identifier found");let{networkID:m}=a,f=await Xn.get(m).onBeforeSend({multichainTransaction:a,gasEstimation:c}),g=await dr({accountIdentifier:t,accountSigner:o,multichainTransaction:f,networkID:m,pendingTransactionInput:i,senderAddress:u,storage:e,utxoManager:r});return lr(m,g)},onError(a){a instanceof Error&&(F.captureError(a,"fungibles"),a instanceof nr&&n(a))}})}l();d();var Do=U(D());var ua=(e,t,n)=>{let r=Z(),{fungibles:o}=Ve({keys:[e]}),s=o.length===1?o[0]:void 0;(0,Do.useEffect)(()=>{if(!s)return;let{type:a,data:i}=s,{balance:u,decimals:c,chain:m}=i,{id:f}=m,g=ie(a)===!0;if(!n||!u||g||u.isEqualTo(t))return;let h=z.transferFungibleLoggingContext(e),b={transactionId:n,decimals:c,chainId:f,isNativeToken:g,previousBalance:u,fungibleKey:e};r.setQueryData(h,b)},[n])};l();d();var Vo=U(D());l();d();function Lo(e,t,n){return G.PublicKey.findProgramAddressSync([e.toBuffer(),n.toBuffer(),t.toBuffer()],sr)[0]}var la=new Le("Unable to unwrap SOL. Wrapped SOL Token account does not exist."),da=new Le("Unable to unwrap SOL. Token account is not expected mint.");async function pa(e,t){let n=await e.getAccountInfo(t);if(!n)throw la;let r=ar.decode(n.data);return new G.PublicKey(r.mint)}function ma(e){if(e)return typeof e=="string"?new G.PublicKey(e):e}function fa(){let{connection:e}=it(),{data:t}=se(),{solanaChainAddress:n,accountIdentifier:r}=(0,Vo.useMemo)(()=>({solanaChainAddress:t?.addresses.find(xe),accountIdentifier:t?.identifier??""}),[t]),o=he(),s=Te(),{t:a}=oe();return re({mutationFn:async i=>{if(!n)return Promise.reject("solanaChainAddress not loaded");try{let{networkID:u,address:c}=n,m=new G.PublicKey(c),f=ma(i?.tokenAccount)??Lo(m,Ot,De);if((await pa(e,f)).toBase58()!==Ot.toBase58())throw da;let h=Kr(f,m,m,[],De),b=new Rn.Transaction().add(h),C={ownerAddress:c,networkID:u,data:{signature:""},type:"unwrapSOL",display:{summary:{topLeft:{text:a("assetDetailUnwrappingSOL")}}}},M=await rt({accountIdentifier:r,accountSigner:s,connection:e,feePayer:new G.PublicKey(c),pendingTransactionInput:C,storage:o,transaction:b,useSubmissionService:!1});return{networkID:u,id:M}}catch(u){throw u instanceof Error&&F.captureError(u,"tokens"),u}}})}l();d();var Qo=I({minutes:1}),ga=(e,t=!0)=>{let n=z.solanaBalance(e);return q({enabled:!!e&&t&&xe(e),gcTime:Qo,staleTime:Qo,queryKey:n,async queryFn(){if(!e)throw new Error("No chain address provided");if(xe(e))return er(e.networkID).getBalance(new G.PublicKey(e.address));throw new Error(`SOL balance not implemented for ${e.networkID}`)}})};l();d();l();d();var Wo=U(D());var ya=e=>{let{data:t}=qn();return(0,Wo.useMemo)(()=>{if(!e||!t)return;let n=e.data.chain.id,r=t.explorers[n]??$n.get(n).defaultExplorer,o,s;if(ie(e.type))s="address",o=e.data.walletAddress;else switch(e.type){case"SuiCoin":{s="token",o=e.data.contractAddress;break}case"ERC20":{s="address",o=e.data.contractAddress;break}case"SPL":case"CompressedSPL":{s="address",o=e.data.mintAddress;break}case"BRC20":return{explorerName:"Unisat",explorerUrl:`https://unisat.io/brc20?q=${e.data.walletAddress}`}}let a=jn({networkID:n,endpoint:s,explorerType:r,param:o});return{explorerName:Gn[r],explorerUrl:a}},[e,t])};l();d();var Ko=U(D());var ha=e=>{let t=Z();return(0,Ko.useCallback)(()=>t.invalidateQueries({queryKey:z.tokens(e)}),[t,e])};l();d();var $o=U(D()),Ta=(e,t)=>(0,$o.useMemo)(()=>{if(e)if(nt(e)){let n=Hn(e).toNumber().toLocaleString("en-US");return{leftSubtext:void 0,leftSubtextColor:void 0,rightSubtext:t("satsAmount",{sats:n.toString()})}}else return tt(e)&&e.highFees?{leftSubtext:t("notificationTransactionApprovalNetworkFeeHighWarning"),leftSubtextColor:"spotWarning",rightSubtext:""}:void 0},[e,t]);l();d();var ba=U(D());l();d();var Go=U(D());var wa=({caip19:e,fungibleCaip19:t,fungibleKeys:n,isSplCompressed:r})=>{let{fungibles:o,isLoadingTokens:s,refetch:a}=Ve({keys:n}),{data:i,refetch:u,isLoading:c}=kt({encodedCaip19:e,legacyKey:n?.[0]??null,isSplCompressed:r}),{data:m,isLoading:f}=dn({caip19:e,includePrice:!0}),g=va(o,r),h=(0,Go.useMemo)(()=>{if(!g)return;if(!i)return g;let C=_t(i.totalQuantityString,i.decimals);return{...g,data:{...g.data,balance:C,usd:i.price?.price?C.times(i.price.price).toNumber():void 0,usd_24h_change:i.price?.priceChange24h!==void 0?jo(C.times(i.price.price).toNumber(),i.price?.priceChange24h):void 0}}},[g,i]);return{derivedFungible:Aa({fungible:h,fungibleCaip19:t,tokenDetails:m,tokenBalance:i}),isLoading:s||f||c,refetchFungibleBalance:a,refetchTokenBalance:u}};function Aa({fungible:e,fungibleCaip19:t,tokenDetails:n,tokenBalance:r}){if(e)return e;if(!n)return;let o=vr(n),s="address"in t?ka(t,o):Sa(t,o);if(s){if(r){r.extraMetadata?.compression?.compressed&&(s.type="CompressedSPL");let a=_t(r.totalQuantityString,r.decimals);s.data.balance=a,s.data.amount=r.totalQuantityString,s.data.usd=r.price?.price?a.times(r.price.price).toNumber():void 0,s.data.usd_24h_change=r.price?.priceChange24h!==void 0?jo(a.times(r.price.price).toNumber(),r.price?.priceChange24h):void 0,s.data.walletAddress=r.queriedWalletBalances.find(i=>i.quantity>0)?.address??""}return s}F.addBreadcrumb("tokens","deriveFungible","error",{fungibleCaip19:JSON.stringify(t),tokenDetails:JSON.stringify(n),tokenBalance:JSON.stringify(r)}),F.captureError(new Error(`Fungible type could not be derived from ${JSON.stringify(t)}`),"fungibles")}function ka(e,t){let n=Bt(e);if(ie(n))throw new Error("Cannot create fake non-native fungible for native token");let r=t.address??e.address,o={amount:"0",balance:B(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:r,walletAddress:"",spamStatus:t.spamStatus};switch(n){case"SPL":return{type:n,data:{...o,mintAddress:r,programId:"",splTokenAccountPubkey:""}};case"CompressedSPL":return{type:n,data:{...o,mintAddress:r,programId:""}};case"ERC20":case"SuiCoin":return{type:n,data:{...o,contractAddress:r}};case"BRC20":return{type:n,data:{...o,firstCreatedInscriptionId:r}};case"HypercoreAsset":return;default:Ne(n)}}function Sa(e,t){let n=Bt(e),r={amount:"0",balance:B(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:n,walletAddress:"",spamStatus:t.spamStatus};switch(e.slip44){case"501":return{type:"SolanaNative",data:r};case"0":return{type:"BitcoinNative",data:r};case"60":return{type:"EthereumNative",data:r};case"8453":return{type:"BaseNative",data:r};case"143":return{type:"MonadNative",data:r};case"9001":return{type:"ArbitrumNative",data:r};case"925":return{type:"HypercoreNative",data:r};case"966":return{type:"PolygonNative",data:r};case"784":return{type:"SuiNative",data:r};default:{let o=new Error("Missing native token implementation when creating fake a Fungible");throw Ne(e.slip44,o),o}}}var va=(e,t)=>e?.length?[...e].sort((r,o)=>{if(t!==void 0){let s=r.type==="CompressedSPL",a=o.type==="CompressedSPL";if(s!==a)return t?s?-1:1:s?1:-1}return o.data.balance.minus(r.data.balance).toNumber()})[0]:void 0,jo=(e,t)=>{if(t===-100)return-1*e;let n=e/(1+t/100);return e-n};l();d();l();d();var Xo=U(D());l();d();l();d();var qo="@phantom/wallet-screening",zo=`${qo}:wallet-screen-action`,Ea=`${qo}:wallet-screen-geo`,Et={walletScreenAction(e){return[zo,e]},walletGeo(){return[Ea]}};l();d();var Ho=new Error("Failed to fetch wallet screen action.");async function Jo(e){try{let t=await Y.api().post("/wallet_screen/v1",e);if(!ne(t))throw Ho;let n=t.data;return Er.parse(n)}catch{throw Ho}}var Yo=I({days:7}),Zo=e=>{let t=e!==void 0&&L.isMainnetNetworkID(e.networkID),n=[];if(e!==void 0){let i=L.isEVMNetworkID(e.networkID)?e.address.toLowerCase():e.address;n=[{chainId:e.networkID,address:i,resourceType:"address"}]}let r={addresses:n},o=Z(),s=Et.walletScreenAction(r),a=[s[0]];return q({enabled:t,queryKey:s,gcTime:Yo,staleTime:Yo,refetchInterval:!1,refetchOnMount:!1,async queryFn(){if(Ca(o,a))return"FAIL_SEVERE";let u=await Jo(r);return Pa(u)}})},Ca=(e,t)=>{let n=e.getQueriesData({queryKey:t,exact:!1}),r=!1;for(let[o,s]of n){let a=s;if(a&&a==="FAIL_SEVERE"){r=!0;break}}return r},Pa=e=>{let t=e.addressScreenResults;return t.some(n=>n.action==="FAIL_SEVERE")?"FAIL_SEVERE":t.some(n=>n.action==="FAIL_HIGH")?"FAIL_HIGH":t.some(n=>n.action==="NO_ACTION")?"NO_ACTION":"DATA_NOT_FOUND"};var Ia=(e,t)=>{let n=et(),{data:r}=Zo(e);switch((0,Xo.useEffect)(()=>{r&&e&&n.capture("walletScreened",{data:{walletScreen:{action:r.toString(),surface:t},chainId:L.getChainID(e.networkID),networkId:e.networkID}})},[r,e,t,n]),r){case"FAIL_SEVERE":case"FAIL_HIGH":throw new Cr(`Transaction disabled: ${t}`);case"NO_ACTION":case"DATA_NOT_FOUND":return}};l();d();l();d();l();d();var es=new Error("Failed to fetch wallet geo.");async function ts(){try{let e=await Y.api().get("/wallet_screen/v1/geo");if(!ne(e))throw es;let t=e.data;return xr.parse(t).country}catch{throw es}}var ns=I({hours:1}),Fa=()=>{let e=Et.walletGeo();return q({queryKey:e,staleTime:ns,refetchInterval:ns,queryFn:ts})};l();d();l();d();function fe(e){return Array.isArray?Array.isArray(e):ls(e)==="[object Array]"}var Ma=1/0;function Oa(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-Ma?"-0":t}function Ra(e){return e==null?"":Oa(e)}function ce(e){return typeof e=="string"}function cs(e){return typeof e=="number"}function Ba(e){return e===!0||e===!1||_a(e)&&ls(e)=="[object Boolean]"}function us(e){return typeof e=="object"}function _a(e){return us(e)&&e!==null}function J(e){return e!=null}function hn(e){return!e.trim().length}function ls(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var Ua="Incorrect 'index' type",Na=e=>`Invalid value for key ${e}`,Da=e=>`Pattern length exceeds max of ${e}.`,La=e=>`Missing ${e} property in key`,Va=e=>`Property 'weight' in key '${e}' must be a positive integer`,rs=Object.prototype.hasOwnProperty,Tn=class{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(r=>{let o=ds(r);this._keys.push(o),this._keyMap[o.id]=o,n+=o.weight}),this._keys.forEach(r=>{r.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function ds(e){let t=null,n=null,r=null,o=1,s=null;if(ce(e)||fe(e))r=e,t=os(e),n=bn(e);else{if(!rs.call(e,"name"))throw new Error(La("name"));let a=e.name;if(r=a,rs.call(e,"weight")&&(o=e.weight,o<=0))throw new Error(Va(a));t=os(a),n=bn(a),s=e.getFn}return{path:t,id:n,weight:o,src:r,getFn:s}}function os(e){return fe(e)?e:e.split(".")}function bn(e){return fe(e)?e.join("."):e}function Qa(e,t){let n=[],r=!1,o=(s,a,i)=>{if(J(s))if(!a[i])n.push(s);else{let u=a[i],c=s[u];if(!J(c))return;if(i===a.length-1&&(ce(c)||cs(c)||Ba(c)))n.push(Ra(c));else if(fe(c)){r=!0;for(let m=0,f=c.length;m<f;m+=1)o(c[m],a,i+1)}else a.length&&o(c,a,i+1)}};return o(e,ce(t)?t.split("."):t,0),r?n:n[0]}var Wa={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Ka={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},$a={location:0,threshold:.6,distance:100},Ga={useExtendedSearch:!1,getFn:Qa,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},x={...Ka,...Wa,...$a,...Ga},ja=/[^ ]+/g;function qa(e=1,t=3){let n=new Map,r=Math.pow(10,t);return{get(o){let s=o.match(ja).length;if(n.has(s))return n.get(s);let a=1/Math.pow(s,.5*e),i=parseFloat(Math.round(a*r)/r);return n.set(s,i),i},clear(){n.clear()}}}var Ze=class{constructor({getFn:t=x.getFn,fieldNormWeight:n=x.fieldNormWeight}={}){this.norm=qa(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,ce(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){let n=this.size();ce(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!J(t)||hn(t))return;let r={v:t,i:n,n:this.norm.get(t)};this.records.push(r)}_addObject(t,n){let r={i:n,$:{}};this.keys.forEach((o,s)=>{let a=o.getFn?o.getFn(t):this.getFn(t,o.path);if(J(a)){if(fe(a)){let i=[],u=[{nestedArrIndex:-1,value:a}];for(;u.length;){let{nestedArrIndex:c,value:m}=u.pop();if(J(m))if(ce(m)&&!hn(m)){let f={v:m,i:c,n:this.norm.get(m)};i.push(f)}else fe(m)&&m.forEach((f,g)=>{u.push({nestedArrIndex:g,value:f})})}r.$[s]=i}else if(ce(a)&&!hn(a)){let i={v:a,n:this.norm.get(a)};r.$[s]=i}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}};function ps(e,t,{getFn:n=x.getFn,fieldNormWeight:r=x.fieldNormWeight}={}){let o=new Ze({getFn:n,fieldNormWeight:r});return o.setKeys(e.map(ds)),o.setSources(t),o.create(),o}function za(e,{getFn:t=x.getFn,fieldNormWeight:n=x.fieldNormWeight}={}){let{keys:r,records:o}=e,s=new Ze({getFn:t,fieldNormWeight:n});return s.setKeys(r),s.setIndexRecords(o),s}function xt(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:o=x.distance,ignoreLocation:s=x.ignoreLocation}={}){let a=t/e.length;if(s)return a;let i=Math.abs(r-n);return o?a+i/o:i?1:a}function Ha(e=[],t=x.minMatchCharLength){let n=[],r=-1,o=-1,s=0;for(let a=e.length;s<a;s+=1){let i=e[s];i&&r===-1?r=s:!i&&r!==-1&&(o=s-1,o-r+1>=t&&n.push([r,o]),r=-1)}return e[s-1]&&s-r>=t&&n.push([r,s-1]),n}var Pe=32;function Ja(e,t,n,{location:r=x.location,distance:o=x.distance,threshold:s=x.threshold,findAllMatches:a=x.findAllMatches,minMatchCharLength:i=x.minMatchCharLength,includeMatches:u=x.includeMatches,ignoreLocation:c=x.ignoreLocation}={}){if(t.length>Pe)throw new Error(Da(Pe));let m=t.length,f=e.length,g=Math.max(0,Math.min(r,f)),h=s,b=g,C=i>1||u,M=C?Array(f):[],_;for(;(_=e.indexOf(t,b))>-1;){let W=xt(t,{currentLocation:_,expectedLocation:g,distance:o,ignoreLocation:c});if(h=Math.min(W,h),b=_+m,C){let de=0;for(;de<m;)M[_+de]=1,de+=1}}b=-1;let Q=[],$=1,ge=m+f,ve=1<<m-1;for(let W=0;W<m;W+=1){let de=0,pe=ge;for(;de<pe;)xt(t,{errors:W,currentLocation:g+pe,expectedLocation:g,distance:o,ignoreLocation:c})<=h?de=pe:ge=pe,pe=Math.floor((ge-de)/2+de);ge=pe;let Ee=Math.max(1,g-pe+1),A=a?f:Math.min(g+pe,f)+m,T=Array(A+2);T[A+1]=(1<<W)-1;for(let w=A;w>=Ee;w-=1){let v=w-1,E=n[e.charAt(v)];if(C&&(M[v]=+!!E),T[w]=(T[w+1]<<1|1)&E,W&&(T[w]|=(Q[w+1]|Q[w])<<1|1|Q[w+1]),T[w]&ve&&($=xt(t,{errors:W,currentLocation:v,expectedLocation:g,distance:o,ignoreLocation:c}),$<=h)){if(h=$,b=v,b<=g)break;Ee=Math.max(1,2*g-b)}}if(xt(t,{errors:W+1,currentLocation:g,expectedLocation:g,distance:o,ignoreLocation:c})>h)break;Q=T}let le={isMatch:b>=0,score:Math.max(.001,$)};if(C){let W=Ha(M,i);W.length?u&&(le.indices=W):le.isMatch=!1}return le}function Ya(e){let t={};for(let n=0,r=e.length;n<r;n+=1){let o=e.charAt(n);t[o]=(t[o]||0)|1<<r-n-1}return t}var Ct=class{constructor(t,{location:n=x.location,threshold:r=x.threshold,distance:o=x.distance,includeMatches:s=x.includeMatches,findAllMatches:a=x.findAllMatches,minMatchCharLength:i=x.minMatchCharLength,isCaseSensitive:u=x.isCaseSensitive,ignoreLocation:c=x.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:o,includeMatches:s,findAllMatches:a,minMatchCharLength:i,isCaseSensitive:u,ignoreLocation:c},this.pattern=u?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;let m=(g,h)=>{this.chunks.push({pattern:g,alphabet:Ya(g),startIndex:h})},f=this.pattern.length;if(f>Pe){let g=0,h=f%Pe,b=f-h;for(;g<b;)m(this.pattern.substr(g,Pe),g),g+=Pe;if(h){let C=f-Pe;m(this.pattern.substr(C),C)}}else m(this.pattern,0)}searchIn(t){let{isCaseSensitive:n,includeMatches:r}=this.options;if(n||(t=t.toLowerCase()),this.pattern===t){let b={isMatch:!0,score:0};return r&&(b.indices=[[0,t.length-1]]),b}let{location:o,distance:s,threshold:a,findAllMatches:i,minMatchCharLength:u,ignoreLocation:c}=this.options,m=[],f=0,g=!1;this.chunks.forEach(({pattern:b,alphabet:C,startIndex:M})=>{let{isMatch:_,score:Q,indices:$}=Ja(t,b,C,{location:o+M,distance:s,threshold:a,findAllMatches:i,minMatchCharLength:u,includeMatches:r,ignoreLocation:c});_&&(g=!0),f+=Q,_&&$&&(m=[...m,...$])});let h={isMatch:g,score:g?f/this.chunks.length:1};return g&&r&&(h.indices=m),h}},ue=class{constructor(t){this.pattern=t}static isMultiMatch(t){return ss(t,this.multiRegex)}static isSingleMatch(t){return ss(t,this.singleRegex)}search(){}};function ss(e,t){let n=e.match(t);return n?n[1]:null}var wn=class extends ue{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){let n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}},An=class extends ue{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){let r=t.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}},kn=class extends ue{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){let n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}},Sn=class extends ue{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){let n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}},vn=class extends ue{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){let n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},En=class extends ue{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){let n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}},Pt=class extends ue{constructor(t,{location:n=x.location,threshold:r=x.threshold,distance:o=x.distance,includeMatches:s=x.includeMatches,findAllMatches:a=x.findAllMatches,minMatchCharLength:i=x.minMatchCharLength,isCaseSensitive:u=x.isCaseSensitive,ignoreLocation:c=x.ignoreLocation}={}){super(t),this._bitapSearch=new Ct(t,{location:n,threshold:r,distance:o,includeMatches:s,findAllMatches:a,minMatchCharLength:i,isCaseSensitive:u,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}},It=class extends ue{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n=0,r,o=[],s=this.pattern.length;for(;(r=t.indexOf(this.pattern,n))>-1;)n=r+s,o.push([r,n-1]);let a=!!o.length;return{isMatch:a,score:a?0:1,indices:o}}},xn=[wn,It,kn,Sn,En,vn,An,Pt],is=xn.length,Za=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Xa="|";function ec(e,t={}){return e.split(Xa).map(n=>{let r=n.trim().split(Za).filter(s=>s&&!!s.trim()),o=[];for(let s=0,a=r.length;s<a;s+=1){let i=r[s],u=!1,c=-1;for(;!u&&++c<is;){let m=xn[c],f=m.isMultiMatch(i);f&&(o.push(new m(f,t)),u=!0)}if(!u)for(c=-1;++c<is;){let m=xn[c],f=m.isSingleMatch(i);if(f){o.push(new m(f,t));break}}}return o})}var tc=new Set([Pt.type,It.type]),Cn=class{constructor(t,{isCaseSensitive:n=x.isCaseSensitive,includeMatches:r=x.includeMatches,minMatchCharLength:o=x.minMatchCharLength,ignoreLocation:s=x.ignoreLocation,findAllMatches:a=x.findAllMatches,location:i=x.location,threshold:u=x.threshold,distance:c=x.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:o,findAllMatches:a,ignoreLocation:s,location:i,threshold:u,distance:c},this.pattern=n?t:t.toLowerCase(),this.query=ec(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){let n=this.query;if(!n)return{isMatch:!1,score:1};let{includeMatches:r,isCaseSensitive:o}=this.options;t=o?t:t.toLowerCase();let s=0,a=[],i=0;for(let u=0,c=n.length;u<c;u+=1){let m=n[u];a.length=0,s=0;for(let f=0,g=m.length;f<g;f+=1){let h=m[f],{isMatch:b,indices:C,score:M}=h.search(t);if(b){if(s+=1,i+=M,r){let _=h.constructor.type;tc.has(_)?a=[...a,...C]:a.push(C)}}else{i=0,s=0,a.length=0;break}}if(s){let f={isMatch:!0,score:i/s};return r&&(f.indices=a),f}}return{isMatch:!1,score:1}}},Pn=[];function nc(...e){Pn.push(...e)}function In(e,t){for(let n=0,r=Pn.length;n<r;n+=1){let o=Pn[n];if(o.condition(e,t))return new o(e,t)}return new Ct(e,t)}var Ft={AND:"$and",OR:"$or"},Fn={PATH:"$path",PATTERN:"$val"},Mn=e=>!!(e[Ft.AND]||e[Ft.OR]),rc=e=>!!e[Fn.PATH],oc=e=>!fe(e)&&us(e)&&!Mn(e),as=e=>({[Ft.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function ms(e,t,{auto:n=!0}={}){let r=o=>{let s=Object.keys(o),a=rc(o);if(!a&&s.length>1&&!Mn(o))return r(as(o));if(oc(o)){let u=a?o[Fn.PATH]:s[0],c=a?o[Fn.PATTERN]:o[u];if(!ce(c))throw new Error(Na(u));let m={keyId:bn(u),pattern:c};return n&&(m.searcher=In(c,t)),m}let i={children:[],operator:s[0]};return s.forEach(u=>{let c=o[u];fe(c)&&c.forEach(m=>{i.children.push(r(m))})}),i};return Mn(e)||(e=as(e)),r(e)}function sc(e,{ignoreFieldNorm:t=x.ignoreFieldNorm}){e.forEach(n=>{let r=1;n.matches.forEach(({key:o,norm:s,score:a})=>{let i=o?o.weight:null;r*=Math.pow(a===0&&i?Number.EPSILON:a,(i||1)*(t?1:s))}),n.score=r})}function ic(e,t){let n=e.matches;t.matches=[],J(n)&&n.forEach(r=>{if(!J(r.indices)||!r.indices.length)return;let{indices:o,value:s}=r,a={indices:o,value:s};r.key&&(a.key=r.key.src),r.idx>-1&&(a.refIndex=r.idx),t.matches.push(a)})}function ac(e,t){t.score=e.score}function cc(e,t,{includeMatches:n=x.includeMatches,includeScore:r=x.includeScore}={}){let o=[];return n&&o.push(ic),r&&o.push(ac),e.map(s=>{let{idx:a}=s,i={item:t[a],refIndex:a};return o.length&&o.forEach(u=>{u(s,i)}),i})}var Ie=class{constructor(t,n={},r){this.options={...x,...n},this.options.useExtendedSearch,this._keyStore=new Tn(this.options.keys),this.setCollection(t,r)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof Ze))throw new Error(Ua);this._myIndex=n||ps(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){J(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){let n=[];for(let r=0,o=this._docs.length;r<o;r+=1){let s=this._docs[r];t(s,r)&&(this.removeAt(r),r-=1,o-=1,n.push(s))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){let{includeMatches:r,includeScore:o,shouldSort:s,sortFn:a,ignoreFieldNorm:i}=this.options,u=ce(t)?ce(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return sc(u,{ignoreFieldNorm:i}),s&&u.sort(a),cs(n)&&n>-1&&(u=u.slice(0,n)),cc(u,this._docs,{includeMatches:r,includeScore:o})}_searchStringList(t){let n=In(t,this.options),{records:r}=this._myIndex,o=[];return r.forEach(({v:s,i:a,n:i})=>{if(!J(s))return;let{isMatch:u,score:c,indices:m}=n.searchIn(s);u&&o.push({item:s,idx:a,matches:[{score:c,value:s,norm:i,indices:m}]})}),o}_searchLogical(t){let n=ms(t,this.options),r=(i,u,c)=>{if(!i.children){let{keyId:f,searcher:g}=i,h=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(u,f),searcher:g});return h&&h.length?[{idx:c,item:u,matches:h}]:[]}let m=[];for(let f=0,g=i.children.length;f<g;f+=1){let h=i.children[f],b=r(h,u,c);if(b.length)m.push(...b);else if(i.operator===Ft.AND)return[]}return m},o=this._myIndex.records,s={},a=[];return o.forEach(({$:i,i:u})=>{if(J(i)){let c=r(n,i,u);c.length&&(s[u]||(s[u]={idx:u,item:i,matches:[]},a.push(s[u])),c.forEach(({matches:m})=>{s[u].matches.push(...m)}))}}),a}_searchObjectList(t){let n=In(t,this.options),{keys:r,records:o}=this._myIndex,s=[];return o.forEach(({$:a,i})=>{if(!J(a))return;let u=[];r.forEach((c,m)=>{u.push(...this._findMatches({key:c,value:a[m],searcher:n}))}),u.length&&s.push({idx:i,item:a,matches:u})}),s}_findMatches({key:t,value:n,searcher:r}){if(!J(n))return[];let o=[];if(fe(n))n.forEach(({v:s,i:a,n:i})=>{if(!J(s))return;let{isMatch:u,score:c,indices:m}=r.searchIn(s);u&&o.push({score:c,key:t,value:s,idx:a,norm:i,indices:m})});else{let{v:s,n:a}=n,{isMatch:i,score:u,indices:c}=r.searchIn(s);i&&o.push({score:u,key:t,value:s,norm:a,indices:c})}return o}};Ie.version="7.0.0";Ie.createIndex=ps;Ie.parseIndex=za;Ie.config=x;Ie.parseQuery=ms;nc(Cn);export{Kr as a,k as b,_r as c,mc as d,K as e,We as f,fc as g,Me as h,dt as i,X as j,Fs as k,Ms as l,Dr as m,Ht as n,_s as o,ca as p,ua as q,mn as r,fa as s,Ds as t,ga as u,ya as v,qi as w,Zt as x,El as y,Jr as z,xl as A,cd as B,ui as C,Yd as D,te as E,gt as F,lo as G,po as H,yt as I,Be as J,ae as K,go as L,we as M,Ti as N,ke as O,_e as P,Se as Q,kt as R,Qi as S,Co as T,ko as U,Ue as V,vt as W,Eo as X,Po as Y,Io as Z,dn as _,Xi as $,yn as aa,na as ba,ha as ca,Ta as da,aa as ea,wa as fa,Ie as ga,zo as ha,Ia as ia,Fa as ja};
//# sourceMappingURL=chunk-BHIJKWN7.js.map
