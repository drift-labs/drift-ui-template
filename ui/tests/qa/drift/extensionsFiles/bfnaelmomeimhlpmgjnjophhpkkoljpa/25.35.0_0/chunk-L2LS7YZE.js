import{H as nt,J as Q,K as rt,M as x,P as it,Q as W,U as st,V as B,fa as C,ha as F,pa as j,t as ot}from"./chunk-YITPJN7X.js";import{gb as at,ja as z,ka as v}from"./chunk-QSYOXIBV.js";import{mb as P,rc as N}from"./chunk-LHPEWMJX.js";import{oa as et}from"./chunk-HTY647YJ.js";import{Ic as I,Kc as b,Nc as tt,O,R as U,S as s,X as Z,_ as X,jc as $,mc as D,xb as c}from"./chunk-E2A6YDRV.js";import{X as g,c as E}from"./chunk-BEUYJGED.js";import{f as K,h as n,n as r}from"./chunk-64CIGK2X.js";n();r();var M=K(E());n();r();var ct={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"info.name",weight:.5},{name:"info.keybaseUsername",weight:.3},{name:"info.website",weight:.1},{name:"voteAccountPubkey",weight:.1},{name:"identityPubkey",weight:.1}]},ut={identityPublicKey:"7GkMBmtrTZz8QbjSe1sXvAUtz7Pp42SQxfT5ymmJD4We",voteAccountPublicKey:"J2nUHEAgZFRyuJbFjdqPrAa9gyWDuc7hErtDQHPhsYRp"};n();r();var mt=e=>(o,i)=>{let t=e.indexOf(o.voteAccountPubkey),m=e.indexOf(i.voteAccountPubkey);return(t>-1?t:1/0)-(m>-1?m:1/0)};n();r();n();r();var dt=new Error("Failed to fetch recommended staking validators.");async function lt(){try{let e=await Z.api().get("/staking/v1/recommended");if(!X(e))throw dt;let o=e.data;return nt.parse(o).validators}catch{throw dt}}var pt=()=>{let e=rt.recommendedValidators();return tt({enabled:!0,queryKey:e,gcTime:it.Long,staleTime:1/0,async queryFn(){return lt()}})};function At(){let{connection:e}=z(),o=W(e),{results:i=[]}=o,t=pt(),{data:m=null,isFetched:V}=j(),T=$.isFeatureEnabled("kill-phantom-validator"),[a,u]=(0,M.useState)(""),y=et(a),k=(0,M.useMemo)(()=>{let A=i.map(R=>({...R,totalApy:m?Q(m,R?.commission):null})),S=t.data??[];if(S.length===0)return A;let L=A.sort(mt(S));return T?L.filter(R=>R.identityPubkey!==ut.identityPublicKey):L},[i,t.data,m,T]),h=ot(k,y||"",ct),d=(0,M.useCallback)(()=>{o.isError&&!o.isFetching&&o.refetch(),t.isError&&!t.isFetching&&t.refetch()},[t,o]),l=!o.isFetched||!V||!t.isFetched,f=o.isError||t.isError,w=o.isSuccess;return{isLoading:l,isSuccess:w,hasError:f,searchResults:h,showApy:m!==null,onRefetch:d,searchTerm:a,setSearchTerm:u}}n();r();function gt({stakePubkey:e,stakeAuthorityPubkey:o,authorizedPubkey:i,transaction:t=new U.Transaction}){return o.equals(i)||t.add(s.StakeProgram.authorize({authorizedPubkey:i,newAuthorizedPubkey:i,stakeAuthorizationType:s.StakeAuthorizationLayout.Staker,stakePubkey:e})),t.add(s.StakeProgram.deactivate({stakePubkey:e,authorizedPubkey:i})),t}var ht=e=>{let{t:o}=g(),i=I(),t=x(),{mutateAsync:m}=v(e);return b({mutationFn:async({accountIdentifier:a,senderAddress:u,stakePubkey:y,stakeAuthorityPubkey:k,authorizedPubkey:h})=>{if(!u)throw C;let{networkID:d,address:l}=u,f=gt({stakePubkey:y,stakeAuthorityPubkey:k,authorizedPubkey:h}),w=await P(f,{connection:e}),A={ownerAddress:l??"",networkID:d,data:{signature:""},type:"deactivateState",display:{summary:{topLeft:{text:o("transactionsPendingDeactivatingStake")}}}};t.approved({chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),type:"undelegate"});let S=await m({accountIdentifier:a,feePayer:new s.PublicKey(l),transaction:w,pendingTransactionInput:A});return t.submittedTransaction(S,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),method:"signAndSendTransaction"}),t.deactivateStake(),{networkID:d,id:S??""}},onSuccess:a=>{N({connection:e,signature:a.id}).then(()=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"confirmed"}})}).catch(u=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"error"}}),D.captureError(u,"staking")}),F(e,a.id,i)}})};n();r();function J({stakePubkey:e,authorizedPubkey:o,votePubkey:i}){return s.StakeProgram.delegate({stakePubkey:e,authorizedPubkey:o,votePubkey:i})}var wt=e=>{let{t:o}=g(),i=I(),t=x(),{mutateAsync:m}=v(e);return b({mutationFn:async({accountIdentifier:a,senderAddress:u,stakePubkey:y,authorizedPubkey:k,votePubkey:h})=>{if(!u)throw C;let{networkID:d,address:l}=u,f=J({stakePubkey:y,authorizedPubkey:k,votePubkey:h}),w=await P(f,{connection:e}),A={ownerAddress:l??"",networkID:d,data:{signature:""},type:"delegateStake",display:{summary:{topLeft:{text:o("transactionsPendingDelegatingStake")}}}};t.approved({chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),type:"delegate"});let S=await m({accountIdentifier:a,feePayer:new s.PublicKey(l),transaction:w,pendingTransactionInput:A});return t.submittedTransaction(S,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),method:"signAndSendTransaction"}),{networkID:d,id:S??""}},onSuccess:a=>{N({connection:e,signature:a.id}).then(()=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"confirmed"}})}).catch(u=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"error"}}),D.captureError(u,"staking")}),F(e,a.id,i)}})};n();r();function Tt({stakePubkey:e,authorizedPubkey:o,amount:i,transaction:t=new U.Transaction}){return t.add(s.StakeProgram.withdraw({stakePubkey:e,authorizedPubkey:o,toPubkey:o,lamports:i})),t}var Dt=e=>{let{t:o}=g(),i=I(),t=x(),{mutateAsync:m}=v(e);return b({mutationFn:async({accountIdentifier:a,senderAddress:u,stakePubkey:y,authorizedPubkey:k,amount:h})=>{if(!u)throw C;let{networkID:d,address:l}=u,f=Tt({stakePubkey:y,authorizedPubkey:k,amount:h}),w=await P(f,{connection:e}),A={ownerAddress:l??"",networkID:d,data:{signature:""},type:"withdrawStake",display:{summary:{topLeft:{text:o("transactionsPendingWithdrawingStake")}}}};t.approved({chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),type:"withdraw"});let S=await m({accountIdentifier:a,feePayer:new s.PublicKey(l),transaction:w,pendingTransactionInput:A});return t.submittedTransaction(S,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),method:"signAndSendTransaction"}),{networkID:d,id:S??""}},onSuccess:a=>{N({connection:e,signature:a.id}).then(()=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"confirmed"}})}).catch(u=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"error"}}),D.captureError(u,"staking")}),F(e,a.id,i)}})};n();r();function It({ownerPublicKey:e,lamports:o,transaction:i=new U.Transaction}){let t=s.Keypair.generate();return i.add(s.StakeProgram.createAccount({fromPubkey:e,stakePubkey:t.publicKey,authorized:new s.Authorized(e,e),lamports:o})),[i,t]}function bt({lamports:e,votePubkey:o,authorizedPubkey:i}){let[t,m]=It({ownerPublicKey:i,lamports:e});return t.add(J({stakePubkey:m.publicKey,authorizedPubkey:i,votePubkey:o})),[t,m]}var Pt=e=>{let{t:o}=g(),i=I(),t=x(),{mutateAsync:m}=v(e);return b({mutationFn:async({accountIdentifier:a,senderAddress:u,lamports:y,votePubkey:k,authorizedPubkey:h,usdPerSol:d})=>{if(!u)throw C;let{networkID:l,address:f}=u,[w,A]=bt({accountIdentifier:a,senderAddress:u,lamports:y,votePubkey:k,authorizedPubkey:h}),S=await P(w,{connection:e}),L={ownerAddress:f??"",networkID:l,data:{signature:""},type:"createAccountAndDelegateStake",display:{summary:{topLeft:{text:o("transactionsPendingCreatingAndDelegatingStake")}}}};t.approved({chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(l),type:"delegate"});let R=await m({accountIdentifier:a,feePayer:new s.PublicKey(f),transaction:S,pendingTransactionInput:L,opts:{additionalSignerAccounts:[A]}});t.submittedTransaction(R,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(l),method:"signAndSendTransaction"});let Y=O(y),ft=d?Y.times(d):void 0;return t.createStakeAccountAndDelegateStake({sol:Y.toNumber(),usd:ft?.toNumber(),voteAccountPubkey:k}),{networkID:l,id:R??""}},onSuccess:a=>{N({connection:e,signature:a.id}).then(()=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"confirmed"}})}).catch(u=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"error"}}),D.captureError(u,"staking")}),F(e,a.id,i)}})};n();r();n();r();var St=K(E());n();r();var xt=K(E());n();r();var yt=K(E());function kt({navigateToConvertStakeAccount:e}){let{t:o}=g(),{pickedLSTProvider:i}=B(c.solana.mainnetID),t=i(at,!0),{hasConvertibleStakeAccounts:m}=st(t),V=o("convertToPhantomLST"),T=(0,yt.useCallback)(()=>{e()},[e]);return{shouldShowLiquidStakingCTA:m,title:V,onPress:T}}n();r();var Nt=K(E());n();r();var vt=K(E());n();r();export{At as a,kt as b,ht as c,wt as d,Dt as e,Pt as f};
//# sourceMappingURL=chunk-L2LS7YZE.js.map
