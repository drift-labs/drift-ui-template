import{a as It}from"./chunk-3AM32FHM.js";import"./chunk-QXZG5UMO.js";import"./chunk-LKCENBJT.js";import{a as Vt}from"./chunk-D54DG5S6.js";import"./chunk-XZRRLELF.js";import"./chunk-HTEWVCFR.js";import{b as Dt,d as v}from"./chunk-5F2VOKO3.js";import"./chunk-VTQFUHCP.js";import{o as Bt,p as Wt}from"./chunk-MOTGUR2H.js";import{b as Pt}from"./chunk-J26VE65N.js";import"./chunk-KKMQB65C.js";import"./chunk-7JKUY6KU.js";import"./chunk-YY4B3XV7.js";import"./chunk-L2LS7YZE.js";import"./chunk-GROXNBTY.js";import"./chunk-OZFKX4E3.js";import"./chunk-57E56ETC.js";import"./chunk-HO6FHTKM.js";import"./chunk-H6IC2DCX.js";import"./chunk-WF3NVBQY.js";import{g as Tt,k as x}from"./chunk-TALMQQTZ.js";import"./chunk-WSJ272XI.js";import"./chunk-S32BDL22.js";import"./chunk-GQ5HEJWI.js";import"./chunk-KGWRBMZX.js";import"./chunk-BSK64RRL.js";import"./chunk-BUTFRTU6.js";import"./chunk-HX3WMS5S.js";import"./chunk-ZYPI3ESJ.js";import"./chunk-6EZHAYJL.js";import"./chunk-BRQKCECY.js";import"./chunk-YOO3KN23.js";import{A as F,D as At,Q as Ct,R as ft,X as wt,ka as ht,na as yt,oa as xt}from"./chunk-YITPJN7X.js";import"./chunk-CQIC5IDD.js";import{S as St}from"./chunk-BHIJKWN7.js";import"./chunk-6N4GZCP2.js";import"./chunk-5OF7XKWY.js";import"./chunk-5AA7BGLC.js";import{Y as vt,jb as gt}from"./chunk-QSYOXIBV.js";import"./chunk-O7KQ5SYD.js";import"./chunk-V76BEUYF.js";import"./chunk-3U4MKOCV.js";import"./chunk-63PE5ZXT.js";import{a as bt}from"./chunk-ZTFOFBVC.js";import{db as i,m as s}from"./chunk-FVUSQHVT.js";import"./chunk-HUS6FTFG.js";import"./chunk-NCSBB2TA.js";import{b as ut}from"./chunk-4BKJE7YB.js";import{b as E}from"./chunk-KY4L2TTE.js";import"./chunk-W47K3OCY.js";import"./chunk-25TPEQ2Q.js";import"./chunk-E7B2SEGG.js";import"./chunk-XD32MQ4W.js";import{cb as mt,db as pt}from"./chunk-LHPEWMJX.js";import{Z as dt,_ as kt}from"./chunk-HTY647YJ.js";import{Bd as O,Sb as it,ec as rt,gf as st,xb as at}from"./chunk-E2A6YDRV.js";import{R as nt}from"./chunk-4XTMHWN2.js";import{Ca as ct,Da as lt,X as g,c as ot,cb as p,ya as r}from"./chunk-BEUYJGED.js";import"./chunk-3C334UTS.js";import"./chunk-3JLWNHUO.js";import"./chunk-KHOMEOLW.js";import{f as et,h,n as y}from"./chunk-64CIGK2X.js";h();y();var t=et(ot());h();y();var k=et(ot());var qt=s.div`
  display: grid;
  grid-template-columns: 100%;
  grid-template-rows: 47px auto;
  align-items: center;
  justify-content: flex-start;
  background: ${r.colors.legacy.elementBase};
  width: 328px;
  border-radius: 6px;
  margin-top: 24px;
`,Yt=s.div`
  display: grid;
  gap: 10px;
  grid-template-columns: 33px 1fr auto;
  align-items: center;
  padding: 9px 14px;
  border-bottom: 1px solid ${r.colors.legacy.areaBase};
`,Gt=s(Dt)``,Jt=s.section`
  padding: 14px;
`,Xt=s.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  height: 30px;
  align-items: center;
`,Zt=s(i)`
  color: ${n=>n.activationState==="active"?r.colors.legacy.spotPositive:n.activationState==="inactive"?r.colors.legacy.spotNegative:n.activationState==="activating"?r.colors.brand.yellowMoon:n.activationState==="deactivating"?r.colors.brand.yellowMoon:r.colors.legacy.textDiminished};
`,Rt=s(Vt).attrs(()=>({tooltipAlignment:"bottomCenter",iconSize:12,lineHeight:17,fontWeight:400,fontSize:14,noWrap:!0}))``,H=n=>{let{t:o}=g(),{data:c}=ht(n.validatorKeybaseUsername),m=n.validatorName??n.validatorKeybaseUsername??n.voteAccountPubkey??n.stakeAccountPubkey;return k.default.createElement(qt,null,k.default.createElement(Yt,null,k.default.createElement(Gt,{width:28,iconUrl:n.validatorIconUrl??c}),k.default.createElement(i,{textAlign:"left",weight:600,size:16,noWrap:!0},m),k.default.createElement(Zt,{activationState:n.status,textAlign:"right",weight:400,size:14,noWrap:!0,textTransform:"capitalize"},n.status??"")),k.default.createElement(Jt,null,Object.entries(n.data).map(([l,a])=>k.default.createElement(Xt,{key:l,onClick:a.onClick},k.default.createElement(Rt,{info:a.tooltip?k.default.createElement(Wt,null,k.default.createElement(Bt,null,a.tooltip)):null},l==="Stake Account"?o("stakeAccountCardStakeAccount"):"",l==="Balance"?o("stakeAccountCardBalance"):"",l==="Rent Reserve"?o("stakeAccountCardRentReserve"):"",l==="Active Stake"?o("stakeAccountCardActiveStake"):"",l==="Lockup"?o("stakeAccountCardLockup"):"",l==="Rewards"?o("stakeAccountCardRewards"):""),a.node))))};var b=s.div`
  position: relative;
  display: grid;
  grid-template-rows: ${n=>n.canConvertStake?"42px auto 109px":"42px auto 47px"};
  height: 100%;
`,P=s.div`
  display: flex;
  flex-direction: column;
  align-items: center;
`,M=s.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  color: ${r.colors.legacy.spotBase};
  text-decoration: none;
  cursor: pointer;
`,T=s.section`
  display: flex;
  gap: 15px;
`,te=s.section`
  display: flex;
  gap: 15px;
  flex-direction: column;
`,ee=s.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
`,oe=5e3,ne=n=>{let{t:o}=g(),{showStakeAccountDeactivateStakeStatusModal:c,showStakeAccountDelegateStakeStatusModal:m,showStakeAccountWithdrawStakeStatusModal:l,closeAllModals:a}=Pt(),{data:w}=st(),S=(0,t.useMemo)(()=>w?.addresses.find(f=>at.isSolanaNetworkID(f.networkID)),[w]),{solanaPublicKey:D,connection:B,networkID:K}=(0,t.useMemo)(()=>{let f=S?.address??"",tt=S?.networkID,Qt=mt(pt(tt));return{solanaPublicKey:f,connection:Qt,networkID:tt}},[S]),Lt=it("solana"),{data:zt}=vt({query:{data:Lt}}),{data:_}=St(),W=zt?.usd,A=yt(B,D),e=A.data?.find(f=>f.pubkey===n.stakeAccountPubkey),V=e?.info.meta.authorized.staker,Ot=e?.lamports??0,j=parseFloat(e?.info.meta.rentExemptReserve??"0"),Et=!!e?.inflationReward,{data:Ft=j}=gt(S),I=!!(_&&new nt(_.totalQuantityString).gt(Ft+oe)),u=xt(B,e?.pubkey).data,Ht=u?.active??0,Mt=u?.inactive??0,U=Ot-j-Ht,Q=e?.info.stake?.delegation.voter,Kt=ae(B),d=Q?Kt.get(Q):void 0,$=new Date((e?.info.meta.lockup?.unixTimestamp??0)*1e3),N=ft(e),q=(u?.state==="active"||u?.state==="activating")&&I,L=u?.state==="inactive"&&!N&&I,C=rt("enable-psol-native-convert")&&L,{data:_t}=dt(K),{data:Y}=kt(K,e?.pubkey??""),{pushDetailView:G}=Tt(),jt=(0,t.useCallback)(()=>{G(t.default.createElement(It,null))},[G]),J=wt(jt),X=(0,t.useCallback)(()=>{if(!e)throw new Error("Stake account not found");J({stakeAccount:e,validatorName:d?.info?.name??"",activationState:u?.state})},[J,e,d,u]),z=[{key:"viewOnExplorer",label:o("stakeAccountViewViewOnExplorer",{explorer:_t}),onClick:()=>{Y&&self.open(Y,"_blank")}}];e&&(d&&(u?.state==="inactive"||u?.state==="deactivating")&&z.push({key:"restake",label:o("stakeAccountViewRestake"),onClick:()=>{m({stakeAccountPubkey:e.pubkey,voteAccountPubkey:d?.voteAccountPubkey,lamports:u.inactive,onClose:a})}}),U>0&&U>Mt&&z.push({key:"withdrawUnstakedSOL",label:o("stakeAccountViewWithdrawUnstakedSOL"),onClick:()=>{l({stakeAccountPubkey:e.pubkey,amount:U,usdPerSol:W,onClose:a})}}));let Z=(0,t.useCallback)(()=>{!e||!V||c({stakeAccountPubkey:e.pubkey,stakeAuthorityPubkey:V,onClose:a})},[e,V,c,a]),R=(0,t.useCallback)(()=>{e&&l({stakeAccountPubkey:e.pubkey,amount:e.lamports,usdPerSol:W,onClose:a})},[e,l,W,a]);return A.isPending?t.default.createElement(b,null,t.default.createElement(bt,null)):A.isError?t.default.createElement(b,null,t.default.createElement(x,null,o("stakeAccountViewPrimaryText")),t.default.createElement(P,null,t.default.createElement(i,{size:16,color:r.colors.legacy.textDiminished,lineHeight:20},A.error?.message??o("stakeAccountViewError"))),t.default.createElement(T,null,t.default.createElement(p,{onClick:a},o("commandClose")))):A.isSuccess&&e?t.default.createElement(b,{canConvertStake:C},t.default.createElement(x,{items:z},o("stakeAccountViewPrimaryText")),d?t.default.createElement(t.default.Fragment,null,t.default.createElement(P,null,t.default.createElement(Ut,{canConvertStake:C,hasValidator:!!d}),t.default.createElement(H,{stakeAccountPubkey:e.pubkey,voteAccountPubkey:d?.voteAccountPubkey,validatorName:d?.info?.name,validatorKeybaseUsername:d?.info?.keybaseUsername,validatorIconUrl:d?.info?.iconUrl,status:u?.state,data:{"Stake Account":{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},O(e.pubkey))},Balance:{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(v,null,e.lamports))},"Rent Reserve":{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(v,null,e.info.meta.rentExemptReserve))},"Active Stake":{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(v,null,u?.active))},Lockup:{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},N?E($):"\u2013")},Rewards:Et?{node:t.default.createElement(ee,null,t.default.createElement(i,{color:r.colors.legacy.spotPositive,textAlign:"right",weight:500,size:14,noWrap:!0},"+",t.default.createElement(v,null,e?.inflationReward))),tooltip:o("stakeAccountCardRewardsTooltip")}:{node:t.default.createElement(i,{color:r.colors.legacy.textDiminished,textAlign:"right",weight:500,size:14,noWrap:!0},"\u2013")}}}),I?null:t.default.createElement(ct,{marginY:"base"},t.default.createElement(lt,{color:"spotNegative",children:o("stakeAccountInsufficientFunds")}))),t.default.createElement(Nt,{canConvertStake:C,canUnstake:q,canWithdrawStake:L,onClose:a,onUnstake:Z,onWithdrawStake:R,onConvertStake:X})):t.default.createElement(t.default.Fragment,null,t.default.createElement(P,null,t.default.createElement(Ut,{canConvertStake:C,hasValidator:!!d}),t.default.createElement(H,{stakeAccountPubkey:e.pubkey,status:u?.state,data:{"Stake Account":{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},O(e.pubkey))},Balance:{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(v,null,e.lamports))},"Rent Reserve":{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(v,null,e.info.meta.rentExemptReserve))},"Active Stake":{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},t.default.createElement(v,null,u?.active))},Lockup:{node:t.default.createElement(i,{textAlign:"right",weight:500,size:14,noWrap:!0},N?E($):"\u2013")}}})),t.default.createElement(Nt,{canUnstake:q,canWithdrawStake:L,canConvertStake:C,onClose:a,onUnstake:Z,onWithdrawStake:R,onConvertStake:X}))):t.default.createElement(b,null,t.default.createElement(x,null,o("stakeAccountViewPrimaryText")),t.default.createElement(P,null,t.default.createElement(i,{size:16,color:r.colors.legacy.textDiminished,lineHeight:20},o("stakeAccountViewStakeNotFound"))),t.default.createElement(T,null,t.default.createElement(p,{onClick:a},o("commandClose"))))},je=ne,Ut=({canConvertStake:n,hasValidator:o})=>{let{t:c}=g();return n?t.default.createElement(i,{size:16,color:r.colors.legacy.textDiminished,lineHeight:20},c("stakeAccountViewStakeInactiveToPSOL.part1")," ",t.default.createElement(M,{href:At},c("stakeAccountViewStakeInactiveToPSOL.part2"))):o?t.default.createElement(i,{size:16,color:r.colors.legacy.textDiminished,lineHeight:20},t.default.createElement(ut,{i18nKey:"stakeAccountViewSOLCurrentlyStakedInterpolated"},"Your SOL is currently staked with a validator. You\u2019ll need to unstake to ",t.default.createElement("br",null),"access these funds. ",t.default.createElement(M,{href:F},"Learn more"))):t.default.createElement(i,{size:16,color:r.colors.legacy.textDiminished,lineHeight:20},c("stakeAccountViewStakeInactive.part1")," ",t.default.createElement(M,{href:F},c("stakeAccountViewStakeInactive.part2")))},Nt=n=>{let{t:o}=g(),{canUnstake:c,canWithdrawStake:m,canConvertStake:l,onClose:a,onUnstake:w,onWithdrawStake:S,onConvertStake:D}=n;return l?t.default.createElement(te,null,t.default.createElement(p,{background:"spot",onClick:D},o("convertToPhantomLST")),t.default.createElement(T,null,t.default.createElement(p,{onClick:a},o("commandClose")),t.default.createElement(p,{onClick:S},o("stakeAccountViewWithdrawStake")))):t.default.createElement(T,null,t.default.createElement(p,{onClick:a},o("commandClose")),m&&t.default.createElement(p,{onClick:S},o("stakeAccountViewWithdrawStake")),c&&t.default.createElement(p,{background:"spot",onClick:w},o("stakeAccountViewActionButtonUnstake")))},ae=n=>{let o=Ct(n),c=o.results??[],m=(0,t.useRef)(c);return m.current=c,(0,t.useMemo)(()=>new Map(m.current.map(a=>[a.voteAccountPubkey,a])),[o.dataUpdatedAt,m])};export{ne as StakeAccountDetailPage,je as default};
//# sourceMappingURL=StakeAccountDetailPage-4AISYCQC.js.map
