import{$ as ca,A as er,B as aa,M as Tt,Q as no,R as tr,a as Rt,aa as ua,ba as la,c as He,ca as nr,d as Jn,da as tn,ea as ro,ha as ma,k as na,l as ra,m as oa,n as Zn,p as ia,r as sa,w as en,x as ce}from"./chunk-QCKHHJ5F.js";import{e as da,f as pa,g as fa}from"./chunk-GCJPSL4T.js";import{$ as ds,f as cs,h as us,ma as ps,n as ls,s as Yr}from"./chunk-R5GARSZH.js";import{$a as Fe,C as rs,D as os,Za as is,k as Ve,tb as ss,vb as as}from"./chunk-VOCOWPRG.js";import{$a as Wn,$b as Zt,A as Zr,B as Ps,Db as Qs,Fb as Ks,Gb as Hs,I as Cs,J as ks,Jb as qs,L as xs,N as Jt,Nb as js,O as Is,P as Gn,Q as Ds,Qb as Yn,R as Ns,S as _t,Sb as Ws,T as Qn,U as Kn,V as Ot,Vb as zs,Wb as $s,X as Hn,Y as qn,Z as _s,Za as Ms,_ as Os,_a as gt,aa as jn,bb as bt,bc as Ys,c as ms,cb as Fs,cc as to,da as eo,db as zn,e as V,ec as Xs,fc as Js,g as fs,gb as $n,h as ys,hc as Zs,i as Vn,ib as Rs,j as hs,k as gs,l as Xr,m as Jr,p as bs,pb as Us,pc as Xn,q as Ts,qb as Mt,r as vs,rc as ea,s as Es,t as ws,u as As,uc as Ft,v as zl,vb as $l,w as Xt,wb as Bs,x as Ss,xb as Ls,yb as Vs,yc as ta,zb as Gs}from"./chunk-F63TUCMM.js";import{a as zr}from"./chunk-CJHTJRVG.js";import{$b as ji,Fa as yt,Gc as Yt,Lc as Fn,Mc as Ji,Pc as _,Rd as v,T as Qi,U as X,W as Nn,Wb as Hi,Y as $t,Yb as qi,Z as _n,Zb as A,_ as $,_c as ae,_d as Re,ad as Rn,ba as Pe,bc as Wi,ca as On,cc as Le,cd as Un,dc as J,fb as Ll,fc as Wr,fd as Bn,gc as ht,gd as Zi,hd as es,id as ts,j as Ul,jd as W,k as Bl,ka as Ce,kd as ns,ld as Ie,od as I,qc as zi,rc as $i,sc as Mn,wa as Ki,wc as Yi,xc as Xi,z as Nt}from"./chunk-PJ6PRBE2.js";import{R as L,S as H,c as jr,e as Rl,u as Gi}from"./chunk-DHKCVHRA.js";import{B as In,D as Dn,Qb as Wl,R as Vl,S as te,Sa as jl,X as Me,Za as $r,_a as Ln,aa as Gl,ba as Ql,c as B,ea as Kl,f as ot,fa as Hl,ga as ql,l as h,nc as Yl,oc as Xl,r as xn}from"./chunk-UTOBJRXZ.js";import{c as Se,f as M,g as Fl,h as c,i as f,m as Buffer,n as u}from"./chunk-SVG5OEFH.js";var Ha=Se((YT,Ka)=>{c();u();var Um=Gl(),Bm=Ql(),Lm=jl(),Vm=Hl(),Gm=Kl(),Qm=ql(),Km=Object.prototype,Hm=Km.hasOwnProperty,qm=Lm(function(t,e){if(Gm(e)||Vm(e)){Bm(e,Qm(e),t);return}for(var n in e)Hm.call(e,n)&&Um(t,n,e[n])});Ka.exports=qm});var fr=Se(Y=>{"use strict";c();u();Object.defineProperty(Y,"__esModule",{value:!0});Y.MULTIPLE_ACCOUNT_INFO_MAX=Y.NAME_HOUSE_PREFIX=Y.TLD_HOUSE_PREFIX=Y.NFT_RECORD_PREFIX=Y.TOKEN_METADATA_PROGRAM_ID=Y.SPL_TOKEN_PROGRAM_ID=Y.NAME_HOUSE_PROGRAM_ID=Y.TLD_HOUSE_PROGRAM_ID=Y.ANS_PROGRAM_ID=Y.ORIGIN_TLD=Y.MAIN_DOMAIN_PREFIX=void 0;var mn=Nt();Y.MAIN_DOMAIN_PREFIX="main_domain";Y.ORIGIN_TLD="ANS";Y.ANS_PROGRAM_ID=new mn.PublicKey("ALTNSZ46uaAUU7XUV6awvdorLGqAsPwa9shm7h4uP2FK");Y.TLD_HOUSE_PROGRAM_ID=new mn.PublicKey("TLDHkysf5pCnKsVA4gXpNvmy7psXLPEu4LAdDJthT9S");Y.NAME_HOUSE_PROGRAM_ID=new mn.PublicKey("NH3uX6FtVE2fNREAioP7hm5RaozotZxeL6khU1EHx51");Y.SPL_TOKEN_PROGRAM_ID=new mn.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");Y.TOKEN_METADATA_PROGRAM_ID=new mn.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s");Y.NFT_RECORD_PREFIX="nft_record";Y.TLD_HOUSE_PREFIX="tld_house";Y.NAME_HOUSE_PREFIX="name_house";Y.MULTIPLE_ACCOUNT_INFO_MAX=100});var Ec=Se(q=>{"use strict";c();u();var Sd=q&&q.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Pd=q&&q.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),je=q&&q.__decorate||function(t,e,n,r){var o=arguments.length,i=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(i=(o<3?s(i):o>3?s(e,n,i):s(e,n))||i);return o>3&&i&&Object.defineProperty(e,n,i),i},Cd=q&&q.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.hasOwnProperty.call(t,n)&&Sd(e,t,n);return Pd(e,t),e},gc=q&&q.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(q,"__esModule",{value:!0});q.deserializeUnchecked=q.deserialize=q.serialize=q.BinaryReader=q.BinaryWriter=q.BorshError=q.baseDecode=q.baseEncode=void 0;var it=gc(jr()),bc=gc(Rl()),kd=Cd(Ul()),xd=typeof self.TextDecoder!="function"?kd.TextDecoder:self.TextDecoder,Id=new xd("utf-8",{fatal:!0});function Dd(t){return typeof t=="string"&&(t=Buffer.from(t,"utf8")),bc.default.encode(Buffer.from(t))}q.baseEncode=Dd;function Nd(t){return Buffer.from(bc.default.decode(t))}q.baseDecode=Nd;var _o=1024,pe=class extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}};q.BorshError=pe;var yr=class{constructor(){this.buf=Buffer.alloc(_o),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(_o)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(Buffer.from(new it.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(Buffer.from(new it.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(Buffer.from(new it.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(Buffer.from(new it.default(e).toArray("le",64)))}writeBuffer(e){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),e,Buffer.alloc(_o)]),this.length+=e.length}writeString(e){this.maybeResize();let n=Buffer.from(e,"utf8");this.writeU32(n.length),this.writeBuffer(n)}writeFixedArray(e){this.writeBuffer(Buffer.from(e))}writeArray(e,n){this.maybeResize(),this.writeU32(e.length);for(let r of e)this.maybeResize(),n(r)}toArray(){return this.buf.subarray(0,this.length)}};q.BinaryWriter=yr;function We(t,e,n){let r=n.value;n.value=function(...o){try{return r.apply(this,o)}catch(i){if(i instanceof RangeError){let s=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(s)>=0)throw new pe("Reached the end of buffer when deserializing")}throw i}}}var we=class{constructor(e){this.buf=e,this.offset=0}readU8(){let e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){let e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){let e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){let e=this.readBuffer(8);return new it.default(e,"le")}readU128(){let e=this.readBuffer(16);return new it.default(e,"le")}readU256(){let e=this.readBuffer(32);return new it.default(e,"le")}readU512(){let e=this.readBuffer(64);return new it.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new pe(`Expected buffer length ${e} isn't within bounds`);let n=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,n}readString(){let e=this.readU32(),n=this.readBuffer(e);try{return Id.decode(n)}catch(r){throw new pe(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){let n=this.readU32(),r=Array();for(let o=0;o<n;++o)r.push(e());return r}};je([We],we.prototype,"readU8",null);je([We],we.prototype,"readU16",null);je([We],we.prototype,"readU32",null);je([We],we.prototype,"readU64",null);je([We],we.prototype,"readU128",null);je([We],we.prototype,"readU256",null);je([We],we.prototype,"readU512",null);je([We],we.prototype,"readString",null);je([We],we.prototype,"readFixedArray",null);je([We],we.prototype,"readArray",null);q.BinaryReader=we;function Tc(t){return t.charAt(0).toUpperCase()+t.slice(1)}function dn(t,e,n,r,o){try{if(typeof r=="string")o[`write${Tc(r)}`](n);else if(r instanceof Array)if(typeof r[0]=="number"){if(n.length!==r[0])throw new pe(`Expecting byte array of length ${r[0]}, but got ${n.length} bytes`);o.writeFixedArray(n)}else if(r.length===2&&typeof r[1]=="number"){if(n.length!==r[1])throw new pe(`Expecting byte array of length ${r[1]}, but got ${n.length} bytes`);for(let i=0;i<r[1];i++)dn(t,null,n[i],r[0],o)}else o.writeArray(n,i=>{dn(t,e,i,r[0],o)});else if(r.kind!==void 0)switch(r.kind){case"option":{n==null?o.writeU8(0):(o.writeU8(1),dn(t,e,n,r.type,o));break}default:throw new pe(`FieldType ${r} unrecognized`)}else vc(t,n,o)}catch(i){throw i instanceof pe&&i.addToFieldPath(e),i}}function vc(t,e,n){if(typeof e.borshSerialize=="function"){e.borshSerialize(n);return}let r=t.get(e.constructor);if(!r)throw new pe(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([o,i])=>{dn(t,o,e[o],i,n)});else if(r.kind==="enum"){let o=e[r.field];for(let i=0;i<r.values.length;++i){let[s,a]=r.values[i];if(s===o){n.writeU8(i),dn(t,s,e[s],a,n);break}}}else throw new pe(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function _d(t,e,n=yr){let r=new n;return vc(t,e,r),r.toArray()}q.serialize=_d;function pn(t,e,n,r){try{if(typeof n=="string")return r[`read${Tc(n)}`]();if(n instanceof Array){if(typeof n[0]=="number")return r.readFixedArray(n[0]);if(typeof n[1]=="number"){let o=[];for(let i=0;i<n[1];i++)o.push(pn(t,null,n[0],r));return o}else return r.readArray(()=>pn(t,e,n[0],r))}return n.kind==="option"?r.readU8()?pn(t,e,n.type,r):void 0:Oo(t,n,r)}catch(o){throw o instanceof pe&&o.addToFieldPath(e),o}}function Oo(t,e,n){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(n);let r=t.get(e);if(!r)throw new pe(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){let o={};for(let[i,s]of t.get(e).fields)o[i]=pn(t,i,s,n);return new e(o)}if(r.kind==="enum"){let o=n.readU8();if(o>=r.values.length)throw new pe(`Enum index: ${o} is out of range`);let[i,s]=r.values[o],a=pn(t,i,s,n);return new e({[i]:a})}throw new pe(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Od(t,e,n,r=we){let o=new r(n),i=Oo(t,e,o);if(o.offset<n.length)throw new pe(`Unexpected ${n.length-o.offset} bytes after deserialized data`);return i}q.deserialize=Od;function Md(t,e,n,r=we){let o=new r(n);return Oo(t,e,o)}q.deserializeUnchecked=Md});var hr=Se(Lt=>{"use strict";c();u();var wc=Lt&&Lt.__awaiter||function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{l(r.next(d))}catch(p){s(p)}}function m(d){try{l(r.throw(d))}catch(p){s(p)}}function l(d){d.done?i(d.value):o(d.value).then(a,m)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.NameRecordHeader=void 0;var Mo=Nt(),fn=Ec(),Pt=class t{constructor(e){this.parentName=new Mo.PublicKey(e.parentName),this.nclass=new Mo.PublicKey(e.nclass),this.expiresAt=new Date(new fn.BinaryReader(Buffer.from(e.expiresAt)).readU64().toNumber()*1e3),this.createdAt=new Date(new fn.BinaryReader(Buffer.from(e.createdAt)).readU64().toNumber()*1e3),this.nonTransferable=e.nonTransferable[0]!==0;let n=45*24*60*60*1e3;this.isValid=new fn.BinaryReader(Buffer.from(e.expiresAt)).readU64().toNumber()===0?!0:this.expiresAt.getTime()+n>new Date(Date.now()).getTime(),this.owner=this.isValid?new Mo.PublicKey(e.owner):void 0}static get byteSize(){return 200}static fromAccountAddress(e,n){var r;return wc(this,void 0,void 0,function*(){let o=yield e.getAccountInfo(n,"confirmed");if(!o)return;let i=(0,fn.deserializeUnchecked)(this.schema,t,o.data);return i.data=(r=o.data)===null||r===void 0?void 0:r.subarray(this.byteSize),i})}static fromMultipileAccountAddresses(e,n){return wc(this,void 0,void 0,function*(){let r=yield e.getMultipleAccountsInfo(n),o=[];return r.forEach(i=>{if(!i){o.push(void 0);return}let s=this.fromAccountInfo(i);if(!s){o.push(void 0);return}o.push(s)}),o})}static fromAccountInfo(e){var n;let r=(0,fn.deserializeUnchecked)(this.schema,t,e.data);return r.data=(n=e.data)===null||n===void 0?void 0:n.subarray(this.byteSize),r}pretty(){var e;let n=this.data.indexOf(0);return{parentName:this.parentName.toBase58(),owner:(e=this.owner)===null||e===void 0?void 0:e.toBase58(),nclass:this.nclass.toBase58(),expiresAt:this.expiresAt,createdAt:this.createdAt,nonTransferable:this.nonTransferable,isValid:this.isValid,data:this.isValid?this.data.subarray(0,n).toString():void 0}}};Lt.NameRecordHeader=Pt;Pt.DISCRIMINATOR=[68,72,88,44,15,167,103,243];Pt.HASH_PREFIX="ALT Name Service";Pt.schema=new Map([[Pt,{kind:"struct",fields:[["discriminator",[8]],["parentName",[32]],["owner",[32]],["nclass",[32]],["expiresAt",[8]],["createdAt",[8]],["nonTransferable",[1]],["padding",[79]]]}]])});var Fo=Se(De=>{"use strict";c();u();var Fd=De&&De.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Rd=De&&De.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ud=De&&De.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&Fd(e,t,n);return Rd(e,t),e};Object.defineProperty(De,"__esModule",{value:!0});De.tagBeet=De.Tag=void 0;var Bd=Ud(Zr()),Ac;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.ActiveRecord=1]="ActiveRecord",t[t.InactiveRecord=2]="InactiveRecord"})(Ac=De.Tag||(De.Tag={}));De.tagBeet=Bd.fixedScalarEnum(Ac)});var Ro=Se(oe=>{"use strict";c();u();var Ld=oe&&oe.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Vd=oe&&oe.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pc=oe&&oe.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&Ld(e,t,n);return Vd(e,t),e},Sc=oe&&oe.__awaiter||function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{l(r.next(d))}catch(p){s(p)}}function m(d){try{l(r.throw(d))}catch(p){s(p)}}function l(d){d.done?i(d.value):o(d.value).then(a,m)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(oe,"__esModule",{value:!0});oe.nftRecordBeet=oe.NftRecord=oe.nftRecordDiscriminator=void 0;var gr=Pc(Zr()),br=Pc(Ps()),Cc=Fo();oe.nftRecordDiscriminator=[174,190,114,100,177,14,90,254];var Tr=class t{constructor(e,n,r,o,i,s){this.tag=e,this.bump=n,this.nameAccount=r,this.owner=o,this.nftMintAccount=i,this.tldHouse=s}static fromArgs(e){return new t(e.tag,e.bump,e.nameAccount,e.owner,e.nftMintAccount,e.tldHouse)}static fromAccountInfo(e,n=0){return t.deserialize(e.data,n)}static fromAccountAddress(e,n){return Sc(this,void 0,void 0,function*(){let r=yield e.getAccountInfo(n);if(r==null)throw new Error(`Unable to find NftRecord account at ${n}`);return t.fromAccountInfo(r,0)[0]})}static deserialize(e,n=0){return oe.nftRecordBeet.deserialize(e,n)}serialize(){return oe.nftRecordBeet.serialize(Object.assign({accountDiscriminator:oe.nftRecordDiscriminator},this))}static get byteSize(){return oe.nftRecordBeet.byteSize}static getMinimumBalanceForRentExemption(e,n){return Sc(this,void 0,void 0,function*(){return yield e.getMinimumBalanceForRentExemption(t.byteSize,n)})}static hasCorrectByteSize(e,n=0){return e.byteLength-n===t.byteSize}pretty(){return{tag:"Tag."+Cc.Tag[this.tag],bump:this.bump,nameAccount:this.nameAccount.toBase58(),owner:this.owner.toBase58(),nftMintAccount:this.nftMintAccount.toBase58(),tldHouse:this.tldHouse.toBase58()}}};oe.NftRecord=Tr;oe.nftRecordBeet=new gr.BeetStruct([["accountDiscriminator",gr.uniformFixedSizeArray(gr.u8,8)],["tag",Cc.tagBeet],["bump",gr.u8],["nameAccount",br.publicKey],["owner",br.publicKey],["nftMintAccount",br.publicKey],["tldHouse",br.publicKey]],Tr.fromArgs,"NftRecord")});var vr=Se(R=>{"use strict";c();u();var Ke=R&&R.__awaiter||function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{l(r.next(d))}catch(p){s(p)}}function m(d){try{l(r.throw(d))}catch(p){s(p)}}function l(d){d.done?i(d.value):o(d.value).then(a,m)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0});R.splitDomainTld=R.getParsedAllDomainsNftAccountsByOwner=R.delay=R.performReverseLookupBatched=R.findMetadataAddress=R.findNameHouse=R.findTldHouse=R.findNftRecord=R.getMintOwner=R.findAllDomainsForTld=R.getParentAccountFromTldHouseAccountInfo=R.getTldFromTldHouseAccountInfo=R.getAllTld=R.findMainDomain=R.findOwnedNameAccountsForUser=R.getOriginNameAccountKey=R.getHashedName=R.getNameOwner=R.getNameAccountKeyWithBump=void 0;var Be=Nt(),Gd=jr(),Qd=Ll(),Te=fr(),Uo=hr(),Kd=Fo(),Hd=Ro();function Bo(t,e,n){let r=[t,e?e.toBuffer():Buffer.alloc(32),n?n.toBuffer():Buffer.alloc(32)];return Be.PublicKey.findProgramAddressSync(r,Te.ANS_PROGRAM_ID)}R.getNameAccountKeyWithBump=Bo;function qd(t,e,n){return Ke(this,void 0,void 0,function*(){let r=yield Uo.NameRecordHeader.fromAccountAddress(t,e),o=r.owner;if(!r.isValid)return;if(!n)return o;let[i]=Nc(n),[s]=Dc(e,i);return o?.toBase58()!==s.toBase58()?o:yield Ic(t,s)})}R.getNameOwner=qd;function Lo(t){return Ke(this,void 0,void 0,function*(){let e=Uo.NameRecordHeader.HASH_PREFIX+t,n=(0,Qd.sha256)(Buffer.from(e,"utf8")).slice(2);return Buffer.from(n,"hex")})}R.getHashedName=Lo;function jd(t=Te.ORIGIN_TLD){return Ke(this,void 0,void 0,function*(){let e=yield Lo(t),[n]=Bo(e,void 0,void 0);return n})}R.getOriginNameAccountKey=jd;function Wd(t,e,n){return Ke(this,void 0,void 0,function*(){let r=[{memcmp:{offset:40,bytes:e.toBase58(),encoding:"base58"}}];return n&&r.push({memcmp:{offset:8,bytes:n.toBase58(),encoding:"base58"}}),(yield t.getProgramAccounts(Te.ANS_PROGRAM_ID,{filters:r})).map(i=>i.pubkey)})}R.findOwnedNameAccountsForUser=Wd;function zd(t){return Be.PublicKey.findProgramAddressSync([Buffer.from(Te.MAIN_DOMAIN_PREFIX),t.toBuffer()],Te.TLD_HOUSE_PROGRAM_ID)}R.findMainDomain=zd;function $d(t){return Ke(this,void 0,void 0,function*(){let n=[{memcmp:{offset:0,bytes:[247,144,135,1,238,173,19,249],encoding:"binary"}}],r=yield t.getProgramAccounts(Te.TLD_HOUSE_PROGRAM_ID,{filters:n}),o=[];return r.map(({account:i})=>{let s=xc(i),a=kc(i);o.push({tld:a,parentAccount:s})}),o})}R.getAllTld=$d;function kc(t){var e;let r=(e=t?.data)===null||e===void 0?void 0:e.subarray(104),o=new Gd.BN(r?.subarray(0,4),"le").toNumber();return r.subarray(4,4+o).toString().replace(/\0.*$/g,"")}R.getTldFromTldHouseAccountInfo=kc;function xc(t){var e;let r=(e=t?.data)===null||e===void 0?void 0:e.subarray(72,104);return new Be.PublicKey(r)}R.getParentAccountFromTldHouseAccountInfo=xc;function Yd(t,e){return Ke(this,void 0,void 0,function*(){let n=[{memcmp:{offset:8,bytes:e.toBase58(),encoding:"base58"}}];return(yield t.getProgramAccounts(Te.ANS_PROGRAM_ID,{filters:n})).map(o=>o.pubkey)})}R.findAllDomainsForTld=Yd;function Ic(t,e){return Ke(this,void 0,void 0,function*(){try{let n=yield Hd.NftRecord.fromAccountAddress(t,e);if(n.tag!==Kd.Tag.ActiveRecord)return;let r=yield t.getTokenLargestAccounts(n.nftMintAccount),o=yield t.getParsedAccountInfo(r.value[0].address);return o.value.data?new Be.PublicKey(o.value.data.parsed.info.owner):void 0}catch{return}})}R.getMintOwner=Ic;function Dc(t,e){return Be.PublicKey.findProgramAddressSync([Buffer.from(Te.NFT_RECORD_PREFIX),e.toBuffer(),t.toBuffer()],Te.NAME_HOUSE_PROGRAM_ID)}R.findNftRecord=Dc;function Xd(t){return t=t.toLowerCase(),Be.PublicKey.findProgramAddressSync([Buffer.from(Te.TLD_HOUSE_PREFIX),Buffer.from(t)],Te.TLD_HOUSE_PROGRAM_ID)}R.findTldHouse=Xd;function Nc(t){return Be.PublicKey.findProgramAddressSync([Buffer.from(Te.NAME_HOUSE_PREFIX),t.toBuffer()],Te.NAME_HOUSE_PROGRAM_ID)}R.findNameHouse=Nc;var Jd=t=>Be.PublicKey.findProgramAddressSync([Buffer.from("metadata"),Te.TOKEN_METADATA_PROGRAM_ID.toBuffer(),t.toBuffer()],Te.TOKEN_METADATA_PROGRAM_ID)[0];R.findMetadataAddress=Jd;function Zd(t,e,n){return Ke(this,void 0,void 0,function*(){let r=e.map(s=>Ke(this,void 0,void 0,function*(){let a=yield Lo(s.toBase58()),[m]=Bo(a,n,void 0);return m})),o=yield Promise.all(r);return(yield t.getMultipleAccountsInfo(o)).map(s=>s?.data.subarray(Uo.NameRecordHeader.byteSize,s?.data.length).toString())})}R.performReverseLookupBatched=Zd;function ep(t){return new Promise(e=>setTimeout(e,t))}R.delay=ep;var tp=(t,e,n)=>Ke(void 0,void 0,void 0,function*(){let{value:r}=yield e.getParsedTokenAccountsByOwner(t,{programId:Te.SPL_TOKEN_PROGRAM_ID}),o=r.filter(s=>{var a,m,l,d,p,y,g,b,E,S;let N=(p=(d=(l=(m=(a=s.account)===null||a===void 0?void 0:a.data)===null||m===void 0?void 0:m.parsed)===null||l===void 0?void 0:l.info)===null||d===void 0?void 0:d.tokenAmount)===null||p===void 0?void 0:p.uiAmount;return((S=(E=(b=(g=(y=s.account)===null||y===void 0?void 0:y.data)===null||g===void 0?void 0:g.parsed)===null||b===void 0?void 0:b.info)===null||E===void 0?void 0:E.tokenAmount)===null||S===void 0?void 0:S.decimals)===0&&N===1}).map(s=>{var a,m,l,d;return(d=(l=(m=(a=s.account)===null||a===void 0?void 0:a.data)===null||m===void 0?void 0:m.parsed)===null||l===void 0?void 0:l.info)===null||d===void 0?void 0:d.mint});return yield np(o,e,n)});R.getParsedAllDomainsNftAccountsByOwner=tp;var np=(t,e,n)=>Ke(void 0,void 0,void 0,function*(){let r=[];if(t.length>100)for(;t.length>0;){let s=t.splice(0,100).map(m=>(0,R.findMetadataAddress)(new Be.PublicKey(m))),a=yield e.getMultipleAccountsInfo(s);for(let m of a)if(m){let l=new Be.PublicKey(m.data.subarray(326,358));if(!!m.data.subarray(326,327)&&l.toString()===n.toString()){let p=m.data.subarray(66,101).toString().replace(/\u0000/g,"");r.push(p)}}}else{let s=t.map(m=>(0,R.findMetadataAddress)(new Be.PublicKey(m))),a=yield e.getMultipleAccountsInfo(s);for(let m of a)if(m){let l=new Be.PublicKey(m.data.subarray(326,358));if(!!m.data.subarray(326,327)&&l.toString()===n.toString()){let p=m.data.subarray(66,101).toString().replace(/\u0000/g,"");r.push(p)}}}return r});function rp(t){let e=t.split("."),n="",r="",o="";return e.length===1?r=e[0]:(n="."+e[e.length-1],r=e[e.length-2],o=e.slice(0,e.length-2).join(".")),[n,r,o]}R.splitDomainTld=rp});var Go=Se(Z=>{"use strict";c();u();var op=Z&&Z.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),ip=Z&&Z.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Vo=Z&&Z.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&op(e,t,n);return ip(e,t),e},_c=Z&&Z.__awaiter||function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{l(r.next(d))}catch(p){s(p)}}function m(d){try{l(r.throw(d))}catch(p){s(p)}}function l(d){d.done?i(d.value):o(d.value).then(a,m)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(Z,"__esModule",{value:!0});Z.mainDomainBeet=Z.MainDomain=Z.mainDomainDiscriminator=void 0;var sp=Vo(Nt()),Oc=Vo(Ps()),yn=Vo(Zr());Z.mainDomainDiscriminator=[109,239,227,199,98,226,66,175];var Er=class t{constructor(e,n,r){this.nameAccount=e,this.tld=n,this.domain=r}static fromArgs(e){return new t(e.nameAccount,e.tld,e.domain)}static fromAccountInfo(e,n=0){return t.deserialize(e.data,n)}static fromAccountAddress(e,n,r){return _c(this,void 0,void 0,function*(){let o=yield e.getAccountInfo(n,r);if(o==null)throw new Error(`Unable to find MainDomain account at ${n}`);return t.fromAccountInfo(o,0)[0]})}static gpaBuilder(e=new sp.PublicKey("TLDHkysf5pCnKsVA4gXpNvmy7psXLPEu4LAdDJthT9S")){return Oc.GpaBuilder.fromStruct(e,Z.mainDomainBeet)}static deserialize(e,n=0){return Z.mainDomainBeet.deserialize(e,n)}serialize(){return Z.mainDomainBeet.serialize(Object.assign({accountDiscriminator:Z.mainDomainDiscriminator},this))}static byteSize(e){let n=t.fromArgs(e);return Z.mainDomainBeet.toFixedFromValue(Object.assign({accountDiscriminator:Z.mainDomainDiscriminator},n)).byteSize}static getMinimumBalanceForRentExemption(e,n,r){return _c(this,void 0,void 0,function*(){return yield n.getMinimumBalanceForRentExemption(t.byteSize(e),r)})}pretty(){return{nameAccount:this.nameAccount.toBase58(),tld:this.tld,domain:this.domain}}};Z.MainDomain=Er;Z.mainDomainBeet=new yn.FixableBeetStruct([["accountDiscriminator",yn.uniformFixedSizeArray(yn.u8,8)],["nameAccount",Oc.publicKey],["tld",yn.utf8String],["domain",yn.utf8String]],Er.fromArgs,"MainDomain")});var Ko=Se(Vt=>{"use strict";c();u();var Mc=Vt&&Vt.__awaiter||function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{l(r.next(d))}catch(p){s(p)}}function m(d){try{l(r.throw(d))}catch(p){s(p)}}function l(d){d.done?i(d.value):o(d.value).then(a,m)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.getDomainKey=void 0;var Qo=vr(),ap=(t,e=!1)=>Mc(void 0,void 0,void 0,function*(){let n=t.split(".");if(n.length===3){let a="."+n[2],m=n[1],l=n[0],{pubkey:d}=yield nt(a),{pubkey:p}=yield nt(m,d),g=Buffer.from([e?1:0]).toString().concat(l),b=yield nt(g,p);return Object.assign(Object.assign({},b),{isSub:!0,parent:p})}else if(n.length===4&&e){let a="."+n[3],m=n[2],l=n[1],d=n[0],{pubkey:p}=yield nt(a),{pubkey:y}=yield nt(m,p),{pubkey:g}=yield nt("\0".concat(l),y),b=Buffer.from([1]).toString(),E=yield nt(b.concat(d),g);return Object.assign(Object.assign({},E),{isSub:!0,parent:y,isSubRecord:!0})}else if(n.length>4)throw new Error("Invalid derivation input");let r="."+n[1],{pubkey:o}=yield nt(r),i=n[0],s=yield nt(i,o);return Object.assign(Object.assign({},s),{isSub:!1,parent:void 0})});Vt.getDomainKey=ap;var nt=(t,e)=>Mc(void 0,void 0,void 0,function*(){e||(e=yield(0,Qo.getOriginNameAccountKey)());let n=yield(0,Qo.getHashedName)(t),[r]=yield(0,Qo.getNameAccountKeyWithBump)(n,void 0,e);return{pubkey:r,hashed:n}})});var Rc=Se(Gt=>{"use strict";c();u();var Ne=Gt&&Gt.__awaiter||function(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{l(r.next(d))}catch(p){s(p)}}function m(d){try{l(r.throw(d))}catch(p){s(p)}}function l(d){d.done?i(d.value):o(d.value).then(a,m)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.TldParser=void 0;var ze=Nt(),cp=jr(),up=Go(),Ho=hr(),O=vr(),st=fr(),Fc=Ko(),qo=class{constructor(e){this.connection=e}getAllUserDomains(e){return Ne(this,void 0,void 0,function*(){return typeof e=="string"&&(e=new ze.PublicKey(e)),yield(0,O.findOwnedNameAccountsForUser)(this.connection,e,void 0)})}getAllUserDomainsFromTld(e,n){return Ne(this,void 0,void 0,function*(){let r="."+n,o=yield(0,O.getOriginNameAccountKey)(),i=yield(0,O.getHashedName)(r),[s]=(0,O.getNameAccountKeyWithBump)(i,void 0,o);return typeof e=="string"&&(e=new ze.PublicKey(e)),yield(0,O.findOwnedNameAccountsForUser)(this.connection,e,s)})}getOwnerFromDomainTld(e){return Ne(this,void 0,void 0,function*(){let n=e.split("."),r=n[0],o="."+n[1],i=yield(0,O.getOriginNameAccountKey)(),s=yield(0,O.getHashedName)(o),[a]=(0,O.getNameAccountKeyWithBump)(s,void 0,i),m=yield(0,O.getHashedName)(r),[l]=(0,O.getNameAccountKeyWithBump)(m,void 0,a),[d]=(0,O.findTldHouse)(o);return yield(0,O.getNameOwner)(this.connection,l,d)})}getNameRecordFromDomainTld(e){return Ne(this,void 0,void 0,function*(){let n=e.split("."),r=n[0],o="."+n[1],i=yield(0,O.getOriginNameAccountKey)(),s=yield(0,O.getHashedName)(o),[a]=(0,O.getNameAccountKeyWithBump)(s,void 0,i),m=yield(0,O.getHashedName)(r),[l]=(0,O.getNameAccountKeyWithBump)(m,void 0,a);return yield Ho.NameRecordHeader.fromAccountAddress(this.connection,l)})}getTldFromParentAccount(e){var n;return Ne(this,void 0,void 0,function*(){typeof e=="string"&&(e=new ze.PublicKey(e));let r=yield Ho.NameRecordHeader.fromAccountAddress(this.connection,e),o=yield this.connection.getAccountInfo(r?.owner),s=(n=o?.data)===null||n===void 0?void 0:n.subarray(104),a=new cp.BN(s?.subarray(0,4),"le").toNumber();return s.subarray(4,4+a).toString().replace(/\0.*$/g,"")})}reverseLookupNameAccount(e,n){var r;return Ne(this,void 0,void 0,function*(){typeof e=="string"&&(e=new ze.PublicKey(e)),typeof n=="string"&&(n=new ze.PublicKey(n));let o=yield(0,O.getHashedName)(e.toString()),[i]=(0,O.getNameAccountKeyWithBump)(o,n,void 0),s=yield Ho.NameRecordHeader.fromAccountAddress(this.connection,i);return(r=s?.data)===null||r===void 0?void 0:r.toString()})}getMainDomain(e){return Ne(this,void 0,void 0,function*(){typeof e=="string"&&(e=new ze.PublicKey(e));let[n]=(0,O.findMainDomain)(e);return yield up.MainDomain.fromAccountAddress(this.connection,n)})}getParsedAllUserDomainsFromTldUnwrapped(e,n){return Ne(this,void 0,void 0,function*(){let r="."+n,o=yield(0,O.getOriginNameAccountKey)(),i=yield(0,O.getHashedName)(r),[s]=(0,O.findTldHouse)(r),[a]=(0,O.getNameAccountKeyWithBump)(i,void 0,o);typeof e=="string"&&(e=new ze.PublicKey(e));let m=yield(0,O.findOwnedNameAccountsForUser)(this.connection,e,a),l=[];for(let d=0;d<m.length;d+=st.MULTIPLE_ACCOUNT_INFO_MAX){yield(0,O.delay)(100);let p=Math.min(d+st.MULTIPLE_ACCOUNT_INFO_MAX,m.length),y=m.slice(d,p),b=(yield(0,O.performReverseLookupBatched)(this.connection,y,s)).map((E,S)=>({nameAccount:y[S],domain:E+r}));b.length>0&&b.sort((E,S)=>E.domain.localeCompare(S.domain,void 0,{numeric:!0,sensitivity:"base"})),l.push(...b)}return l})}getParsedAllUserDomainsFromTld(e,n){return Ne(this,void 0,void 0,function*(){let r="."+n,o=yield(0,O.getOriginNameAccountKey)(),i=yield(0,O.getHashedName)(r),[s]=(0,O.findTldHouse)(r),[a]=(0,O.getNameAccountKeyWithBump)(i,void 0,o);typeof e=="string"&&(e=new ze.PublicKey(e));let m=yield(0,O.findOwnedNameAccountsForUser)(this.connection,e,a),l=[],p=(yield(0,O.getParsedAllDomainsNftAccountsByOwner)(e,this.connection,(0,O.findNameHouse)(s)[0])).map(g=>g+r),y=yield Promise.all(p.map(g=>Ne(this,void 0,void 0,function*(){return{nameAccount:(yield(0,Fc.getDomainKey)(g)).pubkey,domain:g}})));l.push(...y);for(let g=0;g<m.length;g+=st.MULTIPLE_ACCOUNT_INFO_MAX){yield(0,O.delay)(100);let b=Math.min(g+st.MULTIPLE_ACCOUNT_INFO_MAX,m.length),E=m.slice(g,b),N=(yield(0,O.performReverseLookupBatched)(this.connection,E,s)).map((G,j)=>({nameAccount:E[j],domain:G+r}));l.push(...N)}return l.length>0&&l.sort((g,b)=>g.domain.localeCompare(b.domain,void 0,{numeric:!0,sensitivity:"base"})),l})}getParsedAllUserDomainsUnwrapped(e){return Ne(this,void 0,void 0,function*(){let n=yield(0,O.getAllTld)(this.connection),r=[];typeof e=="string"&&(e=new ze.PublicKey(e));for(let{parentAccount:o,tld:i}of n){let s=i.toString(),[a]=(0,O.findTldHouse)(s),m=yield(0,O.findOwnedNameAccountsForUser)(this.connection,e,o);for(let l=0;l<m.length;l+=st.MULTIPLE_ACCOUNT_INFO_MAX){yield(0,O.delay)(100);let d=Math.min(l+st.MULTIPLE_ACCOUNT_INFO_MAX,m.length),p=m.slice(l,d),g=(yield(0,O.performReverseLookupBatched)(this.connection,p,a)).map((b,E)=>({nameAccount:p[E],domain:b+s}));r.push(...g)}}return r.length>0&&r.sort((o,i)=>o.domain.localeCompare(i.domain,void 0,{numeric:!0,sensitivity:"base"})),r})}getParsedAllUserDomains(e){return Ne(this,void 0,void 0,function*(){let n=yield(0,O.getAllTld)(this.connection),r=[];typeof e=="string"&&(e=new ze.PublicKey(e));for(let{parentAccount:o,tld:i}of n){let s=i.toString(),[a]=(0,O.findTldHouse)(s),m=yield(0,O.findOwnedNameAccountsForUser)(this.connection,e,o),d=(yield(0,O.getParsedAllDomainsNftAccountsByOwner)(e,this.connection,(0,O.findNameHouse)(a)[0])).map(y=>y+s),p=yield Promise.all(d.map(y=>Ne(this,void 0,void 0,function*(){return{nameAccount:(yield(0,Fc.getDomainKey)(y)).pubkey,domain:y}})));r.push(...p);for(let y=0;y<m.length;y+=st.MULTIPLE_ACCOUNT_INFO_MAX){yield(0,O.delay)(100);let g=Math.min(y+st.MULTIPLE_ACCOUNT_INFO_MAX,m.length),b=m.slice(y,g),S=(yield(0,O.performReverseLookupBatched)(this.connection,b,a)).map((N,G)=>({nameAccount:b[G],domain:N+s}));r.push(...S)}}return r.length>0&&r.sort((o,i)=>o.domain.localeCompare(i.domain,void 0,{numeric:!0,sensitivity:"base"})),r})}};Gt.TldParser=qo});var Uc=Se(hn=>{"use strict";c();u();Object.defineProperty(hn,"__esModule",{value:!0});hn.Record=void 0;var lp;(function(t){t.IPFS="IPFS",t.ARWV="ARWV",t.SOL="SOL",t.ETH="ETH",t.BTC="BTC",t.LTC="LTC",t.DOGE="DOGE",t.Email="email",t.Url="url",t.Discord="discord",t.Github="github",t.Reddit="reddit",t.Twitter="twitter",t.Telegram="telegram",t.Pic="pic",t.SHDW="SHDW",t.POINT="POINT"})(lp=hn.Record||(hn.Record={}))});var Bc=Se(ke=>{"use strict";c();u();var mp=ke&&ke.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),at=ke&&ke.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&mp(e,t,n)};Object.defineProperty(ke,"__esModule",{value:!0});at(vr(),ke);at(fr(),ke);at(Rc(),ke);at(hr(),ke);at(Go(),ke);at(Ro(),ke);at(Ko(),ke);at(Uc(),ke)});var Hc=Se(zo=>{"use strict";c();u();Object.defineProperty(zo,"__esModule",{value:!0});var ct=B();function yp(t,e){e===void 0&&(e=0);var n=ct.useRef(!1),r=ct.useRef(),o=ct.useRef(t),i=ct.useCallback(function(){return n.current},[]),s=ct.useCallback(function(){n.current=!1,r.current&&clearTimeout(r.current),r.current=setTimeout(function(){n.current=!0,o.current()},e)},[e]),a=ct.useCallback(function(){n.current=null,r.current&&clearTimeout(r.current)},[]);return ct.useEffect(function(){o.current=t},[t]),ct.useEffect(function(){return s(),a},[e]),[i,a,s]}zo.default=yp});var qc=Se($o=>{"use strict";c();u();Object.defineProperty($o,"__esModule",{value:!0});var hp=(Xl(),Fl(Yl)),gp=B(),bp=hp.__importDefault(Hc());function Tp(t,e,n){e===void 0&&(e=0),n===void 0&&(n=[]);var r=bp.default(t,e),o=r[0],i=r[1],s=r[2];return gp.useEffect(s,n),[o,i]}$o.default=Tp});c();u();var Jl=0;function C(t,e){let n=`atom${++Jl}`,r={toString(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof t=="function"?r.read=t:(r.init=t,r.read=Zl,r.write=em),e&&(r.write=e),r}function Zl(t){return t(this)}function em(t,e,n){return e(this,typeof n=="function"?n(t(this)):n)}var ya=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,io=t=>"init"in t,oo=t=>!!t.write,or=new WeakMap,so=t=>{var e;return ao(t)&&!((e=or.get(t))!=null&&e[1])},tm=(t,e)=>{let n=or.get(t);if(n)n[1]=!0,n[0].forEach(r=>r(e));else if((import.meta.env?import.meta.env.MODE:void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},nm=t=>{if(or.has(t))return;let e=[new Set,!1];or.set(t,e);let n=()=>{e[1]=!0};t.then(n,n),t.onCancel=r=>{e[0].add(r)}},ao=t=>typeof t?.then=="function",ha=t=>"v"in t||"e"in t,rr=t=>{if("e"in t)throw t.e;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},ga=(t,e,n)=>{n.p.has(t)||(n.p.add(t),e.then(()=>{n.p.delete(t)},()=>{n.p.delete(t)}))},rm=(t,e,n,r)=>{var o;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&n===t)throw new Error("[Bug] atom cannot depend on itself");e.d.set(n,r.n),so(e.v)&&ga(t,e.v,r),(o=r.m)==null||o.t.add(t)},om=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),ba=(...t)=>{let[e,n,r,o,i,s]=t,a=w=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!w)throw new Error("Atom is undefined or null");let T=e(w);return T||(T={d:new Map,p:new Set,n:0},n(w,T),i?.(w,Ae)),T},m=new WeakMap,l=new Map,d=new Set,p=new Set,y=()=>{var w;let T=[],x=P=>{try{P()}catch(k){T.push(k)}};do{(w=Ae[om])==null||w.call(Ae);let P=new Set,k=P.add.bind(P);l.forEach(D=>{var U;return(U=D.m)==null?void 0:U.l.forEach(k)}),l.clear(),d.forEach(k),d.clear(),p.forEach(k),p.clear(),P.forEach(x),l.size&&G()}while(l.size||d.size||p.size);if(T.length)throw T[0]},g=(w,T,x)=>{let P="v"in T,k=T.v,D=so(T.v)?T.v:null;if(ao(x)){nm(x);for(let U of T.d.keys())ga(w,x,a(U));T.v=x}else T.v=x;delete T.e,(!P||!Object.is(k,T.v))&&(++T.n,D&&tm(D,x))},b=w=>{var T;let x=a(w);if(ha(x)&&(x.m&&m.get(w)!==x.n||Array.from(x.d).every(([Q,z])=>b(Q).n===z)))return x;x.d.clear();let P=!0,k=()=>{x.m&&(ie(w,x),G(),y())},D=Q=>{if(ya(w,Q)){let ye=a(Q);if(!ha(ye))if(io(Q))g(Q,ye,Q.init);else throw new Error("no atom init");return rr(ye)}let z=b(Q);try{return rr(z)}finally{rm(w,x,Q,z),P||k()}},U,K,re={get signal(){return U||(U=new AbortController),U.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!oo(w)&&console.warn("setSelf function cannot be used with read-only atom"),!K&&oo(w)&&(K=(...Q)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&P&&console.warn("setSelf function cannot be called in sync"),!P)return me(w,...Q)}),K}};try{let Q=r(w,D,re);return g(w,x,Q),ao(Q)&&((T=Q.onCancel)==null||T.call(Q,()=>U?.abort()),Q.then(k,k)),x}catch(Q){return delete x.v,x.e=Q,++x.n,x}finally{P=!1}},E=w=>rr(b(w)),S=w=>{var T;let x=new Map;for(let P of((T=w.m)==null?void 0:T.t)||[]){let k=a(P);k.m&&x.set(P,k)}for(let P of w.p)x.set(P,a(P));return x},N=w=>{let T=[w];for(;T.length;){let x=T.pop();for(let[P,k]of S(x))m.has(P)||(m.set(P,k.n),T.push(k))}},G=()=>{var w;let T=[],x=new WeakSet,P=new WeakSet,k=Array.from(l);for(;k.length;){let[D,U]=k[k.length-1];if(P.has(D)){k.pop();continue}if(x.has(D)){m.get(D)===U.n?T.push([D,U,U.n]):(m.delete(D),l.set(D,U)),P.add(D),k.pop();continue}x.add(D);for(let[K,re]of S(U))x.has(K)||k.push([K,re])}for(let D=T.length-1;D>=0;--D){let[U,K,re]=T[D],Q=!1;for(let z of K.d.keys())if(z!==U&&l.has(z)){Q=!0;break}Q&&(b(U),ie(U,K),re!==K.n&&(l.set(U,K),(w=K.u)==null||w.call(K))),m.delete(U)}},j=(w,...T)=>{let x=!0,P=D=>rr(b(D)),k=(D,...U)=>{var K;let re=a(D);try{if(ya(w,D)){if(!io(D))throw new Error("atom not writable");let Q=re.n,z=U[0];g(D,re,z),ie(D,re),Q!==re.n&&(l.set(D,re),(K=re.u)==null||K.call(re),N(re));return}else return j(D,...U)}finally{x||(G(),y())}};try{return o(w,P,k,...T)}finally{x=!1}},me=(w,...T)=>{try{return j(w,...T)}finally{G(),y()}},ie=(w,T)=>{var x;if(T.m&&!so(T.v)){for(let[P,k]of T.d)if(!T.m.d.has(P)){let D=a(P);se(P,D).t.add(w),T.m.d.add(P),k!==D.n&&(l.set(P,D),(x=D.u)==null||x.call(D),N(D))}for(let P of T.m.d||[])if(!T.d.has(P)){T.m.d.delete(P);let k=ee(P,a(P));k?.t.delete(w)}}},se=(w,T)=>{var x;if(!T.m){b(w);for(let P of T.d.keys())se(P,a(P)).t.add(w);if(T.m={l:new Set,d:new Set(T.d.keys()),t:new Set},(x=T.h)==null||x.call(T),oo(w)){let P=T.m,k=()=>{let D=!0,U=(...K)=>{try{return j(w,...K)}finally{D||(G(),y())}};try{let K=s(w,U);K&&(P.u=()=>{D=!0;try{K()}finally{D=!1}})}finally{D=!1}};p.add(k)}}return T.m},ee=(w,T)=>{var x;if(T.m&&!T.m.l.size&&!Array.from(T.m.t).some(P=>{var k;return(k=a(P).m)==null?void 0:k.d.has(w)})){let P=T.m.u;P&&d.add(P),delete T.m,(x=T.h)==null||x.call(T);for(let k of T.d.keys()){let D=ee(k,a(k));D?.t.delete(w)}return}return T.m},Ae={get:E,set:me,sub:(w,T)=>{let x=a(w),k=se(w,x).l;return k.add(T),y(),()=>{k.delete(T),ee(w,x),y()}},unstable_derive:w=>ba(...w(...t))};return Ae},im=t=>{let e=new Set,n,r=0,o=t.unstable_derive((...a)=>{let[m,l,,d]=a;return n=m,a[1]=function(y,g){l(y,g);let b=g.h;g.h=()=>{b?.(),g.m?e.add(y):e.delete(y)}},a[3]=function(y,g,b,...E){return r?b(y,...E):d(y,g,b,...E)},a}),i=o.set;return Object.assign(o,{dev4_get_internal_weak_map:()=>({get:a=>{let m=n(a);if(!(!m||m.n===0))return m}}),dev4_get_mounted_atoms:()=>e,dev4_restore_atoms:a=>{i({read:()=>null,write:(l,d)=>{++r;try{for(let[p,y]of a)io(p)&&d(p,y)}finally{--r}}})}})},co=()=>{let t=new WeakMap,e=ba(n=>t.get(n),(n,r)=>t.set(n,r).get(n),(n,...r)=>n.read(...r),(n,...r)=>n.write(...r),(n,...r)=>{var o;return(o=n.unstable_onInit)==null?void 0:o.call(n,...r)},(n,...r)=>{var o;return(o=n.onMount)==null?void 0:o.call(n,...r)});return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?im(e):e},nn,Ta=()=>(nn||(nn=co(),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=nn),globalThis.__JOTAI_DEFAULT_STORE__!==nn&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),nn);c();u();var ue=M(B(),1);var Ea=(0,ue.createContext)(void 0),wa=t=>{let e=(0,ue.useContext)(Ea);return t?.store||e||Ta()},Yh=({children:t,store:e})=>{let n=(0,ue.useRef)(void 0);return!e&&!n.current&&(n.current=co()),(0,ue.createElement)(Ea.Provider,{value:e||n.current},t)},lo=t=>typeof t?.then=="function",Aa=t=>{t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e})},sm=ue.default.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(Aa(t),t)}),uo=new WeakMap,va=t=>{let e=uo.get(t);return e||(e=new Promise((n,r)=>{let o=t,i=m=>l=>{o===m&&n(l)},s=m=>l=>{o===m&&r(l)},a=m=>{"onCancel"in m&&typeof m.onCancel=="function"&&m.onCancel(l=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&l===m)throw new Error("[Bug] p is not updated even after cancelation");lo(l)?(uo.set(l,e),o=l,l.then(i(l),s(l)),a(l)):n(l)})};t.then(i(t),s(t)),a(t)}),uo.set(t,e)),e};function he(t,e){let n=wa(e),[[r,o,i],s]=(0,ue.useReducer)(l=>{let d=n.get(t);return Object.is(l[0],d)&&l[1]===n&&l[2]===t?l:[d,n,t]},void 0,()=>[n.get(t),n,t]),a=r;(o!==n||i!==t)&&(s(),a=n.get(t));let m=e?.delay;if((0,ue.useEffect)(()=>{let l=n.sub(t,()=>{if(typeof m=="number"){let d=n.get(t);lo(d)&&Aa(va(d)),setTimeout(s,m);return}s()});return s(),l},[n,t,m]),(0,ue.useDebugValue)(a),lo(a)){let l=va(a);return sm(l)}return a}function rn(t,e){let n=wa(e);return(0,ue.useCallback)((...o)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return n.set(t,...o)},[n,t])}function Xh(t,e){return[he(t,e),rn(t,e)]}c();u();var am=h.object({data:h.string(),from:h.string(),to:h.string()}),cm=h.object({transaction:am});async function um({caip19:t,amount:e,owner:n}){let r=await $.api().post("/tokens/v1/unwrap",{owner:n,caip19:t,amount:e.toNumber()}),o=cm.safeParse(r.data);if(!o.success){let{error:i}=o;throw _.captureError(i,"fungibles"),new en(`Failed to get unwrap transaction: ${i.message}`)}return o.data.transaction}var lm=({caip19:t,amount:e,owner:n})=>I({gcTime:Rt.Medium,staleTime:1/0,enabled:n!==""&&e.isGreaterThan(0),queryKey:ce.unwrapTransaction({caip19:t,amount:e,owner:n}),async queryFn(){return await um({caip19:t,amount:e,owner:n})}});c();u();c();u();var mm="25.13.0",on=`fungible-tokens-${mm}`,Pa=[on,"token-updates"];var Ca=[on,"portfolio-value"],dm=[on,"token-balance"],pm=[on,"infinite-token-balances"],fm=[on,"visibility-overrides"],be={infiniteTokenBalances:({walletCaip19s:t})=>[...pm,{walletCaip19s:t}],tokenBalance:({wallets:t,encodedCaip19:e,isSplCompressed:n})=>{let r=t.map(o=>typeof o=="string"?o:J({chainId:o.networkID,address:o.address,resourceType:"address"})).sort();return[...dm,{walletCaip19s:r,encodedCaip19:e,isSplCompressed:n}]},tokenUpdates:({walletCaip19s:t,from:e})=>[...Pa,{walletCaip19s:t,from:e}],portfolioValue:({walletCaip19s:t,include:e,exclude:n,isMainnet:r})=>[...Ca,{walletCaip19s:t,include:e,exclude:n,isMainnet:r}],visibilityOverrides:({accountId:t})=>[...fm,{accountId:t}],tokenDetails:Zn.tokenDetails};function ym(){let t=Rn(),e=Re(),n=W();return Ie({async mutationFn({accountId:r,mutations:o}){await aa(t,e,{accountId:r,mutations:o})},async onSuccess(r,o){await Promise.all([n.invalidateQueries({queryKey:ce.hiddenMints(o.accountId)}),n.invalidateQueries({queryKey:be.visibilityOverrides({accountId:o.accountId})})])}})}c();u();var ur=M(B());c();u();var hm=new Xi({solana:{},ethereum:{},polygon:{},base:{},arbitrum:{},monad:{pricesDisabled:!0},bitcoin:{},sui:{},hypercore:{}}),Ge=Yi(hm);c();u();c();u();c();u();var gm=["UNSENT","OPENED","HEADERS_RECEIVED","LOADING","DONE"],mo=class{ERROR=-1;CONNECTING=0;OPEN=1;CLOSED=2;CRLF=`\r
`;LF=`
`;CR="\r";lastEventId=null;status=this.CONNECTING;eventHandlers={open:[],message:[],error:[],close:[]};method;timeout;timeoutBeforeConnection;withCredentials;headers;body;debug;interval;lineEndingCharacter;_xhr=null;_pollTimer=null;_lastIndexProcessed=0;url;constructor(e,n={}){if(!e||typeof e!="string"&&typeof e.toString!="function")throw new SyntaxError("[EventSource] Invalid URL argument.");this.url=typeof e.toString=="function"?e.toString():e,this.method=n.method||"GET",this.timeout=n.timeout??0,this.timeoutBeforeConnection=n.timeoutBeforeConnection??500,this.withCredentials=n.withCredentials||!1,this.headers=n.headers||{},this.body=n.body||void 0,this.debug=n.debug||!1,this.interval=n.pollingInterval??5e3,this.lineEndingCharacter=n.lineEndingCharacter||null,this._pollAgain(this.timeoutBeforeConnection,!0)}_pollAgain(e,n){(e>0||n)&&(this._logDebug(`[EventSource] Will open new connection in ${e} ms.`),this._pollTimer=setTimeout(()=>{this.open()},e))}open(){try{this.status=this.CONNECTING,this._lastIndexProcessed=0,this._xhr=new XMLHttpRequest,this._xhr.open(this.method,this.url,!0),this.withCredentials&&(this._xhr.withCredentials=!0),this._xhr.setRequestHeader("Accept","text/event-stream"),this._xhr.setRequestHeader("Cache-Control","no-cache"),this._xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");for(let[e,n]of Object.entries(this.headers))this._xhr.setRequestHeader(e,n);this.lastEventId!==null&&this._xhr.setRequestHeader("Last-Event-ID",this.lastEventId),this._xhr.timeout=this.timeout,this._xhr.onreadystatechange=()=>{if(this.status===this.CLOSED)return;let e=this._xhr;this._logDebug(`[EventSource][onreadystatechange] ReadyState: ${gm[e.readyState]||"Unknown"}(${e.readyState}), status: ${e.status}`),[XMLHttpRequest.DONE,XMLHttpRequest.LOADING].includes(e.readyState)&&(e.status>=200&&e.status<400?(this.status===this.CONNECTING&&(this.status=this.OPEN,this.dispatch("open",{type:"open"}),this._logDebug("[EventSource][onreadystatechange][OPEN] Connection opened.")),this._handleEvent(e.responseText||""),e.readyState===XMLHttpRequest.DONE&&(this._logDebug("[EventSource][onreadystatechange][DONE] Operation done."),this._pollAgain(this.interval,!1))):e.status!==0&&(this.status=this.ERROR,this.dispatch("error",{type:"error",message:e.responseText,xhrStatus:e.status,xhrState:e.readyState}),e.readyState===XMLHttpRequest.DONE&&(this._logDebug("[EventSource][onreadystatechange][ERROR] Response status error."),this._pollAgain(this.interval,!1))))},this._xhr.onerror=()=>{this.status!==this.CLOSED&&(this.status=this.ERROR,this.dispatch("error",{type:"error",message:this._xhr.responseText,xhrStatus:this._xhr.status,xhrState:this._xhr.readyState}))},this.body?this._xhr.send(this.body):this._xhr.send(),this.timeout>0&&setTimeout(()=>{this._xhr.readyState===XMLHttpRequest.LOADING&&(this.dispatch("error",{type:"timeout"}),this.close())},this.timeout)}catch(e){this.status=this.ERROR,this.dispatch("error",{type:"exception",message:e.message,error:e})}}_logDebug(...e){this.debug&&console.debug(...e)}_handleEvent(e){if(this.lineEndingCharacter===null){let l=this._detectNewlineChar(e);if(l!==null)this._logDebug(`[EventSource] Automatically detected lineEndingCharacter: ${JSON.stringify(l).slice(1,-1)}`),this.lineEndingCharacter=l;else{console.warn("[EventSource] Unable to identify the line ending character. Ensure your server delivers a standard line ending character: \\r\\n, \\n, \\r, or specify your custom character using the 'lineEndingCharacter' option.");return}}let n=this._getLastDoubleNewlineIndex(e);if(n<=this._lastIndexProcessed)return;let r=e.substring(this._lastIndexProcessed,n).split(this.lineEndingCharacter);this._lastIndexProcessed=n;let o,i=null,s=[],a=0,m="";for(let l=0;l<r.length;l++)if(m=r[l].trim(),m.startsWith("event"))o=m.replace(/event:?\s*/,"");else if(m.startsWith("retry"))a=parseInt(m.replace(/retry:?\s*/,""),10),isNaN(a)||(this.interval=a);else if(m.startsWith("data"))s.push(m.replace(/data:?\s*/,""));else if(m.startsWith("id"))i=m.replace(/id:?\s*/,""),i!==""?this.lastEventId=i:this.lastEventId=null;else if(m===""&&s.length>0){let d=o||"message",p={type:d,data:s.join(`
`),url:this.url,lastEventId:this.lastEventId};this.dispatch(d,p),s=[],o=void 0}}_detectNewlineChar(e){let n=[this.CRLF,this.LF,this.CR];for(let r of n)if(e.includes(r))return r;return null}_getLastDoubleNewlineIndex(e){let n=this.lineEndingCharacter+this.lineEndingCharacter,r=e.lastIndexOf(n);return r===-1?-1:r+n.length}addEventListener(e,n){this.eventHandlers[e]===void 0&&(this.eventHandlers[e]=[]),this.eventHandlers[e].push(n)}removeEventListener(e,n){this.eventHandlers[e]!==void 0&&(this.eventHandlers[e]=this.eventHandlers[e].filter(r=>r!==n))}removeAllEventListeners(e){let n=Object.keys(this.eventHandlers);if(e===void 0)for(let r of n)this.eventHandlers[r]=[];else{if(!n.includes(e))throw Error(`[EventSource] '${e}' type is not supported event type.`);this.eventHandlers[e]=[]}}dispatch(e,n){if(Object.keys(this.eventHandlers).includes(e))for(let o of Object.values(this.eventHandlers[e]))o(n)}close(){this.status!==this.CLOSED&&(this.status=this.CLOSED,this.dispatch("close",{type:"close"})),clearTimeout(this._pollTimer),this._xhr&&this._xhr.abort()}},po=mo;c();u();var fo=class{getDefaultHeaders(){let e={"X-Phantom-Version":In,"X-Phantom-Platform":Dn},n=Nn();return n&&(e["X-Phantom-AnonymousId"]=n),e}getOptions(e={}){return{...e,headers:Object.fromEntries($t(this.getDefaultHeaders(),e.headers).entries())}}getOptionsWithAuth(e,n={}){let r=this.getOptions(n);if(r.withClientAuth!==!1){let o=_n(e,r.headers);return{...r,headers:Object.fromEntries($t(r.headers,o).entries())}}return r}getApiEnvironment(){return xn()}safeJsonParse(e){try{return e?{success:!0,data:JSON.parse(e)}:{success:!1,error:new Error("No data provided")}}catch(n){return{success:!1,error:n instanceof Error?n:new Error("Failed to parse JSON")}}}createErrorEvent(e,n="error"){return{type:n,error:typeof e=="string"?new Error(e):e}}};c();u();function yo({url:t,signal:e,customEvent:n}){return{[Symbol.asyncIterator](){let r=[],o=null,i=!1,s={"X-Phantom-Version":In,"X-Phantom-Platform":Dn},a=Nn();a&&(s["X-Phantom-AnonymousId"]=a);let m=_n(t,s),l={headers:Object.fromEntries($t(s,m).entries()),lineEndingCharacter:`
`},d=new po(t,l),p=S=>{try{r.push(JSON.parse(S.data??""))}catch{r.push(S.data??"")}if(o){let N=o;o=null,N({value:r.shift(),done:!1})}},y=()=>{i||(i=!0,b(),g())},g=()=>{if(o){let S=o;o=null,S({value:void 0,done:!0})}},b=()=>{n&&d.removeEventListener(n,p),d.removeEventListener("message",p),d.removeEventListener("error",y),d.close()};n&&d.addEventListener(n,p),d.addEventListener("message",p),d.addEventListener("error",y);let E=()=>{i||(i=!0,b(),g())};return e?.addEventListener("abort",E,{once:!0}),{next(){return i?Promise.resolve({value:void 0,done:!0}):r.length?Promise.resolve({value:r.shift(),done:!1}):new Promise(S=>{o=S})},return(){return i||(i=!0,e?.removeEventListener("abort",E),b()),Promise.resolve({value:void 0,done:!0})},throw(S){return i||(i=!0,e?.removeEventListener("abort",E),b()),Promise.reject(S)}}}}}c();u();function ka(t){return{usd:t.price??void 0,usd_24h_change:t.priceChange24h??void 0,price:t.price??void 0,priceChange24h:t.priceChange24h??void 0,lastUpdatedAt:t.lastUpdatedAt}}var bm=v({minutes:5}),Tm=100,xa=5,vm=v({seconds:1}),Em=v({seconds:30}),ho=class{subscriptions=new Map;activeConnection=null;currentTokenIds=new Set;subscriptionOrder=[];connectionState="disconnected";reconnectAttempts=0;reconnectTimeoutId=null;subscribe(e,n,r){!this.subscriptions.has(e)&&this.subscriptions.size>=Tm&&this.evictOldestToken();let o={priceCallback:n,evictedCallback:r?.onEvicted};return this.subscriptions.has(e)?(this.removeFromSubscriptionOrder(e),this.subscriptionOrder.push(e)):(this.subscriptions.set(e,new Set),this.subscriptionOrder.push(e)),this.subscriptions.get(e).add(o),this.updateConnection(),()=>{let i=this.subscriptions.get(e);if(i){for(let s of i)if(s.priceCallback===n){i.delete(s);break}i.size===0&&(this.subscriptions.delete(e),this.removeFromSubscriptionOrder(e),this.updateConnection())}}}updateConnection(){let e=new Set(this.subscriptions.keys());if(e.size===0){this.disconnect();return}this.setsEqual(this.currentTokenIds,e)&&this.activeConnection&&this.connectionState==="connected"||this.connectionState==="reconnecting"&&this.setsEqual(this.currentTokenIds,e)||(this.disconnect(),this.connect(e))}connect(e){let n=new AbortController;this.activeConnection=n,this.currentTokenIds=new Set(e),this.connectionState="connecting";let r=Array.from(e).map(i=>encodeURIComponent(i)).join(","),o=`${xn()}/price-stream?tokenIds=${r}`;this.consumeStream(o,n.signal)}async consumeStream(e,n){try{let r=yo({url:e,signal:n,customEvent:"price-update"});this.connectionState="connected",this.reconnectAttempts=0;for await(let o of r){if(n.aborted)break;this.handlePriceUpdate(o)}}catch{n.aborted||(this.connectionState="disconnected",this.scheduleReconnect())}}handlePriceUpdate(e){let n=e.caip19,r=this.subscriptions.get(n);if(!r)return;if(!e.price){let i=new Date(e.lastUpdatedAt).getTime();if(Date.now()-i<bm)return}let o=ka(e);r.forEach(i=>{try{i.priceCallback(n,o)}catch{}})}disconnect(){this.cancelReconnection(),this.activeConnection&&(this.activeConnection.abort(),this.activeConnection=null),this.currentTokenIds.clear(),this.connectionState!=="disconnected"&&(this.connectionState="disconnected")}setsEqual(e,n){if(e.size!==n.size)return!1;for(let r of e)if(!n.has(r))return!1;return!0}evictOldestToken(){if(this.subscriptionOrder.length===0)return;let e=this.subscriptionOrder[0],n=this.subscriptions.get(e);n&&(n.forEach(r=>{if(r.evictedCallback)try{r.evictedCallback(e)}catch{}}),n.clear()),this.subscriptions.delete(e),this.removeFromSubscriptionOrder(e),this.updateConnection()}removeFromSubscriptionOrder(e){let n=this.subscriptionOrder.indexOf(e);n>-1&&this.subscriptionOrder.splice(n,1)}scheduleReconnect(){if(this.reconnectAttempts>=xa){this.connectionState="disconnected";return}if(this.subscriptions.size===0)return;this.connectionState="reconnecting",this.reconnectAttempts++;let e=Math.min(vm*Math.pow(2,this.reconnectAttempts-1),Em);this.reconnectTimeoutId=setTimeout(()=>{if(this.reconnectTimeoutId=null,this.subscriptions.size===0){this.connectionState="disconnected";return}this.connect(new Set(this.subscriptions.keys()))},e)}cancelReconnection(){this.reconnectTimeoutId&&(clearTimeout(this.reconnectTimeoutId),this.reconnectTimeoutId=null)}getConnectionState(){return this.connectionState}getStats(){return{connectionState:this.connectionState,activeSubscriptions:this.subscriptions.size,reconnectAttempts:this.reconnectAttempts,maxReconnectAttempts:xa,currentTokenIds:Array.from(this.currentTokenIds)}}forceReconnect(){this.subscriptions.size!==0&&(this.reconnectAttempts=0,this.disconnect(),this.connect(new Set(this.subscriptions.keys())))}destroy(){this.cancelReconnection(),this.disconnect(),this.subscriptions.clear(),this.subscriptionOrder.length=0,this.connectionState="disconnected",this.reconnectAttempts=0}},go=new ho;c();u();c();u();c();u();var ir=(s=>(s[s.Always=1/0]="Always",s[s.Short=v({days:1})]="Short",s[s.Medium=v({days:3})]="Medium",s[s.Long=v({days:7})]="Long",s[s.VeryLong=v({days:30})]="VeryLong",s[s.Never=0]="Never",s))(ir||{}),de=(a=>(a[a.Immediate=0]="Immediate",a[a.VeryShort=v({seconds:1})]="VeryShort",a[a.Short=v({seconds:15})]="Short",a[a.Medium=v({minutes:3})]="Medium",a[a.Long=v({minutes:5})]="Long",a[a.VeryLong=v({minutes:10})]="VeryLong",a[a.Never=1/0]="Never",a))(de||{}),Qe=(o=>(o[o.VeryShort=v({seconds:2})]="VeryShort",o[o.Short=v({seconds:15})]="Short",o[o.Medium=v({minutes:3})]="Medium",o[o.Long=v({minutes:5})]="Long",o))(Qe||{});var Ia=v({seconds:10}),Da={gcTime:ir.Short,staleTime:de.Short};c();u();var wm="prices",sr=(t,e)=>{if(!On(t))return;let r=t.response?.status;if(!r||r===0||r>=500||r===404){_.addBreadcrumb(wm,t.message,"info",e);return}r>=400&&r<500&&_.captureError(t,"prices")};var _a=h.object({price:h.number(),priceChange24h:h.number(),lastUpdatedAt:h.string().datetime().optional()}),Na=h.object({prices:h.record(ji,_a)});async function Et({tokens:t}){try{let e=t.filter(s=>!Ge.get(s.chainId)?.pricesDisabled),n={tokens:e.map(s=>({token:s}))},r="/price/v1",o,i=$.timeout(Ia).retry(1,200).validateStatus(!0).api();if(e.length===0)return{};if(e.length===1){let s=e[0];r+=`/${s.chainId}`,s.resourceType==="nativeToken"?r+=`/nativeToken/${s.slip44}`:r+=`/address/${s.address}`;let a=await i.get(r);o=Na.parse({prices:{[J(s)]:a.data}})}else{let s=await i.post(r,n);o=Na.parse(s.data)}return Am(o.prices)}catch(e){throw sr(e),e}}function Am(t){let e={};for(let n of Object.keys(t)){let{price:r,priceChange24h:o,lastUpdatedAt:i}=t[n],s={price:r,usd:r,usd_24h_change:o,lastUpdatedAt:i};e[n]=s}return e}c();u();function ar(t){return{caip19:bo(t)}}function bo(t){return typeof t=="string"?Le(t):t}c();u();var cr="prices",le={price:t=>[cr,{id:t}],priceError:()=>[cr,"error"],priceHistory:(t,e)=>[cr,t,e],priceHistoryInterval:(t,e,n,r)=>[cr,t,e,n,...r?[r]:[]],tempPrices:t=>["tempPrices",t]};var Oa=new Error("Price not available"),Ma=t=>{let e=t?t.data:void 0;return e?Pm(e):void 0},To=({query:t,enabled:e=!0,queryOptions:n={refetchInterval:Qe.Short,staleTime:de.Short,gcTime:de.Short}})=>{let r=Ma(t),o=n.refetchInterval,i=n.staleTime,s=n.gcTime,a=t?t.data:void 0,m=a?ar(a).caip19.chainId:void 0,l=m?!Ge.get(m).pricesDisabled:!1;return{enabled:e&&!!r&&l,queryKey:le.price(r),refetchInterval(p){return p.state.error===Oa?!1:o},staleTime:i,gcTime:s,retry:!1,queryFn:async()=>{if(!a||!r)throw new Error("No caip19able provided");let p=bo(a);try{let g=(await Et({tokens:[p]}))[r];if(!g)throw new Error(`Failed to fetch price for ${a}`);return g}catch(y){let g=y;throw r&&(g.response?.status===404||g.response?.status===400)?Oa:y}}}},Sm=({query:t,enabled:e=!0,queryOptions:n={refetchInterval:Qe.Short,staleTime:de.Short,gcTime:de.Short}})=>({...To({query:t,enabled:e,queryOptions:n}),refetchInterval:!1});function wt({query:t,enabled:e=!0,queryOptions:n={refetchInterval:Qe.Short,staleTime:de.Short,gcTime:de.Short}}){let r=W(),o=Yt("enable-price-streaming"),i=(0,ur.useRef)(null),s=Ma(t),a=s?le.price(s):null;(0,ur.useEffect)(()=>{if(!o||!e||!s||!a)return;let l=()=>{i.current&&(i.current(),i.current=null)},d=go.subscribe(s,(p,y)=>{r.setQueryData(a,y)},{onEvicted:l});return i.current=d,l},[o,e,s,a,r]);let m=o?Sm({query:t,enabled:e,queryOptions:n}):To({query:t,enabled:e,queryOptions:n});return I(m)}function Pm(t){return typeof t=="string"?t:J(t)}c();u();c();u();var La=M(B());c();u();var Fa=function(t,e=0){let n=3735928559^e,r=1103547991^e;for(let o=0,i;o<t.length;o++)i=t.charCodeAt(o),n=Math.imul(n^i,2654435761),r=Math.imul(r^i,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)};c();u();function Ra(t){return t.data.map(ar)}c();u();c();u();var Ua=(t,e)=>Array.apply(0,new Array(Math.ceil(t.length/e))).map((n,r)=>t.slice(r*e,(r+1)*e));var Cm=500;async function Ba({queryClient:t,queries:e}){let n={};try{let r={},o=[];for(let l of e){let d=l.caip19,p=J(d);if(r[p])continue;r[p]=!0;let y=le.price(p),g=t.getQueryState(y);if(g&&Date.now()-g.dataUpdatedAt<Da.staleTime){n[p]=g.data;continue}o.push(d)}let i=await Promise.allSettled(Ua(o,Cm).map(l=>Et({tokens:l}))),s=[],a=i.some(l=>l.status==="rejected"),m=i.reduce((l,d)=>d.status==="rejected"?l:{...l,...d.value},{});for(let l of o){let d=J(l),p=m[d],y=le.price(d);!p&&a&&(p=t.getQueryData(y)),p&&(n[d]=p),s.push(()=>{let g=p??null;t.setQueryData(y,g,{updatedAt:Date.now()})})}if(a){let l=t.getQueryData(le.priceError())??0;t.setQueryData(le.priceError(),l+1)}else t.removeQueries({queryKey:le.priceError()});km(s,50)}catch(r){sr(r)}return n}function km(t,e){let n=t.length,r=0;function o(){let i=t.slice(r,r+e);Bn.batch(()=>{i.forEach(s=>s())}),r+=e,r<n&&setTimeout(o,0)}o()}var xm=t=>typeof t=="string"?t:t.resourceType==="nativeToken"?t.slip44:t.address,Im=(t,e)=>t.localeCompare(e),Va=t=>{let e=t.map(xm).sort(Im).join(",");return Fa(e)},Ga=({query:t,enabled:e=!0,key:n,queryOptions:r={refetchInterval:Qe.Short},queryClient:o})=>{let{refetchInterval:i}=r,s=Ra(t),a=e&&t!=null&&t.data.length>0;return{queryKey:le.tempPrices(n),staleTime:0,gcTime:0,refetchInterval:i,queryFn:()=>Ba({queryClient:o,queries:s}),enabled:a}};function vo({query:t,enabled:e=!0,queryOptions:n={refetchInterval:Qe.Short}}){let r=W(),o=(0,La.useMemo)(()=>Va(t.data),[t]);return I(Ga({query:t,enabled:e,key:o,queryOptions:n,queryClient:r}))}c();u();var Eo=()=>I({queryKey:le.priceError(),queryFn:()=>{throw new Error("This query is cache-only")},enabled:!1,initialData:0,staleTime:1/0});c();u();c();u();var NT=h.object({caip19:h.string(),price:h.number().nullish(),priceChange24h:h.number().nullish(),lastUpdatedAt:h.string(),marketCap:h.string().nullish()}),Nm=[h.literal("1H"),h.literal("1D"),h.literal("1W"),h.literal("1M"),h.literal("YTD"),h.literal("ALL")],_m=h.union(Nm).nullish().transform(t=>t??"1D");var Om=[h.literal("1m"),h.literal("5m"),h.literal("1h"),h.literal("4h"),h.literal("1d"),h.literal("1w"),h.literal("4w"),h.literal("1mo")],_T=h.union(Om).nullish().transform(t=>t??"1d"),Mm=h.object({unixTime:h.number(),value:h.string()}),wo=h.object({history:h.array(Mm)});var Ut=new Error("Price history unavailable for this token"),Ao=new Error("Insufficient data for this time frame and token"),So=async({caip19:t,timeFrame:e})=>{let n=Le(t);if(Ge.get(n.chainId)?.pricesDisabled)throw Ut;let r=await $.api().get("/price-history/v1",{params:{token:t,type:e}});if(r.status===400)throw Ut;let o=wo.safeParse(r.data);if(!o.success)throw Ut;if(o.data.history.length<2)throw Ao;return o.data.history},Qa=({caip19:t,timeFrame:e})=>({queryKey:le.priceHistory(t,e),queryFn:()=>So({caip19:t,timeFrame:e}),staleTime:de.Short,gcTime:de.Short}),Po=t=>I(Qa(t));c();u();var Fm=1*60*1e3,Rm=t=>{let e=t.queryKey[1];return Object.prototype.hasOwnProperty.call(e??{},"id")?t.state.dataUpdatedAt>Date.now()-Fm:String(e)===le.priceError()[1]};c();u();c();u();c();u();var qa=M(Ha()),lr=M(zl());(0,qa.default)(lr.default.localeData("en"),{abbreviations:{thousand:"K",million:"M",billion:"B",trillion:"T"}});c();u();var ja=t=>{let e=t?Math.floor(Math.log10(t)):0,n=e<0?Math.pow(10,1-e):100;return Math.round(t*n)/n};var Wa=(t,e={})=>{let n=typeof t=="number"?t:L(t).toNumber(),{includePlusPrefix:r=!1,prefix:o="",infix:i="",suffix:s="",extendedDecimalsForSmallNumbers:a=!1,minimumAmount:m=.01,format:l="0,0.[00]",decimalFormatSmallNumbers:d="0.[00]",roundDecimals:p=!1}=e,y=n<0?"-":"",g=r&&n>0?"+":y,b=p?ja(Math.abs(n)):Math.abs(n);if(Math.abs(n)>=m||n===0){let E=Math.abs(n)>1?e.compact?"0.[00]a":l:d,S=(0,lr.default)(b).format(E);return`${o}${g}${i}${S}${s}`}else if(a){let E=new L(b).abs().toFormat();return`${o}${g}${i}${E}${s}`}else return`${o}${g}<${i}${new L(m).toFormat()}${s}`};var ne=M(B());c();u();var Co=({priceHistory:t,realtimePriceUpdates:e})=>{let n=t.at(-1),r=t.at(-2);if(!n||!r)return t.map(a=>({...a,tooltipUnixTime:a.unixTime}));let o=n.unixTime-r.unixTime,i=e.map((a,m)=>({unixTime:n.unixTime+(m+1)*o,value:a.value,tooltipUnixTime:a.unixTime}));return[...t.map(a=>({...a,tooltipUnixTime:a.unixTime})),...i]};c();u();var ko=({priceHistory:t,currentPrice:e})=>{let n=t.at(-1),r=t.at(-2),o=t.map(a=>({...a,tooltipUnixTime:a.unixTime}));if(e===void 0||!n||!r)return o;let i=n.unixTime-r.unixTime,s={unixTime:n.unixTime+i,value:e.toString(),tooltipUnixTime:n.unixTime+i};return[...o,s]};c();u();var za=M(Wl()),Bt=M(B()),$a=(t,e=100)=>{let[n,r]=(0,Bt.useState)(t),o=(0,Bt.useMemo)(()=>(0,za.default)(i=>r(i),e),[e]);return(0,Bt.useEffect)(()=>o(t),[o,t]),n};var jm=({error:t,chainId:e,prices:n,isPending:r})=>{if(Ge.get(e).pricesDisabled)return te.t("assetDetailPriceNoValue");if(t===Ut)return te.t("assetDetailPriceHistoryUnavailable");if(t===Ao||!r&&n.length===0)return te.t("assetDetailPriceHistoryInsufficientData");if(t)return te.t("assetDetailPriceHistoryError")},Wm=({caip19:t,userLocale:e="en-US",timeFrame:n="1D"})=>{let{t:r}=Me(),o=Re(),i=W(),[s,a]=(0,ne.useState)(n),m=(0,ne.useCallback)(z=>{if(z!==s){a(z);try{let{symbol:ye}=i.getQueryData(Zn.tokenDetails({caip19:t,includePrice:!0}))||{};o.capture("onPublicFungibleTimeframeChanged",{data:{timeFrame:z,caip19:t,symbol:typeof ye=="string"?ye:void 0}})}catch(ye){console.error("error capturing onPublicFungibleTimeframeChanged",ye)}}},[o,t,i,s]),{data:l,isPending:d,error:p}=Po({caip19:t,timeFrame:s}),{data:y}=wt({query:{data:t},queryOptions:{refetchInterval:Qe.VeryShort,staleTime:de.VeryShort}}),g=(0,ne.useMemo)(()=>{if(l){if(y?.price&&y.lastUpdatedAt&&l){let z=y.price,ye=new Date(y.lastUpdatedAt),Dt={value:z.toString(),unixTime:Math.floor(ye.getTime()/1e3)};return Co({priceHistory:l,realtimePriceUpdates:[Dt]})}return ko({priceHistory:l,currentPrice:y?.price})}},[l,y?.price,y?.lastUpdatedAt]),E=Le(t).chainId,S=y?.price,N=y?.usd_24h_change,G=(0,ne.useMemo)(()=>!S||!N?null:S/(1+N/100),[S,N]),[j,me]=(0,ne.useState)(null);(0,ne.useEffect)(()=>{g?.length&&me(g)},[g,me]);let ie=(0,ne.useMemo)(()=>g||j||[],[g,j]),se=jm({error:p,chainId:E,prices:ie,isPending:d});(0,ne.useEffect)(()=>{se&&me(null)},[se]);let ee=(0,ne.useMemo)(()=>[{timeFrame:"1H",label:r("assetDetailTimeFrame1H")},{timeFrame:"1D",label:r("assetDetailTimeFrame1D")},{timeFrame:"1W",label:r("assetDetailTimeFrame1W")},{timeFrame:"1M",label:r("assetDetailTimeFrame1M")},{timeFrame:"YTD",label:r("assetDetailTimeFrameYTD")},{timeFrame:"ALL",label:r("assetDetailTimeFrameAll")}].map(z=>({...z,label:z.label?.toUpperCase()})),[r]),[xe,fe]=(0,ne.useState)(null),Ae=$a(xe,100),[w,T]=(0,ne.useMemo)(()=>{if(!ie.length)return[G??null,S??null];let[z,ye]=[ie[0],ie[ie.length-1]].map(Dt=>new L(Dt.value).toNumber());return[z,S||ye]},[S,G,ie]),x=(0,ne.useMemo)(()=>Ae??T,[Ae,T]),P=(0,ne.useMemo)(()=>T===null||w===null?null:T-w,[w,T]),k=(0,ne.useMemo)(()=>x===null||w===null?null:x-w,[x,w]),D=(0,ne.useMemo)(()=>{if(k===null||w===null||w===0)return null;let z=k/w*100;return`${Wa(z,{includePlusPrefix:!0})}%`},[k,w]),U=(0,ne.useCallback)(z=>{let ye=new Date(z*1e3),Dt=ye.toLocaleTimeString(e,{hour:"2-digit",minute:"2-digit"}),Li=ye.toLocaleString(e,{month:"short",day:"2-digit"}),Ml=ye.getFullYear(),Vi=ie.at(-1);if(Vi&&Vi.unixTime===z)return r("assetDetailPriceHistoryNow");switch(s){case"1H":case"1D":return Dt;case"1W":case"1M":return`${Dt}, ${Li}`;case"YTD":case"ALL":return`${Li}, ${Ml}`;default:return s}},[e,ie,s,r]),K=(0,ne.useMemo)(()=>Ge.get(E).pricesDisabled??!1,[E]);return{activeTimeFrame:s,setActiveTimeFrame:m,prices:ie,isPending:d,errorText:se,timeFrames:ee,setScrubValue:fe,scrubValue:Ae,currentPrice:x,overallPriceChange:P,currentPriceChange:k,formattedPercentageChange:D,formatTimeFrameText:U,hidePriceAmounts:K,hideTimeFrames:K}};c();u();c();u();c();u();var xo=h.object({feerate:h.string()}),Ya=h.object({conservative:xo,economical:xo,unset:xo}),zm=h.object({recommended:h.object({priceEstimates:Ya}),bitcoin_rpc:h.object({priceEstimates:Ya})}),$m=h.object({gasPriceSources:zm}),Ym=new H("1.25"),Xm=new H("1.5"),Xa=async(t,e=!0)=>{let n,r,o;try{let{priceEstimates:i}=(await Jm(t)).gasPriceSources.recommended,{conservative:s,economical:a,unset:m}=i;n=new H(s.feerate),r=new H(a.feerate),o=new H(m.feerate)}catch(i){if(!e)throw i;let s=await Wn(t).estimateSmartFee(2,"ECONOMICAL");o=new H(s.feerate),r=o.times(Ym),n=o.times(Xm)}return{fast:{btcPerKilobyte:n.multipliedBy(1)},standard:{btcPerKilobyte:r.multipliedBy(1)},slow:{btcPerKilobyte:o.multipliedBy(1)}}};async function Jm(t){let e=`https://gas-price-oracle.phantom.app/?chainId=${t}`,n=await $.headers({"Content-Type":"application/json"}).get(e);return $m.parse(n.data)}c();u();var At="gas-estimation";var Zm=3,ed=600,td=v({seconds:30}),St=({networkID:t,enableFallback:e=!1,retry:n=Zm,retryDelay:r=ed,enabled:o=!0})=>I({queryFn:async()=>{try{if(!t)throw new Error("Missing networkID");if(A.isBitcoinNetworkID(t))return await Xa(t,e);if(A.isEVMNetworkID(t))return await As(t,e);if(A.isSolanaNetworkID(t))throw new Error("Transaction speeds is not supported for Solana.");if(A.isSuiNetworkID(t))throw new qi("transaction speeds to unit cost");return Ce(t)}catch(i){throw i instanceof ws||(_.addBreadcrumb(At,`enableFallback: ${e}, networkID: ${t}`,"info"),_.captureError(i,"transaction")),i}},queryKey:V.transactionSpeedsToUnitCost(t),refetchOnMount:"always",retry:n,retryDelay:r,staleTime:td,enabled:o&&!!t&&(A.isEVMNetworkID(t)||A.isBitcoinNetworkID(t)),placeholderData:Un});c();u();c();u();var Ja=async(t,e)=>{let n=Ts(t),r=await fs.eth_estimateGas(n,[e]);if("error"in r)throw new Error(`[${r.error.code}] ${r.error.message}`);return new H(r.result)};var UE=new H(21e3),nd=6,rd=600,od=v({seconds:5}),id=v({days:1}),Io=(t,e=!0)=>I({queryFn:async()=>{if(!t)throw new Error("Args is required for calculating transaction units.");try{return await sd(t)}catch(r){throw _.addBreadcrumb(At,`networkId: ${t?.networkID}`,"info"),_.captureError(r,"transaction"),r}},queryKey:V.transactionUnitAmount(t),enabled:!!t&&(A.isEVMNetworkID(t.networkID)||A.isBitcoinNetworkID(t.networkID))&&e,retry:nd,retryDelay:rd,staleTime:od,gcTime:id}),sd=async t=>{if(qn(t)){let{gas:e}=t.unsignedTransaction;if(e)return{gasLimit:new H(e,16)};{let n=await Ja(t.networkID,t.unsignedTransaction);return{gasLimit:new H(Ss(n))}}}else if(Hn(t)){let e=t.psbtChain,n=e?new H(Gn(e.map(o=>o.additionalCost.vb.toNumber()))):new H(0),r=e?new H(Gn(e.map(o=>o.additionalCost.sats.toNumber()))):new H(0);return{virtualBytes:new H(t.vb),additionalCosts:{vb:n,sats:r}}}else throw new Error(`Unsupported transaction networkId: ${t.networkID} for calculating transaction units.`)};c();u();c();u();var dr=M(Bl(),1),ec=M(Nt(),1);var Za=(0,dr.struct)([(0,dr.u8)("instruction")]);function tc(t,e,n,r=[],o=Zt){let i=Zs([{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e,isSigner:!1,isWritable:!0}],n,r),s=Buffer.alloc(Za.span);return Za.encode({instruction:Xs.CloseAccount},s),new ec.TransactionInstruction({keys:i,programId:o,data:s})}c();u();var ad=v({seconds:30}),cd=v({minutes:5}),nc=t=>I({queryKey:V.transactionAdditionalCosts(t),queryFn:async()=>{if(!t)return new H(0);let e=gt.get(t.networkID).additionalTransactionCost;return e?await e(t):new H(0)},enabled:!!t,staleTime:ad,gcTime:cd});var ld=6,md=600,dd=v({seconds:5}),pd=v({days:1}),fd=["fast","standard","slow"],yd=t=>{if(!t)return"fast";for(let e of fd)if(t[e])return e;throw new Error("No valid transaction speeds found.")},Do=t=>{let e=bd(t),n=t?.queryOptions?.refetchInterval,{data:r,isError:o}=Io(t?.multichainTransaction,e),{data:i}=St({networkID:t?.networkID,enableFallback:!0,refetchInterval:n}),{data:s}=nc(t?.multichainTransaction),a=gd(t,r,i);return I({queryFn:async()=>{try{if(!t)throw new Error("Missing args");let{multichainTransaction:l,transactionSpeed:d="standard"}=t;if(!l)throw new Error("Multichain transaction is null.");if(o&&No(t.networkID))throw new Error("Transaction unit amount is required but errored.");if(qn(l)||Hn(l)){if(!i)throw new Error("Missing transactionSpeedsToUnitCost");if(!r)throw new Error("Missing transactionUnit");let p=d==="fastest"?yd(i):d,y=i[p];if(!y)throw new Error(`Missing transactionSpeedsToUnitCost for ${d}`);return Mt(l.networkID,y,r,s)}if(_s(l))return l.networkID==="solana:localnet"?{networkID:l.networkID,value:0,highFees:!1}:await Xn(l.networkID,l.transaction.map(y=>"version"in y?y.message:y.compileMessage()));if(Os(l))return await Ws(l);Ce(l)}catch(l){throw _.addBreadcrumb(At,`chainId: ${t?.networkID}`,"info"),_.captureError(l,"transaction"),l}},queryKey:V.gasEstimation(t?.networkID,t?.multichainTransaction,t?.transactionSpeed,s),enabled:a,retry:ld,retryDelay:md,refetchInterval:n,staleTime:dd,gcTime:pd,placeholderData:l=>l})};function No(t){return A.isBitcoinNetworkID(t)||A.isEVMNetworkID(t)?!0:A.isSolanaNetworkID(t)||A.isSuiNetworkID(t)?!1:Ce(t)}function hd(t){return A.isBitcoinNetworkID(t)||A.isEVMNetworkID(t)?!0:A.isSolanaNetworkID(t)||A.isSuiNetworkID(t)?!1:Ce(t)}function gd(t,e,n){if(!t)return!1;let{networkID:r,multichainTransaction:o}=t;return o?(!!e||!No(r))&&(!!n||!hd(r)):!1}function bd(t){return t?No(t.networkID):!1}c();u();c();u();var Td=new Error("missing price"),vd=new Error("Unable to format gas estimation"),pr=(t,e)=>{if(!e.usd)throw Td;try{let n=A.getTokenDecimals(t.networkID);if(Kn(t)){let r=Ls(t),i=new L(r).div(Jt(n)).times(new L(e.usd));return{gasEstimationPriceUSD:Xt(i),gasEstimationPriceUSDNumber:i.toNumber(),gasEstimationAmount:r}}else if(_t(t)){let r=Vs(t),i=r.div(new L(X.LAMPORTS_PER_SOL)).times(e.usd);return{gasEstimationPriceUSD:Xt(i),gasEstimationPriceUSDNumber:i.toNumber(),gasEstimationAmount:r}}else if(Qn(t)){let o=Is(t.gasBudget,n).times(e.usd);return{gasEstimationPriceUSD:Xt(o),gasEstimationPriceUSDNumber:o.toNumber(),gasEstimationAmount:t.gasBudget}}else if(Ot(t)){let r=Gs(t),i=new L(r).div(Jt(n)).times(e.usd);return{gasEstimationPriceUSD:Xt(i),gasEstimationPriceUSDNumber:i.toNumber(),gasEstimationAmount:r}}else throw Ce(t),new Error("unsupported chain type")}catch{throw vd}};var Ed=(t,e,n)=>{let r=t?A.getChainID(t):null,o=r?Mn(r):void 0,{data:i,isFetched:s}=wt({query:{data:o}}),a=!!t&&!!e&&s,m=V.gasEstimationPrice(t,e);return I({enabled:a,queryKey:m,queryFn:()=>{if(!i||!e)throw new Error("missing args");return pr(e,i)},refetchOnMount:!0,placeholderData:Un,...n||{}})};c();u();c();u();var rc=Object.prototype.hasOwnProperty;function oc(t,e,n){for(n of t.keys())if(tt(n,e))return n}function tt(t,e){var n,r,o;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&tt(t[r],e[r]););return r===-1}if(n===Set){if(t.size!==e.size)return!1;for(r of t)if(o=r,o&&typeof o=="object"&&(o=oc(e,o),!o)||!e.has(o))return!1;return!0}if(n===Map){if(t.size!==e.size)return!1;for(r of t)if(o=r[0],o&&typeof o=="object"&&(o=oc(e,o),!o)||!tt(r[1],e.get(o)))return!1;return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((r=t.byteLength)===e.byteLength)for(;r--&&t.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(t)){if((r=t.byteLength)===e.byteLength)for(;r--&&t[r]===e[r];);return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(rc.call(t,n)&&++r&&!rc.call(e,n)||!(n in e)||!tt(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}var ic=M(B());var wd=t=>{let e=ae(),n=(0,ic.useRef)(void 0),r=V.pendingTransactionById(t);return I({queryKey:r,queryFn:async()=>{try{let s=(await $n(e))[t];return s?(tt(s,n.current)||(n.current=s),n.current):null}catch(i){throw _.captureError(i,"transaction"),i}},refetchInterval:200,staleTime:200,gcTime:0,refetchOnMount:!0})};c();u();var cc=M(ms()),uc=M($l());var an=M(B());c();u();var sn=M(ms()),sc=M(B());function ac(t,e){let n=(0,sc.useRef)((0,sn.default)());I({queryKey:["PENDING-TX-POLLER",t],enabled:t.length>0,queryFn:()=>Bs(t,e),refetchInterval:()=>(0,sn.default)().diff(n.current,"seconds")<30?5*1e3:(0,sn.default)().diff(n.current,"minutes")<2?15*1e3:(0,sn.default)().diff(n.current,"minutes")<5?30*1e3:!1})}cc.default.extend(uc.default);var cn=t=>{let e=ae(),n=(0,an.useRef)([]),r=(0,an.useRef)([]);(0,an.useEffect)(()=>{n.current=[],r.current=[]},[t]);let o=V.pendingTransactions(t),i=async()=>{let s=await $n(e),a=Rs(s,t);if(!tt(a,n.current)){let m=n.current.filter(l=>!a.find(d=>d.id===l.id));tt(m,r.current)||(r.current=m),n.current=a}return{pendingTransaction:n.current,removedPendingTransactions:r.current}};return ac(t,e),I({queryKey:o,queryFn:i,refetchInterval:1e3,staleTime:500,gcTime:0,refetchOnMount:!0,enabled:!!t.length})};c();u();var pc=M(B());c();u();var lc=t=>({connection:bt(t),cluster:zn(t)}),mc=()=>lc(yt.Solana.Mainnet),dc=t=>{let e,n=t?.addresses??[];for(let o of n)if(A.isSolanaNetworkID(o.networkID)){e=o.networkID;break}let r=e??yt.Solana.Mainnet;return lc(r)};var un=()=>{let t=(0,pc.useMemo)(mc,[]),{data:e=t}=Fe({select:dc});return e};c();u();c();u();c();u();var qe=M(B()),fc=(0,qe.createContext)(null),Ad=({children:t})=>{let{data:e}=ps(),{data:n,isLoading:r}=Yr(e),o=e&&n?$r[e].languageCode:Ln.languageCode,i=e||Ln.value,s=e&&n?$r[e].symbol:Ln.symbol,a=(0,qe.useCallback)((p,y)=>Intl.NumberFormat(o,{style:"currency",currency:i,...y}).format(p),[i,o]),m=(0,qe.useCallback)(p=>!e||!n?Number(p):L(p).div(L(n)).toNumber(),[e,n]),l=(0,qe.useCallback)((p,y)=>{if(!e||!n)return Number(p);let g=L(p).times(L(n));return y===void 0?g.toNumber():g.decimalPlaces(y).toNumber()},[e,n]),d={isLoading:r,currencyLocale:o,currencySymbol:s,currencyCode:i,toUsd:m,fromUsd:l,formatLocalizedPrice:a};return qe.default.createElement(fc.Provider,{value:d},t)},ln=()=>{let t=(0,qe.useContext)(fc);if(!t)throw new Error("useLocalizedCurrency must be used within a LocalizedCurrencyProvider");return t};c();u();c();u();c();u();var Qc=M(B());c();u();var yc=async t=>{try{return await vs(yt.Ethereum.Mainnet).resolveName(t)}catch(e){return console.error(e),null}};c();u();var hc=async(t,e)=>{let n="/uns/v1/resolve";try{let r=await $.api().headers({"Content-Type":"application/json"}).post(n,{query:t,chainId:e});if(!Pe(r))throw Jr;let o=r.data;if(o.address===""||o.status!=="OK")throw Jr;return o.address}catch{return null}};c();u();var Lc=M(Bc());var Vc=async(t,e)=>{try{if(!A.isSolanaNetworkID(e))return null;let n=zn(e),r=Fs(n),i=await new Lc.TldParser(r).getOwnerFromDomainTld(t);return i?i.toString():null}catch{return null}};c();u();var Gc=async(t,e)=>{try{if(!A.isSuiNetworkID(e))return null;let n=Ms(e);return t.toLowerCase().endsWith(".sui")&&await n.resolveNameServiceAddress({name:t})||null}catch{return null}};function jo(t,e){let n=t?.toLowerCase(),r=Wo(n,e),o=r.error,i=(0,Qc.useMemo)(()=>o===Vn?te.t("sendFormErrorInvalidDomain"):o===hs?te.t("sendFormErrorInvalidSolanaAddress"):o===gs?te.t("sendFormErrorInvalidTwitterHandle"):o===Xr?te.t("sendFormErrorInvalidUsername"):"",[o]);return{...r,error:i}}function Wo(t,e){let n=as(),r=Re(),o=!!t&&!!e,i=V.resolveDomainName(t,e);return I({queryKey:i,queryFn:async()=>{if(!t||!e)throw ys;let a=await Kc(t,e,n,r);return{address:a?.owner??null,type:a?.type??null,handle:t}},enabled:o})}var dp=async(t,e)=>{try{if(t.startsWith("@")||!A.isEVMNetworkID(e))return null;let[n]=os(t);if(n){let r=await yc(t);if(!r)throw Vn;return r}return null}catch(n){return _.captureError(n instanceof Error?n:new Error(`Unable to resolve EVM domain: ${t}`),"transaction"),null}},pp=async(t,e,n)=>{try{if(t.startsWith("@")||!A.isSolanaNetworkID(e))return null;let[r,o,i]=rs(t);(r||o||i)&&n.capture("resolveDomainBonfida");let s=r||o||i,a=null;if(s&&(a=await hc(t,e),!a))throw Vn;return a}catch(r){return _.captureError(r instanceof Error?r:new Error(`Unable to resolve solana domain: ${t}`),"transaction"),null}},fp=async(t,e,n)=>{try{if(!t.startsWith("@"))return null;let r=t.slice(1),o=await n.getUserProfileByUsername(r),i=o?.username?.toLowerCase()===r.toLowerCase(),s=o?.addresses?o.addresses?.[e]!==void 0:!1,a=!!o&&i&&s,m=null;if(a&&(m=o.addresses[e],!m))throw Xr;return m}catch(r){return _.captureError(r instanceof Error?r:new Error(`Unable to resolve username: ${t}`),"Auth"),null}};async function Kc(t,e,n,r){let o=Fn.isFeatureEnabled("kill-suins"),i=[{type:"username",fetch:fp(t,e,n)},{type:"solana",fetch:pp(t,e,r)},{type:"evm",fetch:dp(t,e)},{type:"ans",fetch:Vc(t,e)}];o||i.push({type:"suins",fetch:Gc(t,e)});let s=await Promise.all(i.map(({fetch:m})=>m)),a=s.findIndex(m=>m!==null);return a===-1?null:{type:i[a].type,owner:s[a]}}c();u();var wr=M(B()),jc=M(qc());function vp(t,e){let[n,r]=(0,wr.useState)(t);(0,jc.default)(()=>r(t),500,[t]);let{data:o,error:i,isLoading:s}=jo(n,e),m=o?.address??t,l=t.length>0,p=!l||t!==n||s,y=(0,wr.useMemo)(()=>{if(p)return;if(i)return i;if(!zi(m,e))return te.t("sendFormInvalidAddress",{assetName:A.getChainName(e)})},[e,p,i,m]);return{recipientError:y,currentRecipient:m,isStaleRecipient:p,disabledDueToRecipient:!!y||p||!l,isRecipientLoading:s&&t!==""}}c();u();var Ep=3,wp=500,Ap=5e3,Sp=(t,e,n)=>I({async queryFn(){if(A.isEVMNetworkID(t))try{return await Pp(t,e,n)}catch(r){throw _.captureError(r,"transaction"),r}},queryKey:V.gasEstimationTimeToMine(t,e,n),retry:Ep,retryDelay:wp,refetchInterval:Ap,enabled:A.isEVMNetworkID(t)&&A.isMainnetNetworkID(t)});async function Pp(t,e,n){let r=`https://gas-price-oracle.phantom.app/time_to_mine?chainId=${t}&maxFeePerGas=${e}&maxPriorityFeePerGas=${n}`,o={Accept:"application/json","Content-Type":"application/json"},i=await $.headers(o).get(r);if(i.status!==200)throw new Error("Error estimating time to mine");return i.data}c();u();c();u();var Cp=({networkID:t,refetchInterval:e,transactionSpeed:n="standard",gasLimit:r,enabled:o=!0})=>{let{data:i,status:s,fetchStatus:a,isError:m,isPending:l,isFetched:d,isSuccess:p}=St({networkID:t,refetchInterval:e,enableFallback:!0,enabled:o}),y;if(o&&i&&r){let{maxFeePerGas:b,maxPriorityFeePerGas:E}=i[n];y={networkID:t,gasLimit:r,maxFeePerGas:b,maxPriorityFeePerGas:E}}return{status:s,data:y,isError:m,isLoading:l,fetchStatus:a,hasFailed:d&&!p}};c();u();var Yo=t=>{let e=t[0]?.networkID,n=e?A.getChainID(e):null,r=n?Mn(n):void 0,{data:o}=wt({query:{data:r}});return ns({queries:t.map(s=>({queryKey:V.gasEstimationPrice(e,s),queryFn:()=>{if(!o||!s)throw new Error("missing args");return pr(s,o)}}))}).map(s=>s.data)};c();u();var Wc=M(B());var kp=v({days:5}),xp=()=>{let t=Re(),e=W(),{data:n={}}=I({queryKey:V.timestamps(),queryFn:()=>({...e.getQueryData(V.timestamps())||{}})});(0,Wc.useEffect)(()=>{let r=Object.values(n),{staleTimestampDatas:o,freshTimestampDatas:i}=r.reduce((a,m)=>{let l=Math.max(...Object.values(m.timestamps));return Date.now()-l>kp?a.staleTimestampDatas.push(m):a.freshTimestampDatas.push(m),a},{staleTimestampDatas:[],freshTimestampDatas:[]});Cs(e,o?.map(a=>a.transactionId)??[]);let s=i.filter(a=>a.timestamps.appUpdated);ks(s,t,e)},[n,t,e])};c();u();var zc=M(B());var Xo=(t,e,n=!1)=>{let r=W();return(0,zc.useCallback)((i,s,a)=>{if(i===void 0)return;let m=V.timestamps(),d=r.getQueryData(m)||{[i]:{chainId:e,transactionType:t,isLedger:n,transactionId:i,timestamps:{}}},p=d[i];if(p?.timestamps[s])return;let y={...d,[i]:{...p||{chainId:e,transactionType:t,isLedger:n,transactionId:i,timestamps:{}},timestamps:{...p?.timestamps??{},[s]:a??Date.now()}}};r.setQueryData(m,y)},[e,n,r,t])};c();u();c();u();function Ip(t){let e=ae(),n=Ve();return Ie({mutationFn:async o=>await Ft({...o,accountSigner:n,connection:t,storage:e})})}c();u();c();u();function $c(t){return t!=null}var gn=M(B());var Dp={fast:"gasFast",standard:"gasAverage",slow:"gasSlow"};function Np(t,e,n){let[r,o]=(0,gn.useState)(e),i=n??xs(t),{data:s={}}=St({networkID:t}),a=(0,gn.useMemo)(()=>Object.keys(s).reduce((S,N)=>{let G=N,j=s[G];return j&&(S[G]=Mt(t,j,i,void 0)),S},{}),[s,t,i]),m=Object.keys(a),l=Object.values(a),d=Yo(Object.values(a)),p=l.map(S=>jn(S)),{fromUsd:y,formatLocalizedPrice:g}=ln(),b=m.map((S,N)=>{let G=l[N],j=d[N],me=p[N];return _p(j,me,S,G,y,g)});return{presets:(0,gn.useMemo)(()=>b.map((S,N)=>({description:S,title:te.t(Dp[m[N]]),selected:r===m[N],onClick:()=>o(m[N]),withBorderTop:N!==0})),[b,m,r]),transactionSpeed:r}}var _p=(t,e,n,r,o,i)=>{let s=[],a=t?.gasEstimationPriceUSDNumber?o(t?.gasEstimationPriceUSDNumber):void 0,m=a?i(a,{maximumFractionDigits:4}):void 0,l=m?te.t("gasUpTo",{amount:m}):e?te.t("gasUpTo",{amount:e}):void 0;s.push(l);let d=r?gt.get(r.networkID).transactionSettingsRowFeeDescription?.(r):void 0;s.push(d);let p=r?.networkID;if(p){let y=gt.get(p).transactionSpeedDescription(n);y&&s.push(te.t(y))}return s.filter($c).join("  \u2022  ")};c();u();function Op(t){let{data:e}=cn(t?[t]:[]);if(t&&A.isBitcoinNetworkID(t.networkID))return!e||e.pendingTransaction.length===0?void 0:{title:te.t("sendSummaryBitcoinPendingTxTitle"),description:te.t("sendSummaryBitcoinPendingTxDescription"),buttonText:te.t("gotIt")}}c();u();var Yc=M(B());c();u();var Ar=ss(ae,t=>Hs(new Ks(t)));var Mp="transactions-utxo-state",Fp=6,Rp=600,Up=v({seconds:30}),Bp=v({seconds:5}),Lp=v({minutes:10}),Sr=t=>{let e=Ar(),n=Yt("enable-bypass-utxo-protection");return I({queryFn:Xc(t,e,n),queryKey:V.utxoState(t,n),enabled:Jc(t),retry:Fp,retryDelay:Rp,refetchInterval:Up,staleTime:Bp,gcTime:Lp})};function Vp(t){let e=Ar(),n=W(),r=Yt("enable-bypass-utxo-protection"),o=V.utxoState(t,r);(0,Yc.useEffect)(()=>{Jc(t)&&n.prefetchQuery({queryKey:o,queryFn:Xc(t,e,r)})},[])}function Xc(t,e,n){return async()=>{try{if(!t)throw new Error("chainAddress not provided when fetching utxo state.");if(Wr(t)){await e.refetchUtxos(t,n);let[r,o,i]=await Promise.all([e.getSafeToSendUtxos(t.address,n),e.getInscribedUtxos(t.address),e.getRareSatsUtxos(t.address)]);return{safeToSendUtxos:r,inscribedUtxos:o,rareSatsUtxos:i}}else throw new Error(`Unsupported chain address type for fetching utxo state: ${t.addressType}`)}catch(r){if(On(r)){let o=r.response?.status;qs(r,o,Mp)}throw r}}}function Jc(t){return!!t&&Wr(t)}c();u();function Gp(t,e){let n=t?.toLowerCase(),{data:r}=Wo(n,e);return r?.address||t}c();u();var Qp=({networkID:t,gasEstimation:e,gasEstimationPrice:n})=>{let r=jn(e),{fromUsd:o,formatLocalizedPrice:i}=ln(),s=n?.gasEstimationPriceUSDNumber?o(n?.gasEstimationPriceUSDNumber):void 0,a=s?i(s,{maximumFractionDigits:4}):void 0,m=!A.isMainnetNetworkID(t),l=a&&!m?a:r||void 0;return gt.get(t).networkFeeRowString(l,a)};c();u();var Zc=M(B());function Kp(t,e,n){let r=t.data.transactions[t.data.transactions.length-1],{data:o}=cn(n?.addresses||[]),i=t.networkID;(0,Zc.useEffect)(()=>{let S=o?.pendingTransaction.find(N=>N.id===t.id);(!S||S.data.transactions.some(N=>N.confirmations>0))&&e()},[o?.pendingTransaction,e,t]);let s={networkID:i,unsignedTransaction:r.unsignedTransaction},{data:a,status:m}=Do({networkID:i,transactionSpeed:"fast",multichainTransaction:s,queryOptions:{refetchInterval:!1}}),l=new H(r.unsignedTransaction.maxFeePerGas??"0"),d=a?.maxFeePerGas&&a?.maxFeePerGas.gt(l)?a?.maxFeePerGas:l,p=new H(r.unsignedTransaction.maxPriorityFeePerGas??"0"),y=a?.maxPriorityFeePerGas&&a?.maxPriorityFeePerGas.gt(p)?a?.maxPriorityFeePerGas:p,g=d?.multipliedBy(1.11).integerValue(),b=y?.multipliedBy(1.11).integerValue();return{data:Mt(i,{maxFeePerGas:g,maxPriorityFeePerGas:b},{gasLimit:new H(r.unsignedTransaction.gas??"0")},a?.l1Fee),status:m}}c();u();var Hp=M(Vl());c();u();var qp=()=>{let t=Fn.getMultivariateAssignment("frontend-transaction-sharing-delay-ms");if(!t)return eo;let e=parseInt(t);return Number.isNaN(e)?eo:e},jp=()=>({delayMs:qp()});c();u();c();u();c();u();c();u();c();u();c();u();c();u();var eu=async(t,e,n)=>{let{accountIdentifier:r,nonce:o,pendingTransaction:i,pendingTransactionInput:s,gasEstimation:a}=e,{data:{transactions:m}}=i,l=m[m.length-1],{callPayload:d,unsignedTransaction:p}=l,{networkID:y}=i,g=await Yn({accountSigner:t,accountIdentifier:r,networkID:y,unsignedTransaction:{...p,...Us(a),nonce:js(new H(o))},callPayload:{...d},pendingTransactionInput:s,storage:n});return{networkID:y,id:g}};function $p(){let t=Ve(),e=ae();return Ie({mutationFn:async r=>eu(t,r,e)})}c();u();c();u();var Yp=v({seconds:5}),Pr=async(t,e,n=1,r=Yp,o=2)=>{try{let i=await Wn(t).getRawTransaction(e);return i.confirmations&&i?.confirmations>=n?i:(await zr(r),Pr(t,e,n,r,o))}catch(i){if(i instanceof Error&&o>0)return await zr(r),await Pr(t,e,n,r,o-1);throw i}};function Xp(t,e){let n=Re(),r=!!e,o=V.waitForTransactionConfirmation(e);return I({enabled:r,queryKey:o,queryFn:async()=>{if(!e){let s="Missing chainID or transactionReceipt.";throw new Error(s)}try{if(A.isSolanaNetworkID(e.networkID)){let s=bt(e.networkID);await ea({connection:s,signature:e.id})}else if(A.isEVMNetworkID(e.networkID))await Es(e.networkID,e.id);else if(A.isBitcoinNetworkID(e.networkID))await Pr(e.networkID,e.id);else if(A.isSuiNetworkID(e.networkID))await zs(e.networkID,e.id);else throw new Error("Unsupported transaction receipt type.");return t(e),!0}catch(s){if(s&&s instanceof bs)throw s;let a="Unable to send transaction.";s.message&&(a=s.message);let{networkID:m}=e,l={chainId:A.getChainID(m),networkId:m};throw n.capture("waitForTransactionConfirmationError",{data:{...l,errorMessage:s.message}}),new Error(a)}}})}c();u();var Jp=t=>{let e=t.transaction.getData();return I({queryKey:V.suiTransaction(e),queryFn:()=>$s(t)})};c();u();c();u();function Jo(t){let e=Rn();return I(tu(e,t??""))}function tu(t,e){return{gcTime:Rt.Long,staleTime:1/0,enabled:!!e&&!!t,queryKey:ce.hiddenMints(e??""),async queryFn(){return!e||!t?new Map:await er(t,e)}}}c();u();var Zp=/[e|+|-]/i;function ef(t,e){let n=Math.floor(t*e*100)/100;return!Number.isFinite(n)||n.toString().match(Zp)?0:n}function tf(t,e,n){let r=L(t);return e<=0||!r.isFinite()?0:r.dividedBy(e).decimalPlaces(n).toNumber()}c();u();c();u();function Zo({balance:t,priceId:e,priceMap:n}){let r=e?n[e]?.usd:void 0,o=e?n[e]?.usd_24h_change:void 0;if(r===void 0)return{usd:void 0,usd_24h_change:void 0,price:r};let i=t.multipliedBy(r),s;return o!==void 0&&(s=i.minus(i.dividedBy(1+o/100))),{usd:i.toNumber(),usd_24h_change:s?.toNumber(),price:r,priceChange24h:o,currencyValue:i.toNumber(),currencyChange:s?.toNumber()}}c();u();c();u();var nf=new Error("Price history interval unavailable for this token");c();u();c();u();var BD=[{value:"1m",ms:v({minutes:1})},{value:"5m",ms:v({minutes:5})},{value:"1h",ms:v({hours:1})},{value:"4h",ms:v({hours:4})},{value:"1d",ms:v({days:1})},{value:"1w",ms:v({days:7})},{value:"4w",ms:v({days:28})},{value:"1mo",ms:v({days:30})}];c();u();var ru=M(B());var rf=()=>{let{connection:t}=un(),{data:e}=Fe(),{solanaChainAddress:n,accountIdentifier:r}=(0,ru.useMemo)(()=>({solanaChainAddress:e?.addresses.find(ht),accountIdentifier:e?.identifier??""}),[e]),o=ae(),i=Ve(),{t:s}=Me();return Ie({mutationFn:async a=>{if(!n)throw new Error("solanaChainAddress not loaded");if(a.type!=="CompressedSPL")throw new Error("SPL is not compressed");let m=await ta({owner:a.data.walletAddress,mint:a.data.mintAddress,amount:a.data.amount,programId:a.data.programId,connection:t}),{networkID:l,address:d}=n,p={ownerAddress:d,networkID:l,data:{signature:""},type:"decompress",display:{summary:{topLeft:{text:s("assetDetailClaiming")}}}};await Ft({accountIdentifier:r,accountSigner:i,connection:t,feePayer:new X.PublicKey(d),pendingTransactionInput:p,storage:o,transaction:m,useSubmissionService:!1})}})};c();u();c();u();var $e=M(B());c();u();function ou(t){let e,n;for(let{data:r}of t){let{usd:o,usd_24h_change:i}=r;o!==void 0&&(e=e!==void 0?e+o:o),i!==void 0&&(n=n!==void 0?n+i:i)}return{value:e,earnings:n}}c();u();function iu(t,e){return t.getQueriesData({predicate:r=>r.queryKey[0]==="transferFungibleLoggingContext"}).map(([,r])=>r).filter(r=>{if(!r)return!1;let{previousBalance:o,fungibleKey:i}=r,s=e.get(i);return s?!s.data.balance.isEqualTo(o):!1})}c();u();var su=(t,e)=>{let n=ce.transferFungibleLoggingContext(t);e.removeQueries({queryKey:n})};c();u();function au({tokens:t,priceMap:e}){let n=[];for(let r of t){let{amount:o,decimals:i}=r.data,s=nr(r),a=J(s),m=tr(r),l=tn(o,i),d={type:r.type,data:{...r.data,balance:l,key:m}},p,y=Zo({priceId:a,balance:l,priceMap:e});if(r.type==="SPL"||r.type==="CompressedSPL"){let{mintAddress:g}=r.data;p=g}else if(r.type==="ERC20"||r.type==="SuiCoin"){let{contractAddress:g}=r.data;p=g}else if(r.type==="BRC20"){let{firstCreatedInscriptionId:g}=r.data;p=g}d.data.tokenAddress=p,d.data.usd=y.usd,d.data.price=y.price,d.data.usd_24h_change=y.usd_24h_change,d.data.priceChange24h=y.priceChange24h,d.data.currencyChange=y.currencyChange,d.data.currencyValue=y.currencyValue,n.push(d)}return n}function Ct({showHiddenMints:t=!1,keys:e,enablePrices:n=!0,enableSorting:r=!0,usePricesQueryOptions:o,useTokenQueryOptions:i}={}){let{data:s}=Fe(),{data:a=[],isPending:m,isRefetching:l,refetch:d,isError:p,error:y}=ua({chainAddresses:s?.addresses,keys:e,queryOptions:i}),{data:g,isPending:b,isRefetching:E}=Jo(s?.identifier),{query:S}=(0,$e.useMemo)(()=>({query:{data:a.map(nr)}}),[a]),{data:N,isPending:G,isRefetching:j,refetch:me,isError:ie}=vo({query:S,enabled:n&&!m&&s?.identifier!=null,queryOptions:o}),{fungibles:se,fungibleMap:ee}=(0,$e.useMemo)(()=>{let P=t?a:a.filter(U=>{let K=tr(U),re=(e||[]).includes(K),Q=Tt(g,{key:K,spamStatus:U.data.spamStatus});return re||Q}),k=au({tokens:P,priceMap:N??{}});r&&(e===void 0?k=k.sort(la):k=k.sort((U,K)=>{let re=e.indexOf(U.data.key),Q=e.indexOf(K.data.key);return re<Q?-1:re>Q?1:0}));let D=new Map;for(let U of k)D.set(U.data.key,U);return{fungibles:k,fungibleMap:D}},[a,e,t,g,N,r]),xe=(0,$e.useMemo)(()=>!!g&&g.size>0&&a.length>0&&se.length===0,[a,g,se]),fe=W(),Ae=(0,$e.useMemo)(()=>iu(fe,ee),[ee,fe]),w=Xo("send:fungible",yt.Solana.Mainnet);(0,$e.useEffect)(()=>{for(let P of Ae)w(P.transactionId,"appUpdated"),su(P.fungibleKey,fe)},[Ae,w,fe]);let T=(0,$e.useMemo)(()=>ou(se),[se]),x=(0,$e.useCallback)(async()=>{await Promise.all([d(),me()])},[d,me]);return{fungibles:se,portfolio:T,visibilityOverrides:g,isHidingAllFungibles:xe,isLoadingTokens:m,isLoadingVisibilityOverrides:b,isLoadingPrices:n?G:!1,isRefetchingTokens:l,isRefetchingVisibilityOverrides:E,isRefetchingPrices:n?j:!1,isErrorTokens:p,tokensError:y,isErrorPrices:ie,refetch:x}}function of({key:t,splTokenAccount:e,...n}){let{fungibles:r,...o}=Ct({...n,keys:t?[t]:[]}),i;return r.length===1?i=r[0]:r.length>1&&e?i=r.find(s=>s.type==="SPL"&&s.data.splTokenAccountPubkey===e):r.length>1&&(i=r.filter(s=>s.type==="SPL").reduce((s,a)=>!s||a.data.balance.gt(s.data.balance)?a:s,void 0)),{fungible:i,...o}}c();u();var wn=M(B());c();u();c();u();c();u();var Qt=C(new ts);function ei(){return ei=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ei.apply(this,arguments)}f.NODE_ENV!=="production"&&(Qt.debugPrivate=!0);var sf=(t,e,n)=>t?.suspense&&af(e,n),af=(t,e)=>t.isPending&&!e,cf=({result:t,throwOnError:e,query:n})=>t.isError&&!t.isFetching&&uf(e,[t.error,n]);function uf(t,e){return typeof t=="function"?t(...e):!!t}var lf=t=>t.suspense&&typeof t.staleTime!="number"?ei({},t,{staleTime:1e3}):t;function cu(t,e,n=r=>r(Qt)){let r=C(0),o=C(n);f.NODE_ENV!=="production"&&(o.debugPrivate=!0);let i=C(()=>new WeakMap);f.NODE_ENV!=="production"&&(i.debugPrivate=!0);let s=C(l=>{let d=l(o),p=t(l),y=d.defaultQueryOptions(p),g=l(i).get(d);return y._optimisticResults="optimistic",g&&g.setOptions(y,{listeners:!1}),lf(y)});f.NODE_ENV!=="production"&&(s.debugPrivate=!0);let a=C(l=>{let d=l(o),p=l(s),y=l(i),g=y.get(d);if(g)return g;let b=new e(d,p);return y.set(d,b),b});f.NODE_ENV!=="production"&&(a.debugPrivate=!0);let m=C(l=>{let d=l(a),p=l(s),y=d.getOptimisticResult(p),g=C(y);return f.NODE_ENV!=="production"&&(g.debugPrivate=!0),g.onMount=b=>{let E=d.subscribe(Bn.batchCalls(b));return()=>{d.getCurrentResult().isError&&d.getCurrentQuery().reset(),E()}},g});return f.NODE_ENV!=="production"&&(m.debugPrivate=!0),C(l=>{l(r);let d=l(a),p=l(s),y=l(l(m));if(sf(p,y,!1))return d.fetchOptimistic(p);if(cf({result:y,query:d.getCurrentQuery(),throwOnError:p.throwOnError}))throw y.error;return y},(l,d)=>{d(r,p=>p+1)})}function lt(t,e=n=>n(Qt)){return cu(t,Zi,e)}function uu(t,e=n=>n(Qt)){return cu(t,es,e)}c();u();var gN=Symbol((import.meta.env?import.meta.env.MODE:void 0)!=="production"?"RESET":"");var ti=(t,e,n)=>(e.has(n)?e:e.set(n,t())).get(n),mf=new WeakMap,df=(t,e,n,r)=>{let o=ti(()=>new WeakMap,mf,e),i=ti(()=>new WeakMap,o,n);return ti(t,i,r)};function ve(t,e,n=Object.is){return df(()=>{let r=Symbol(),o=([s,a])=>{if(a===r)return e(s);let m=e(s,a);return n(a,m)?a:m},i=C(s=>{let a=s(i),m=s(t);return o([m,a])});return i.init=r,i},t,e,n)}var pf=t=>typeof t?.then=="function";function ff(t=()=>{try{return self.localStorage}catch(n){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof self<"u"&&console.warn(n);return}},e){var n;let r,o,i={getItem:(m,l)=>{var d,p;let y=b=>{if(b=b||"",r!==b){try{o=JSON.parse(b,e?.reviver)}catch{return l}r=b}return o},g=(p=(d=t())==null?void 0:d.getItem(m))!=null?p:null;return pf(g)?g.then(y):y(g)},setItem:(m,l)=>{var d;return(d=t())==null?void 0:d.setItem(m,JSON.stringify(l,e?.replacer))},removeItem:m=>{var l;return(l=t())==null?void 0:l.removeItem(m)}},s=m=>(l,d,p)=>m(l,y=>{let g;try{g=JSON.parse(y||"")}catch{g=p}d(g)}),a;try{a=(n=t())==null?void 0:n.subscribe}catch{}return!a&&typeof self<"u"&&typeof self.addEventListener=="function"&&self.Storage&&(a=(m,l)=>{if(!(t()instanceof self.Storage))return()=>{};let d=p=>{p.storageArea===t()&&p.key===m&&l(p.newValue)};return self.addEventListener("storage",d),()=>{self.removeEventListener("storage",d)}}),a&&(i.subscribe=s(a)),i}var bN=ff();c();u();c();u();c();u();var yf=t=>{let e=Jn(t);if(He(e))return e==="BitcoinNative",e;if(e==="SPL"&&t.resourceType==="address"||e==="ERC20"&&t.resourceType==="address")return t.address;if(e==="BRC20"&&t.resourceType==="address")return`${t.address}-${Ki[0]}`;if(e==="SuiCoin"&&t.resourceType==="address")return t.address},lu=yf;function hf({caip19:t,...e}){let n=Le(t);return{...e,type:t.includes("/nativeToken:")?"native":"fungible",chainName:A.getChainName(n.chainId).toLowerCase(),encodedCaip19:t,decodedCaip19:n,legacyKey:lu(n)??t}}var Kt=hf;var gf=h.object({account:h.string(),quantity:h.number(),quantityString:h.string()}),bn=h.object({address:h.string(),quantity:h.number(),quantityString:h.string(),lastTransferredDate:h.coerce.date().nullish(),subaccounts:h.array(gf).optional()}),Ht=h.object({price:h.number(),priceChange24h:h.number().optional(),lastUpdatedAt:h.coerce.date(),marketCap:h.number().optional()}).nullish(),mu=h.object({id:h.string(),name:h.string(),imageUri:h.string().nullish().transform(t=>t??""),numTokens:h.number()}),Cr=h.object({compression:h.object({compressed:h.boolean()}).optional(),creators:h.array(h.object({address:h.string(),share:h.number(),verified:h.boolean()})).nullish(),tokenProgram:h.string().nullish(),extensions:ia(sa).nullish()}),kr=h.enum(["TRUSTED","VERIFIED","NOT_VERIFIED","POSSIBLE_SPAM","SPAM"]),du=h.object({totalValueUsdCentsCurrent:h.number().optional(),totalValueUsdStringCurrent:h.string().optional(),totalValueUsdCents24h:h.number().optional(),totalValueUsdString24h:h.string().optional(),totalPercentChange24h:h.number().optional()}),pu=h.object({name:h.string().nullish(),symbol:h.string().nullish(),decimals:h.number(),logoUri:h.string().nullish(),extraMetadata:Cr.optional(),price:Ht}),ni=pu.extend({type:h.enum(["native","fungible"]),encodedCaip19:h.string(),decodedCaip19:Wi,spamStatus:kr,chainName:h.string(),legacyKey:h.string()}),bf=pu.extend({caip19:h.string(),spamStatus:kr.nullish().transform(t=>t??"NOT_VERIFIED")}),fu=h.union([bf.transform(t=>Kt(t)),ni]),yu=ni.extend({totalQuantity:h.number(),totalQuantityString:h.string(),walletAddress:h.string().optional(),queriedWalletBalances:h.array(bn),livePrice:Ht}),hu=ni.extend({timestamp:h.string().nullish(),totalQuantityString:h.string(),totalQuantity:h.number(),queriedWalletBalances:h.array(bn)});c();u();c();u();c();u();function _e(t){let e=C(0),n=C(()=>({i:0}),(m,l)=>{let d=m(n);return Object.assign(d,{m:!0,peek:m,set:l}),l(e,p=>p+1),()=>{d.m=!1,s(d),a(d)}});n.onMount=m=>m();let r=C(m=>{m(e);let l=m(n);if(!l.m||l.irc||l.i&&!l.irf)return l.p;a(l);let d=new Map,p=E=>{let S=m(E);return d.set(E,S),S};p.peek=l.peek;let y=(...E)=>{try{return++l.i,l.set(...E)}finally{Array.from(d.keys(),m),--l.i}};y.recurse=(E,...S)=>{if(l.fc){if(f.NODE_ENV!=="production")throw new Error("set.recurse is not allowed in cleanup");return}try{return l.irc=!0,l.set(E,...S)}finally{l.irc=!1,Array.from(d).some(g)&&i(l)}};function g([E,S]){return m(E)!==S}++l.i;function b(){try{if(l.irf=!1,!l.m)return;s(l),l.c=o.effect(p,y)}catch(E){l.e=E,i(l)}finally{l.p=void 0,--l.i}}return l.irf?b():l.p=Promise.resolve().then(b)});if(f.NODE_ENV!=="production"){let m=function(l,d){Object.defineProperty(l,"debugLabel",{get:()=>`${o.debugLabel??"effect"}:${d}`}),l.debugPrivate=!0};m(e,"refresh"),m(n,"ref"),m(r,"base")}let o=C(m=>void m(r));return o.effect=t,o;function i(m){try{m.irf=!0,m.set(e,l=>l+1)}finally{m.irf=!1}}function s(m){if(typeof m.c=="function")try{m.fc=!0,m.c()}finally{m.fc=!1,m.c=void 0}}function a(m){if("e"in m){let l=m.e;throw delete m.e,l}}}c();u();var Tf=()=>{try{return typeof chrome<"u"&&(chrome.runtime?.id!==void 0||typeof browser<"u")}catch(t){return console.error("Error checking for extension context:",t),!1}},ri=class{browser;storage;constructor(e){if(!e||!e.storage||!e.storage.local)throw new Error("[ExtensionStorage] Invalid 'browser' object received.");this.browser=e,this.storage=this.browser.storage.local}async get(e){try{let r=(await this.storage.get(e))[e];return r==null||typeof r!="string"?null:JSON.parse(r)}catch(n){return console.error(`[ExtensionStorage.get] Error getting/parsing key (${e}):`,n),null}}async getAll(e){try{let n=await this.storage.get(e),r={};for(let o in n)if(Object.prototype.hasOwnProperty.call(n,o)){let i=n[o];if(i==null||typeof i!="string")r[o]=null;else try{r[o]=JSON.parse(i)}catch(s){console.error(`[ExtensionStorage.getAll] Error parsing key (${o}):`,s),r[o]=null}}return r}catch(n){let r=`[ExtensionStorage.getAll] Error getting keys (${e}): ${n}`;throw console.error(r),new Error(r)}}async remove(e){try{await this.storage.remove(e)}catch(n){let r=`[ExtensionStorage.remove] Error removing key(s) (${e}): ${n}`;throw console.error(r),new Error(r)}}async set(e,n){try{let r=JSON.stringify(n);await this.storage.set({[e]:r})}catch(r){let o=`[ExtensionStorage.set] Error setting/stringifying key (${e}): ${r}`;throw console.error(o),new Error(o)}}async setAll(e){try{let n={};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=JSON.stringify(e[r]));await this.storage.set(n)}catch(n){let o=`[ExtensionStorage.setAll] Error setting/stringifying keys (${Object.keys(e)}): ${n}`;throw console.error(o),new Error(o)}}async update(e,n){if(!navigator.locks){let r=await this.get(e),o=await n(r);o===null?await this.remove(e):await this.set(e,o);return}try{await navigator.locks.request(`storage.${e}`,async r=>{let o=await this.get(e),i=await n(o);i===null?await this.remove(e):await this.set(e,i)})}catch(r){let o=`[ExtensionStorage.update] Error updating key (${e}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{await this.storage.clear()}catch(e){let n=`[ExtensionStorage.clear] Error clearing storage: ${e}`;throw console.error(n),new Error(n)}}},xr=class{storage=self.localStorage;async get(e){try{let n=this.storage.getItem(e);return n===null||typeof n!="string"?null:JSON.parse(n)}catch(n){return console.error(`[WebLocalStorage.get] Error getting/parsing key (${e}):`,n),null}}async getAll(e){let n={},r=e??Object.keys(this.storage);for(let o of r)try{let i=this.storage.getItem(o);if(e&&i===null)continue;if(i===null||typeof i!="string")n[o]=null;else try{n[o]=JSON.parse(i)}catch(s){console.error(`[WebLocalStorage.getAll] Error parsing key (${o}):`,s),n[o]=null}}catch(i){console.error(`[WebLocalStorage.getAll] Error reading key (${o}) from storage:`,i),e||(n[o]=null)}return n}async remove(e){try{let n=Array.isArray(e)?e:[e];for(let r of n)this.storage.removeItem(r)}catch(n){let r=`[WebLocalStorage.remove] Error removing key(s) (${e}): ${n}`;throw console.error(r),new Error(r)}}async set(e,n){try{let r=JSON.stringify(n);this.storage.setItem(e,r)}catch(r){let o=`[WebLocalStorage.set] Error setting/stringifying key (${e}): ${r}`;throw console.error(o),new Error(o)}}async setAll(e){let n=!1,r=Object.keys(e);for(let o in e)if(Object.prototype.hasOwnProperty.call(e,o))try{await this.set(o,e[o])}catch{n=!0}if(n)throw new Error(`[WebLocalStorage.setAll] One or more errors occurred while setting keys (${r})`)}async update(e,n){if(!navigator.locks){let r=await this.get(e),o=await n(r);o===null?await this.remove(e):await this.set(e,o);return}try{await navigator.locks.request(`storage.${e}`,async r=>{let o=await this.get(e),i=await n(o);i===null?await this.remove(e):await this.set(e,i)})}catch(r){let o=`[WebLocalStorage.update] Error updating key (${e}): ${r}`;throw console.error(o),new Error(o)}}async clear(){try{this.storage.clear()}catch(e){let n=`[WebLocalStorage.clear] Error clearing storage: ${e}`;throw console.error(n),new Error(n)}}},oi=class{initPromise;storageImpl=null;constructor(){this.initPromise=this._initialize(),this.initPromise.catch(e=>{console.error("LocalStorage initialization failed:",e)})}async _initialize(){if(!this.storageImpl)if(Tf())try{let n=(await import("./browser-polyfill-M3TN2YKD.js")).default;if(!n||!n.storage||!n.storage.local)throw new Error("webextension-polyfill loaded but missing storage.local API.");this.storageImpl=new ri(n)}catch{this.storageImpl=new xr}else this.storageImpl=new xr}async ensureInitialized(){if(await this.initPromise,!this.storageImpl)throw new Error("LocalStorage is not initialized. Initialization may have failed.")}async get(e){return await this.ensureInitialized(),this.storageImpl.get(e)}async getAll(e){return await this.ensureInitialized(),this.storageImpl.getAll(e)}async remove(e){return await this.ensureInitialized(),this.storageImpl.remove(e)}async set(e,n){return await this.ensureInitialized(),this.storageImpl.set(e,n)}async setAll(e){return await this.ensureInitialized(),this.storageImpl.setAll(e)}async update(e,n){return await this.ensureInitialized(),this.storageImpl.update(e,n)}async clear(){return await this.ensureInitialized(),this.storageImpl.clear()}},ii=new oi;c();u();c();u();var Tn=class{namespaceKey;ttlMilliseconds;storage;onError;data={};isLoaded=!1;constructor(e){this.namespaceKey=e.namespaceKey,this.ttlMilliseconds=e.ttlMilliseconds,this.storage=e.storage,this.onError=e.onError,this._load().then(()=>{if(this._cleanupExpired())return this._save()}).catch(n=>{console.error("Failed to load data",n)})}async _load(){if(!this.isLoaded){try{let e=await this.storage.get(this.namespaceKey);e?(this.data=e,(typeof this.data!="object"||this.data===null)&&(this.onError?.(new Error("Stored data is not a valid object."),"load"),this.data={})):this.data={}}catch(e){this.onError?.(e instanceof Error?e:new Error("Failed to parse stored data"),"load"),this.data={}}this.isLoaded=!0}}async _save(){try{await this.storage.set(this.namespaceKey,this.data)}catch(e){this.onError?.(e instanceof Error?e:new Error("Failed to serialize data for storage"),"save")}}_cleanupExpired(){let e=Date.now(),n=!1;for(let r in this.data)Object.prototype.hasOwnProperty.call(this.data,r)&&this.data[r].expiresAt<=e&&(delete this.data[r],n=!0);return n}_updateExpiration(e){return this.data[e]?(this.data[e].expiresAt=Date.now()+this.ttlMilliseconds,!0):!1}async set(e,n){this.isLoaded||await this._load(),this._cleanupExpired(),this.data[e]={value:n,expiresAt:Date.now()+this.ttlMilliseconds},await this._save()}async get(e,n){this.isLoaded||await this._load();let r=this._cleanupExpired(),o=this.data[e];if(!o)return r&&await this._save(),null;let i=this._updateExpiration(e),s=n.safeParse(o.value);return s.success?((r||i)&&await this._save(),s.data):(this.onError?.(new ot(s.error.issues),`get (validation failed for key: ${e})`),delete this.data[e],await this._save(),null)}async remove(e){let n=this._cleanupExpired(),r=!1;Object.prototype.hasOwnProperty.call(this.data,e)&&(delete this.data[e],r=!0),(n||r)&&await this._save()}async clear(){this.data={},await this._save()}};var gu=new Map;function vf({storage:t,namespaceKey:e,ttlMs:n}){let r=gu.get(e);if(r)return r;if(!t)throw new Error("Storage is required");let o=new Tn({storage:t,namespaceKey:e,ttlMilliseconds:n,onError:(i,s)=>{console.error(`[PersistentStore Error - ${s}]:`,i.message),i instanceof ot&&console.error("Zod Issues:",i.issues)}});return gu.set(e,o),o}var si=vf;function Ef({atomToStoreOffline:t,namespaceKey:e,ttlMs:n,initialValue:r,schema:o,...i}){let s=C({status:"pending",value:r}),a=C(p=>{if("offlineKey"in i)return p(i.offlineKey);let y=p(t);if("offlineKey"in y&&typeof y.offlineKey=="string")return y.offlineKey;throw new Error("No key provided")}),m=_e((p,y)=>{si({storage:ii,namespaceKey:`.offline.${e}`,ttlMs:n}).get(p(a),o).then(g=>{g&&y(s,{status:"offline",value:g})}).catch(g=>{console.error(g)})}),l=_e((p,y)=>{p(a),y(s,{status:"pending",value:r})}),d=_e((p,y)=>{let g=p(t),b=p(a);g.status==="success"&&g.data&&g.data!==p(s).value&&(y(s,{status:"live",value:g.data}),si({storage:ii,namespaceKey:`.offline.${e}`,ttlMs:n}).set(b,g.data).catch(E=>{_.addBreadcrumb("tokens","Error storing offline data","error",{namespaceKey:e,error:E.toString()})}))});return ve(C(p=>{let y=p(t);p(l),p(m),p(d);let g=p(s);return y.data?{status:"live",value:y.data}:{status:"offline",value:g.value}}),p=>p.value)}var qt=Ef;c();u();c();u();var ai=h.object({caip19:h.string(),name:h.string().nullish(),symbol:h.string().nullish(),decimals:h.number(),spamStatus:kr.nullish().transform(t=>t??"NOT_VERIFIED"),logoUri:h.string().nullish()}),bu=ai.extend({totalQuantity:h.number(),totalQuantityString:h.string(),queriedWalletBalances:h.array(bn),extraMetadata:Cr.optional(),price:Ht}),Tu=bu.transform(Kt),vu=h.object({items:h.array(bu),cursor:h.string().nullish().default(null),errors:h.array(h.object({code:h.string(),message:h.string(),details:h.object({chainId:h.string(),address:h.string()})})).optional()}).transform(t=>{let{items:e,cursor:n,errors:r,...o}=t;return{...o,nextCursor:n,tokens:e,errors:r||[],updatedAt:Date.now()}}),Eu=ai.extend({timestamp:h.string().nullish(),postQuantityString:h.string(),postQuantity:h.number(),price:Ht,queriedWalletBalances:h.array(bn)}),wu=Eu.transform(t=>{let{postQuantity:e,postQuantityString:n,...r}=Kt(t);return{...r,totalQuantity:e,totalQuantityString:n}}),Au=h.object({cursor:h.string().nullish().default(null),items:h.array(Eu)}).transform(t=>({nextCursor:t.cursor,transfers:t.items})),Su=h.object({totalValueUsdCentsCurrent:h.number(),totalValueUsdStringCurrent:h.string(),totalValueUsdCents24h:h.number(),totalValueUsdString24h:h.string(),totalPercentChange24h:h.number(),errors:h.array(h.object({code:h.string(),message:h.string(),details:h.object({chainId:h.string(),address:h.string()})})).optional()}),ci=ai.extend({createdDate:h.coerce.date().nullish().default(null),extraMetadata:Cr.extend({id:h.string().nullish().default(null),description:h.string().nullish().default(null),marketCap:h.coerce.number().optional(),circulatingSupply:h.coerce.number().optional(),totalSupply:h.coerce.number().optional(),liquidity:h.coerce.number().optional(),holders:h.coerce.number().optional(),links:h.array(h.object({type:h.string(),url:h.string()})).optional(),volume24hUSD:h.coerce.number().optional(),volume24hUSDChangePercentage:h.coerce.number().optional(),trades24h:h.coerce.number().optional(),trades24hChangePercentage:h.coerce.number().optional(),uniqueWallets24h:h.coerce.number().optional(),uniqueWallets24hChangePercentage:h.coerce.number().optional(),top10HoldersPercent:h.coerce.number().optional(),mintable:h.boolean().optional(),freezable:h.boolean().optional(),mutableMetadata:h.boolean().optional(),ownershipRenounced:h.boolean().optional(),updateAuthority:h.string().optional(),createdDate:h.string().datetime().nullish().default(null)}).optional(),categories:h.array(mu).optional().default([]),price:Ht}),Pu=ci.transform(Kt);c();u();var wf=t=>A.isBitcoinNetworkID(t.decodedCaip19.chainId)&&t.decodedCaip19.resourceType==="nativeToken"?t.queriedWalletBalances.map(r=>{let o=ra(t.decodedCaip19.chainId,r.address);if(!o)throw new Error("No legacy key found for bitcoin native token");return{...t,legacyKey:o,queriedWalletBalances:[r],totalQuantity:r.quantity,totalQuantityString:r.quantityString,walletAddress:r.address}}):[t],Af=t=>e=>e.map(n=>t.parse(n)),x_=Af(fu),Sf=t=>e=>e.flatMap(n=>{let r=t.parse(n);return wf(r)}),Cu=Sf(Tu),Pf=t=>e=>e.map(n=>t.parse(n)),ku=Pf(wu);async function Cf(t){let e={walletAddresses:t.walletCaip19s.join(","),includePrices:"true"};"cursor"in t&&(e.cursor=t.cursor),"fromMicroseconds"in t?e.fromTimestamp=t.fromMicroseconds.toString():"from"in t&&(e.fromTimestamp=t.from.toString());let n=await $.api().timeout(v({seconds:30})).get("/portfolio/v1/fungibles/updates",{params:e}).then(r=>{if(Pe(r))return r.data;throw new Error(r.data?.message||r.data?.error||r.statusText||`Status: ${r.status}`,{cause:r.data?.code??r.data?.name})}).catch(r=>{throw _.addBreadcrumb("tokens","getTokenBalanceUpdates","error",{message:r.message,cause:r.cause,...e}),_.captureError(r,"tokens"),r});try{return Au.parse(n)}catch(r){throw r instanceof ot&&_.addBreadcrumb("tokens","getTokenBalanceUpdates parse error","error",{message:r.message,...r.issues?{issues:JSON.stringify(r.issues)}:{},result:JSON.stringify(n)}),r}}async function xu(t){let e=[],n=()=>e.at(-1)?.nextCursor;do{let r=n(),o=await Cf(r?{walletCaip19s:t.walletCaip19s,cursor:r}:t);e.push(o)}while(n());return ku(e.flatMap(r=>r.transfers))}c();u();c();u();function kf(t){let e=Jn(t.decodedCaip19);return e==="SPL"?t.extraMetadata?.compression?.compressed||"queriedWalletBalances"in t&&t.queriedWalletBalances.some(n=>!n.subaccounts?.length)?"CompressedSPL":"SPL":e}var Iu=kf;function ui({newUpdates:t,existingUpdates:e={}}){return t.reduce((n,r)=>n[r.encodedCaip19]?.totalQuantityString===r.totalQuantityString?n:Iu(r)==="CompressedSPL"?{...n,[`${r.encodedCaip19}-compressed`]:r}:r?{...n,[r.encodedCaip19]:r}:n,e)}c();u();function xf(t){let e=t.match(/(.*\d{2}:\d{2}:\d{2})\.(?<fraction>\d+)Z/);if(!e||!e.groups?.fraction)throw new Error("Invalid date format");let n=new Date(t).getTime(),i=e.groups.fraction.padEnd(6,"0").slice(-3);return n*1e3+parseInt(i,10)}var li=xf;c();u();var If=C(!1),Ir=If;c();u();c();u();c();u();var Df=v({minutes:5}),vn=0;function Du(){if(!vn){vn=Math.floor(Math.random()*1e6);return}vn++}async function mi({walletCaip19s:t,fungibleCaip19s:e,cursor:n,cacheBust:r}){let o={walletAddresses:t.join(","),includePrices:"true"};n&&(o.cursor=n),(r||vn)&&(o.cacheBust=r?.toString()||vn.toString()),e&&e.length>0&&(o.fungibleAddresses=e.sort().join(","));try{let i=await $.api().timeout(v({seconds:30})).get("/portfolio/v1/fungibles/balances",{params:o}).then(a=>{if(Pe(a))return a.data;throw new Error(a.data?.message||a.data?.error||a.statusText||`Status: ${a.status}`,{cause:a.data?.code})}),s=vu.parse(i);return s.errors&&s.errors.length>0&&s.errors.forEach(a=>{_.addBreadcrumb("tokens","getTokenBalances_partialError","info",{code:a.code,message:a.message,chainId:a.details.chainId,address:a.details.address})}),{...s,tokens:Cu(s.tokens)}}catch(i){throw i instanceof Error&&(_.addBreadcrumb("tokens","getTokenBalances","error",{...o,message:i.message,...typeof i.cause=="string"||typeof i.cause=="number"?{cause:i.cause}:{}}),_.captureError(i,"tokens")),i}}function Nu({walletCaip19s:t,isEnabled:e=!0,cacheBust:n}){return{staleTime:Df,gcTime:v({days:3}),queryKey:be.infiniteTokenBalances({walletCaip19s:t}),enabled:e&&!!t.length,queryFn:async({pageParam:r})=>mi({walletCaip19s:t,cursor:r,cacheBust:n}),initialPageParam:"",getNextPageParam:r=>r?.nextCursor||void 0}}function _u(t){let{walletCaip19s:e,encodedCaip19:n,queryOptions:r={enabled:!0}}=t;return{staleTime:v({seconds:10}),gcTime:v({days:3}),queryKey:be.tokenBalance({wallets:e,encodedCaip19:n}),enabled:r.enabled&&!!e.length,queryFn:async()=>(await mi({walletCaip19s:e,fungibleCaip19s:[n]})).tokens}}c();u();c();u();var Nf=C(void 0),Dr=Nf;var _f=C(t=>{let e=t(Dr);return e?e.addresses.map(n=>J({chainId:n.networkID,address:n.address,resourceType:"address"})).sort():[]}),mt=_f;var Of=uu(t=>{let e=t(mt);return Nu({walletCaip19s:e})}),Ee=Of;var Mf=C(t=>{let{data:e}=t(Ee),n=e?.pages[0];return!n||!n.tokens.length?0:n.updatedAt}),Ou=Mf;c();u();var Ff=ve(Dr,t=>t?.identifier),Ye=Ff;var Rf=1e3,Mu=5e3,Fu=Math.ceil(Mu*2.25);function Ru(t){return v(t)*1e3}function Uf(t){if(!t?.length)return null;let e=new Date(Date.now()-Fu).toISOString();return Math.floor(Math.max(...t.map(({timestamp:n})=>li(n||e))))}function Bf(t){let e=Uf(t);return e?e-Ru({seconds:1}):null}var di=lt(t=>{let e=t(Qt),n=t(Ou),r=Math.floor(n-v({minutes:10})),o=t(mt),i=t(Ir),s=r>Date.now()-v({days:10}),a=be.tokenUpdates({walletCaip19s:o,from:r}),m=async()=>{let l=e.getQueryData(a)?.lastTimestamp;if(!l){let g=new Date(r-Fu).toISOString();return{updates:{},lastTimestamp:li(g)}}let d=await xu({walletCaip19s:o,fromMicroseconds:l-Ru({seconds:30})}),p=e.getQueryData(a)?.updates??{};return{updates:ui({newUpdates:d,existingUpdates:p}),lastTimestamp:Math.max(Bf(d)??0,l)}};return{meta:{fetchCount:0},enabled:s&&!i&&o.length>0,queryKey:a,refetchInterval:l=>{let d=Number(l.meta?.fetchCount??0);return l.meta&&(l.meta.fetchCount=d+1),Math.min(Math.max(d*250,Rf),Mu)},queryFn:m}}),Lf=qt({atomToStoreOffline:di,offlineKey:C(t=>`${t(Ye)??""}:token-balance-updates`),namespaceKey:"fungible-tokens",ttlMs:v({days:10}),initialValue:{updates:{},lastTimestamp:0},schema:h.object({updates:h.record(h.string(),hu),lastTimestamp:h.number()})}),Vf=ve(Lf,t=>t?.updates??{},(t,e)=>JSON.stringify(t)===JSON.stringify(e)),Nr=Vf;c();u();c();u();function _r(t){return e=>{let n=!1,r={...e};for(let[o,i]of Object.entries(t)){let s=i?.price,a=i?.lastUpdatedAt?new Date(i.lastUpdatedAt):null;if(!s||!a)continue;let m=e[o]?.price!==s&&(!e[o]?.lastUpdatedAt||a>e[o].lastUpdatedAt);n=n||m,m&&(r[o]={price:i.price,priceChange24h:i.priceChange24h,lastUpdatedAt:a})}return n?r:e}}c();u();var Gf=C(t=>{let{data:e,status:n}=t(Ee);return{data:e?.pages.flatMap(r=>r.tokens),status:n}}),Qf=qt({atomToStoreOffline:Gf,offlineKey:C(t=>`${t(Ye)??""}:infinite-tokens`),namespaceKey:"fungible-tokens",ttlMs:v({days:10}),initialValue:[],schema:h.array(yu)}),dt=Qf;var Or=C({}),Kf=C(t=>t(dt).slice(-100).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})),Hf=_e((t,e)=>{let n=t(Kf);!n||Object.keys(n).length===0||e(Or,_r(n))}),qf=C(t=>{let e=t(Nr);return Object.values(e).reduce((r,o)=>(o.price&&(r[o.encodedCaip19]=o.price),r),{})}),jf=_e((t,e)=>{let n=t(qf);!n||Object.keys(n).length===0||e(Or,_r(n))}),Wf=C(t=>(t(Hf),t(jf),t(Or)),(t,e,n)=>{e(Or,n)}),Xe=Wf;c();u();c();u();var zf=ve(Ee,t=>t.hasNextPage),pt=zf;var En=C(1/0),Mr=C(t=>(t($f),t(Yf),t(pt)?t(En):0),(t,e,n)=>{if(n===null){e(En,1/0);return}let r=Math.min(t(En),n);r!==t(En)&&e(En,r)}),Uu=Mr,$f=_e((t,e)=>{let{hasNextPage:n}=t(Ee),r=t(dt),o=t(Xe);if(r.length>0&&!n){e(Mr,0);return}let i=r.slice(-100).filter(s=>s.type==="fungible").map(s=>{let a=o[s.encodedCaip19]??s.price;return a?s.totalQuantity*a.price/10**s.decimals:1/0});e(Mr,Math.min(...i))}),Yf=_e((t,e)=>{t(Ye)&&e(Mr,1/0)});function Xf(t,e){if(t.type==="native"&&e.type!=="native")return-1;if(t.type!=="native"&&e.type==="native")return 1;if(t.type==="native"&&e.type==="native")return t.name&&e.name?t.name.localeCompare(e.name):0}function Jf(t,e){if(!t&&e)return 1;if(t&&!e)return-1}function Bu(t,e){if(t&&e)return t.localeCompare(e);if(t&&!e)return-1;if(!t&&e)return 1}function Lu(t,e){if(t!==e)return e-t}function Zf(t){return{totalQuantity:t.totalQuantity,totalQuantityString:t.totalQuantityString}}var ey=C(t=>{let e=t(dt),n=t(Nr),r=new Set(Object.keys(n));if(e.length===0)return[];let o=e.map(i=>{let s=i.extraMetadata?.compression?.compressed?`${i.encodedCaip19}-compressed`:i.encodedCaip19,a=n[s];return a?(r.delete(s),{...i,...Zf(a)}):i});return r.forEach(i=>{let s=n[i];s&&o.push(s)}),o}),ty=C(t=>{let e=t(Xe),n=t(ey),r=t(Uu),o=n.filter(i=>i.totalQuantity>0||i.type==="native").map(i=>({...i,livePrice:e[i.encodedCaip19]??i.price})).sort((i,s)=>{let a=i.livePrice?.price,m=s.livePrice?.price,l=Jf(a,m);if(l)return l;let d=i.totalQuantity/10**i.decimals,p=s.totalQuantity/10**s.decimals;if(!a&&!m){let E=Xf(i,s);if(E)return E;let S=Lu(d,p);if(S)return S;let N=Bu(i.name,s.name);return N||0}let y=(a??0)*d,g=(m??0)*p,b=Lu(y,g);return b||(Bu(i.name,s.name)??0)});return r?o.filter(i=>{let s=i.livePrice?.price,a=i.totalQuantity/10**i.decimals;return(s??0)*a>=r}):o}),Je=ty;c();u();function ny(t){if(t)return typeof t=="string"||typeof t=="number"?new Date(t):t}function ry(t,{key:e,newPriceData:n}){let r=t[e];if(!n||r?.price===n?.price)return t;let o=ny(n.lastUpdatedAt);return!o||!(!r?.lastUpdatedAt||o>r.lastUpdatedAt)?t:{...t,[e]:{price:n.price,priceChange24h:n.priceChange24h??n.usd_24h_change,lastUpdatedAt:o}}}var Fr=ry;var oy=(t,e,n)=>{let r=t.extraMetadata?.compression?.compressed,o=e.extraMetadata?.compression?.compressed;if(r!==o)return n?r?-1:1:r?1:-1},iy=(t,e,n)=>{let r=t.legacyKey===n,o=e.legacyKey===n;if(r!==o)return r?-1:1},sy=({isSplCompressed:t,legacyKey:e},n)=>n.length?n.length===1?n[0]:[...n].sort((o,i)=>{if(t!==void 0&&(o.encodedCaip19.includes("solana:")||i.encodedCaip19.includes("solana:"))){let s=oy(o,i,t);if(s)return s}if(e){let s=iy(o,i,e);if(s)return s}return i.totalQuantity-o.totalQuantity})[0]:null,Rr=t=>{let e=he(mt),n=he(Je),r=(0,wn.useMemo)(()=>n.filter(a=>a.encodedCaip19===t.encodedCaip19&&(!t.legacyKey||a.legacyKey===t.legacyKey)),[t.encodedCaip19,t.legacyKey]),o=_u({...t,walletCaip19s:e});o.refetchInterval||(o.refetchInterval=v({seconds:3}));let i=I({...o,select:a=>sy(t,a),placeholderData:r}),s=rn(Xe);return(0,wn.useEffect)(()=>{let a=i.data;a&&!i.isPlaceholderData&&a.price&&s(m=>{let l=a.encodedCaip19,d=a.price;return Fr(m,{key:l,newPriceData:d})})},[i.data,i.isPlaceholderData,s]),i},Ur=({networkID:t,queryOptions:e,addressType:n})=>{let r={chainId:t,slip44:A.getSlip44(t),resourceType:"nativeToken"},o=na(t,n),i=J(r);return Rr({encodedCaip19:i,legacyKey:o,queryOptions:e})},ay=()=>{let{data:t}=Fe(),e=(0,wn.useMemo)(()=>t?.addresses.find(n=>A.isSolanaNetworkID(n.networkID)),[t]);return Ur({networkID:e?.networkID||"solana:101",addressType:e?.addressType})};c();u();c();u();c();u();c();u();function pi(t,e){return{gcTime:Rt.Long,staleTime:1/0,enabled:!!e&&!!t,queryKey:be.visibilityOverrides({accountId:e??""}),async queryFn(){return!e||!t?new Map:await er(t,e)}}}c();u();var cy=C(null),Br=cy;var uy=new Map,Vu=lt(t=>{let e=t(Br),n=t(Ye);return pi(e,n)}),Gu=ve(Vu,t=>t.status),ly=C(t=>t(Vu).data??uy),ft=ly;var my=C(t=>{let{isLoading:e}=t(Ee),n=t(dt),r=t(Gu);return e&&n.length===0||r==="pending"}),An=ve(my,t=>t);function Qu(){let t=he(Je),e=he(An),n=he(pt),r=he(ft);return{isLoading:e,hasNextPage:n,fungibleTokens:t,visibilityOverrides:r}}c();u();c();u();var Ku=M(B());var dy=({wallets:t,encodedCaip19:e,isSplCompressed:n=!1})=>{let r=W();return(0,Ku.useCallback)(()=>void r.invalidateQueries({queryKey:be.tokenBalance({wallets:t,encodedCaip19:e,isSplCompressed:n})}),[r,t,e,n])},py=dy;c();u();function Hu({tokens:t}){return Et({tokens:t}).catch(e=>{throw _.addBreadcrumb("tokens","getTokenPrices","error",{message:e.message,cause:e.cause,tokens:t.map(J).join(",")}),_.captureError(e,"tokens"),e})}c();u();c();u();var fy=C(t=>{let e=t(ft);return t(Je).filter(r=>Tt(e??new Map,{key:r.legacyKey??"",spamStatus:r.spamStatus}))}),jt=fy;function qu(){let t=he(jt),e=he(An),n=he(pt),r=he(ft);return{isLoading:e,hasNextPage:n,fungibleTokens:t,visibilityOverrides:r}}c();u();var Sn=M(B());c();u();c();u();function yy(t){let e={message:"Failed to parse token details response"};if(t instanceof ot)try{e.zodIssuesJson=JSON.stringify(t.issues.map(n=>({path:n.path.join("."),message:n.message,code:n.code})))}catch{e.zodIssuesJson="Failed to stringify Zod issues"}else e.errorMessage=t instanceof Error?t.message:String(t);return e}var ju=yy;function Wu(t){return t.resourceType==="nativeToken"?`/fungibles/v1/${t.chainId}/${t.resourceType}/${t.slip44}`:`/fungibles/v1/${t.chainId}/${t.resourceType}/${t.address}`}function hy(t){return Wu(Le(t))}function gy(t){let e=new URLSearchParams,n="encodedCaip19"in t?hy(t.encodedCaip19):Wu(t.decodedCaip19);return t.includePrice&&e.append("includePrice","true"),t.includeFungibleDetails&&e.append("includeFungibleDetails","true"),[n,{params:e}]}async function fi(t){let e=await $.api().timeout(v({seconds:10})).get(...gy(t)).then(n=>{if(Pe(n))return n.data;throw new Error(n.data?.message||n.data?.error||n.statusText||`Status: ${n.status}`,{cause:n.data?.code})}).catch(n=>{throw _.addBreadcrumb("tokens","getTokenDetails","error",{message:n.message,cause:n.cause,..."encodedCaip19"in t&&{caip19:t.encodedCaip19},..."decodedCaip19"in t&&{caip19:J(t.decodedCaip19)}}),_.captureError(n,"tokens"),n});try{return ci.parse(e)}catch(n){console.error(n);let r=ju(n);throw"encodedCaip19"in t&&typeof t.encodedCaip19=="string"?r.caip19=t.encodedCaip19:"decodedCaip19"in t&&(r.caip19=J(t.decodedCaip19)),_.addBreadcrumb("tokens","getTokenDetails.ParseError","error",r),n}}function by({caip19:t,includePrice:e}){let n=(0,Sn.useMemo)(()=>typeof t=="string"?t:J(t),[t]),r=he(Je),o=(0,Sn.useMemo)(()=>{let a=r.find(m=>m.encodedCaip19===n);return a?{chainName:a.chainName,encodedCaip19:n,decodedCaip19:a.decodedCaip19,type:a.type,categories:[],price:a.price,symbol:a.symbol??"",name:a.name??"",decimals:a.decimals,legacyKey:a.legacyKey??n,spamStatus:a.spamStatus??"NOT_VERIFIED",logoUri:a.logoUri??null,extraMetadata:{description:"",id:"",isMutable:!0,createdDate:null,...a.extraMetadata},createdDate:null}:null},[n,e]),i=I({refetchInterval:v({seconds:e?5:30}),queryKey:be.tokenDetails({caip19:n,includePrice:e}),queryFn:async()=>{let a=await fi(typeof t=="string"?{encodedCaip19:t,includeFungibleDetails:!0,includePrice:e}:{decodedCaip19:t,includeFungibleDetails:!0,includePrice:e});return Pu.parse(a)},...o&&{placeholderData:o}}),s=rn(Xe);return(0,Sn.useEffect)(()=>{let a=i.data;a&&!i.isPlaceholderData&&e&&a.price&&s(m=>{let l=a.encodedCaip19,d=a.price;return Fr(m,{key:l,newPriceData:d})})},[i.data,i.isPlaceholderData,s,e]),i}var yi=by;c();u();var Fy=M(B());c();u();c();u();c();u();function Wt(t){return BigInt(Math.round(t*1e18))}function hi(t){return Number(t)/1e18}function Lr(t,e){return hi(Wt(t)+Wt(e))}function kt(t,e){return hi(Wt(t)-Wt(e))}function Pn(t,e){return hi(Wt(t)*BigInt(1e18)/Wt(e))}function Ty(t,e){if(e===-100)return-1*t;let n=Pn(t,1+e/100);return kt(t,n)}var zu=Ty;c();u();function vy(t,e){return kt(e,t)===0?0:t/kt(e,t)*100}var $u=vy;c();u();function gi(t,e){return e*Number(t.totalQuantity)/10**t.decimals}c();u();c();u();async function bi({walletCaip19s:t,includeFungibleCaip19s:e,excludeFungibleCaip19s:n}){let r=await $.api().timeout(v({seconds:10})).get("/portfolio/v1/fungibles/value",{params:{walletAddresses:t.join(","),...e.length>0&&{includeFungibleCaip19s:e.join(",")},...n.length>0&&{excludeFungibleCaip19s:n.join(",")}}}).then(i=>{if(Pe(i))return i.data;throw new Error(i.data?.message||i.data?.error||i.statusText||`Status: ${i.status}`,{cause:i.data?.code})}).catch(i=>{throw _.addBreadcrumb("tokens","getPortfolioValue","error",{message:i.message,cause:i.cause,walletCaip19s:t.join(","),...e.length>0&&{includeFungibleCaip19s:e.join(",")},...n.length>0&&{excludeFungibleCaip19s:n.join(",")}}),_.captureError(i,"tokens"),i}),o=Su.parse(r);return o.errors&&o.errors.length>0&&o.errors.forEach(i=>{_.addBreadcrumb("tokens","getPortfolioValue_partialError","info",{code:i.code,message:i.message,chainId:i.details.chainId,address:i.details.address})}),o}c();u();var Ey=lt(t=>{let e=t(Br);return e?is(e):{queryKey:["default-mainnet"],queryFn:()=>({isDeveloperMode:!1})}}),wy=C(t=>!t(Ey).data?.isDeveloperMode),zt=wy;var Ay=1e3,Sy=5e3,Py=ve(C(t=>{let e=t(ft),r=t(Je).reduce((o,i)=>{let s=Tt(void 0,{key:i.legacyKey??"",spamStatus:i.spamStatus??"NOT_VERIFIED"}),a=Tt(e,{key:i.legacyKey??"",spamStatus:i.spamStatus??"NOT_VERIFIED"});return s===a?o:s?{...o,exclude:[...o.exclude,i.encodedCaip19]}:{...o,include:[...o.include,i.encodedCaip19]}},{include:[],exclude:[]});return{include:r.include.sort().slice(0,50),exclude:r.exclude.sort().slice(0,50)}}),t=>t,(t,e)=>t.include.join(",")===e.include.join(",")&&t.exclude.join(",")===e.exclude.join(",")),Cy=lt(t=>{let e=t(mt),{include:n,exclude:r}=t(Py),o=t(Ir),i=t(zt),s=be.portfolioValue({walletCaip19s:e,include:n,exclude:r,isMainnet:i});return{enabled:e.length>0&&!o&&i,queryKey:s,meta:{fetchCount:0},refetchInterval:m=>{let l=Number(m.meta?.fetchCount??0);return m.meta&&(m.meta.fetchCount=l+1),Math.min(Math.max(l*250,Ay),Sy)},queryFn:async()=>bi({walletCaip19s:e,includeFungibleCaip19s:n,excludeFungibleCaip19s:r})}}),Cn=Cy;var Yu=C(t=>{let e=t(jt),n=!1,r=e.reduce((o,i)=>{let s=i.livePrice?.price??i.price?.price,a=i.livePrice?.priceChange24h??i.price?.priceChange24h;s&&(n=!0);let m=gi(i,s??0),l=zu(m,a??0);return{currentValue:Lr(o.currentValue,m),priceDifference:Lr(o.priceDifference,l)}},{currentValue:0,priceDifference:0});return n?{currentValue:r.currentValue,priceDifference:r.priceDifference,totalPercentChange24h:$u(r.priceDifference,r.currentValue)}:{currentValue:void 0,priceDifference:void 0,totalPercentChange24h:void 0}}),ky=qt({atomToStoreOffline:Cn,offlineKey:C(t=>`${t(Ye)??""}:portfolio-value`),namespaceKey:"fungible-tokens",ttlMs:v({days:10}),initialValue:{totalValueUsdCentsCurrent:void 0,totalValueUsdStringCurrent:void 0,totalValueUsdCents24h:void 0,totalValueUsdString24h:void 0,totalPercentChange24h:void 0},schema:du}),Xu=C(t=>{let e=t(ky),n=e?.totalPercentChange24h,r=e?.totalValueUsdCents24h,o=e?.totalValueUsdCentsCurrent;return{currentValue:o!==void 0?o/100:void 0,priceDifference:r!==void 0&&o!==void 0?Pn(kt(o,r),100):void 0,totalPercentChange24h:n}}),WU=C(t=>{let e=t(Yu),n=t(Xu);return{local:e,remote:n}}),xy=C(t=>{let e=t(jt),n=t(Xe),r=e.slice(-15).map(o=>{let i=n[o.encodedCaip19]??o.livePrice??o.price;return i?o.totalQuantity*i.price/10**o.decimals:0}).filter(o=>o>0);return r.length>0?Pn(r.reduce((o,i)=>Lr(o,i),0),r.length):void 0}),Iy=ve(Cn,t=>t.status),Dy=C(t=>{if(!t(zt))return{status:"idle",data:{currentValue:void 0,priceDifference:void 0,totalPercentChange24h:void 0}};let n=t(Yu),r=t(Iy),o=t(Xu),i=!t(pt)&&t(Ee).isSuccess,s=t(xy),a=typeof s=="number"&&s<.05;return{status:r,data:i||a?n:o}}),Ny=Dy;c();u();var Ju=C(t=>{let{refetch:e}=t(Cn),{refetch:n}=t(Ee),r=t(zt);return()=>{Du(),n(),r&&e()}}),_y=_e(t=>{let e=t(Ju),n=t(di);n.status==="error"&&n.error.cause==="TooManyFungibleUpdates"&&e()}),Oy=C(t=>{t(_y);let e=t(Ju),{isPending:n,isRefetching:r,isLoading:o}=t(Ee);return{isPending:n,isLoading:o,isRefetching:r,refetch:e}}),My=Oy;c();u();var Ei=M(B());c();u();var Ti=new L(0),vi=({chainAddress:t,type:e,balance:n,decimals:r,recipient:o,gasEstimation:i,clampToZero:s=!0})=>{let{data:a,isPending:m}=Sr(t);if(!e||!n)return Ti;let l=new L(n).multipliedBy(Jt(r));if(!He(e))return l;if(!i)return;let d=new L(0);if(_t(i))d=l.minus(new L(i.value));else if(Kn(i)){let{gasLimit:p,maxFeePerGas:y,l1Fee:g=new L(0)}=i,b=p.times(y).plus(g);d=l.minus(b)}else if(Ot(i)){if(!t||m)return;let p=t.addressType,y=a?.safeToSendUtxos??[],g=Ns(i.btcPerKilobyte),b=o&&Hi.safeParse(o).success?o:"bc1p",S=[{value:y.reduce((G,j)=>G.plus(new L(j.value)),new L(0)).toNumber(),address:b}],N=Qs(p,y,S,g.toNumber(),[]);if(N.type==="error")d=new L(N.maxAmount).integerValue(L.ROUND_DOWN);else{let{inputs:G,fee:j}=N;d=G.reduce((ie,se)=>ie.plus(new L(se.value)),new L(0)).minus(j).integerValue(L.ROUND_DOWN)}}else if(Qn(i))d=l.minus(i.gasBudget);else return Ce(i);return d.isGreaterThan(Ti)?d:s?Ti:d};var Ry=({networkID:t,addressType:e,gasEstimation:n,transactionValue:r=new L(0),recipient:o})=>{let{data:i,isLoading:s,isError:a}=Ur({networkID:t,addressType:e}),m=oa.get(t).nativeFungibleTokenType,l="unknown",d="",p=(0,Ei.useMemo)(()=>{let g=i?.queriedWalletBalances[0]?.address;if(!g)return;let b=$i(t,g);return{networkID:t,address:g,addressType:b}},[i?.queriedWalletBalances,t]),y=vi({chainAddress:p,type:m,balance:i?.totalQuantityString?new L(i?.totalQuantityString):void 0,decimals:i?.decimals??0,recipient:o,gasEstimation:n,clampToZero:!1});return!a&&i&&y&&(y.gte(r)?l="sufficient":l="insufficient",d=i?.symbol||""),(0,Ei.useMemo)(()=>({hasSufficientFunds:l,nativeTokenSymbol:d,isLoading:s,isError:a}),[l,d,s,a])};c();u();var nl=M(B());c();u();var wi=M(B());c();u();var Zu=({chainAddresses:t=[]})=>{let e=ce.tokensErrorCount(t);return I({queryKey:e,queryFn:()=>{throw new Error("This query is cache-only")},enabled:!1,initialData:0,staleTime:1/0})};c();u();var Uy=({errors:t})=>t;function el({chainAddresses:t,queryOptions:e}){return ca({select:Uy,chainAddresses:t,queryOptions:e})}var tl=3,By=1,Ai=({networkID:t,chainAddresses:e=[]})=>{let{data:n=[]}=el({chainAddresses:e}),{data:r=0}=Zu({chainAddresses:e}),o=r>=tl,{data:i=0}=Eo(),s=i>=tl,a=n.length===By&&n.some(d=>d.code==="TokensTrimmed"),{t:m}=Me(),l=(0,wi.useMemo)(()=>{if(o)return m("partialErrorGeneric");let d=n.filter(y=>t?y.details.chainId===t:!0),p=d.length+(s?1:0);return p?p>1?m("partialErrorGeneric"):s?m("partialErrorTokenPrices"):a?m("partialErrorTokensTrimmed"):t?m("partialErrorTokenDetail"):m("partialErrorBalanceChainName",{chainName:A.getChainName(d[0].details.chainId)}):""},[o,n,s,t,a,m]);return(0,wi.useMemo)(()=>({partialErrorMessage:l,shouldShowPartialError:l!==""}),[l])};function Ly(t){let{onTappingBuy:e,onTappingReceive:n,onTappingSend:r,onTappingSwap:o,account:i}=t,{shouldShowPartialError:s,partialErrorMessage:a}=Ai({chainAddresses:i?.addresses});return{ctaActions:Vy({onTappingBuy:e,onTappingReceive:n,onTappingSend:r,onTappingSwap:o}),shouldShowPartialError:s,partialErrorMessage:a}}function Vy(t){let{t:e}=Me(),n=Ji();return(0,nl.useMemo)(()=>{let o=[];return o.push({text:e("commandSend"),type:"send",onClick:t.onTappingSend}),n?o.push({text:e("commandTrade"),type:"trade",onClick:t.onTappingSwap}):o.push({text:e("commandSwap"),type:"swap",onClick:t.onTappingSwap}),o.push({text:e("commandReceive"),type:"receive",onClick:t.onTappingReceive}),o.push({text:e("commandBuy"),type:"buy",onClick:t.onTappingBuy}),o.sort((i,s)=>(ro.get(i.type)??100)-(ro.get(s.type)??100)),{primary:o,more:[]}},[e,n,t.onTappingSend,t.onTappingSwap,t.onTappingReceive,t.onTappingBuy])}c();u();var rl=M(B());var Gy=({networkID:t,unsignedTransaction:e,pendingActivityRows:n,accountIdentifier:r,accountSigner:o,storage:i,includeCallPayload:s})=>({accountSigner:o,accountIdentifier:r,networkID:t,unsignedTransaction:e,...s&&{callPayload:{from:e.from,to:e.to,data:e.data,value:e.value}},pendingTransactionInput:{ownerAddress:e.from,networkID:t,data:{nonce:"",unsignedTransaction:e,hash:""},type:"swap",display:{summary:n}},storage:i}),Qy=async({t,fungible:e,unsignedUnwrapTx:n,gasEstimation:r,storage:o,accountMetadata:i,accountSigner:s})=>{if(!n)throw new Error("Unsigned unwrap transaction is required");if(!r)throw new Error("Gas estimation is required");let{chain:a,balance:m}=e.data;if(!A.isEthereumNetworkID(a.id))throw new Error(`Chain is not supported: ${a.id}`);let l=a.id,d={topRight:{text:`+${m} ${a.symbol}`},topLeft:{text:t("transactionsPendingSwapping")},bottomRight:{text:`-${m} ${e.data.symbol}`},bottomLeft:{text:`${e.data.name}`}},p=Gi.parse({type:"0x2",chainId:A.getEVMNetworkIDValue(l),gas:`0x${r.gasLimit.toString(16)}`,maxFeePerGas:`0x${r.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${r.maxPriorityFeePerGas.toString(16)}`,...n}),y=Gy({storage:o,accountSigner:s,pendingActivityRows:d,includeCallPayload:!1,networkID:l,unsignedTransaction:p,accountIdentifier:i.accountIdentifier});return Yn(y)},Ky=()=>{let{data:t}=Fe();return(0,rl.useMemo)(()=>{let n=t?.type,r=t?.name??"",o=t?.identifier??"";return{accountName:r,accountType:n,accountIdentifier:o}},[t])},Hy=t=>{let e=ae(),n=W(),{t:r}=Me(),o=Ky(),i=Ve();return Ie({async mutationFn({fungible:s,unsignedUnwrapTx:a,gasEstimation:m}){return await Qy({t:r,fungible:s,unsignedUnwrapTx:a,gasEstimation:m,accountMetadata:o,storage:e,accountSigner:i})},async onSuccess(){await n.invalidateQueries({queryKey:ce.tokens(t)})}})};c();u();c();u();var ol=M(B());var qy=(t,e,n)=>{let r=W(),{fungibles:o}=Ct({keys:[t]}),i=o.length===1?o[0]:void 0;(0,ol.useEffect)(()=>{if(!i)return;let{type:s,data:a}=i,{balance:m,decimals:l,chain:d}=a,{id:p}=d,y=He(s)===!0;if(!n||!m||y||m.isEqualTo(e))return;let g=ce.transferFungibleLoggingContext(t),b={transactionId:n,decimals:l,chainId:p,isNativeToken:y,previousBalance:m,fungibleKey:t};r.setQueryData(g,b)},[n])};c();u();var sl=M(B());c();u();function il(t,e,n){return X.PublicKey.findProgramAddressSync([t.toBuffer(),n.toBuffer(),e.toBuffer()],Ys)[0]}var jy=new en("Unable to unwrap SOL. Wrapped SOL Token account does not exist."),Wy=new en("Unable to unwrap SOL. Token account is not expected mint.");async function zy(t,e){let n=await t.getAccountInfo(e);if(!n)throw jy;let r=Js.decode(n.data);return new X.PublicKey(r.mint)}function $y(t){if(t)return typeof t=="string"?new X.PublicKey(t):t}function Yy(){let{connection:t}=un(),{data:e}=Fe(),{solanaChainAddress:n,accountIdentifier:r}=(0,sl.useMemo)(()=>({solanaChainAddress:e?.addresses.find(ht),accountIdentifier:e?.identifier??""}),[e]),o=ae(),i=Ve(),{t:s}=Me();return Ie({mutationFn:async a=>{if(!n)return Promise.reject("solanaChainAddress not loaded");try{let{networkID:m,address:l}=n,d=new X.PublicKey(l),p=$y(a?.tokenAccount)??il(d,to,Zt);if((await zy(t,p)).toBase58()!==to.toBase58())throw Wy;let g=tc(p,d,d,[],Zt),b=new Qi.Transaction().add(g),E={ownerAddress:l,networkID:m,data:{signature:""},type:"unwrapSOL",display:{summary:{topLeft:{text:s("assetDetailUnwrappingSOL")}}}},S=await Ft({accountIdentifier:r,accountSigner:i,connection:t,feePayer:new X.PublicKey(l),pendingTransactionInput:E,storage:o,transaction:b,useSubmissionService:!1});return{networkID:m,id:S}}catch(m){throw m instanceof Error&&_.captureError(m,"tokens"),m}}})}c();u();var al=v({minutes:1}),Xy=(t,e=!0)=>{let n=ce.solanaBalance(t);return I({enabled:!!t&&e&&ht(t),gcTime:al,staleTime:al,queryKey:n,async queryFn(){if(!t)throw new Error("No chain address provided");if(ht(t))return bt(t.networkID).getBalance(new X.PublicKey(t.address));throw new Error(`SOL balance not implemented for ${t.networkID}`)}})};c();u();c();u();var cl=M(B());var Jy=t=>{let{data:e}=ds();return(0,cl.useMemo)(()=>{if(!t||!e)return;let n=t.data.chain.id,r=e.explorers[n]??cs.get(n).defaultExplorer,o,i;if(He(t.type))i="address",o=t.data.walletAddress;else switch(t.type){case"SuiCoin":{i="token",o=t.data.contractAddress;break}case"ERC20":{i="address",o=t.data.contractAddress;break}case"SPL":case"CompressedSPL":{i="address",o=t.data.mintAddress;break}case"BRC20":return{explorerName:"Unisat",explorerUrl:`https://unisat.io/brc20?q=${t.data.walletAddress}`}}let s=ls({networkID:n,endpoint:i,explorerType:r,param:o});return{explorerName:us[r],explorerUrl:s}},[t,e])};c();u();var ul=M(B());var Zy=t=>{let e=W();return(0,ul.useCallback)(()=>e.invalidateQueries({queryKey:ce.tokens(t)}),[e,t])};c();u();var ll=M(B()),eh=(t,e)=>(0,ll.useMemo)(()=>{if(t)if(Ot(t)){let n=Ds(t).toNumber().toLocaleString("en-US");return{leftSubtext:void 0,leftSubtextColor:void 0,rightSubtext:e("satsAmount",{sats:n.toString()})}}else return _t(t)&&t.highFees?{leftSubtext:e("notificationTransactionApprovalNetworkFeeHighWarning"),leftSubtextColor:"spotWarning",rightSubtext:""}:void 0},[t,e]);c();u();var th=M(B());c();u();var ml=M(B());var nh=({caip19:t,fungibleCaip19:e,fungibleKeys:n,isSplCompressed:r})=>{let{fungibles:o,isLoadingTokens:i,refetch:s}=Ct({keys:n}),{data:a,refetch:m,isLoading:l}=Rr({encodedCaip19:t,legacyKey:n?.[0]??null,isSplCompressed:r}),{data:d,isLoading:p}=yi({caip19:t,includePrice:!0}),y=sh(o,r),g=(0,ml.useMemo)(()=>{if(!y)return;if(!a)return y;let E=tn(a.totalQuantityString,a.decimals);return{...y,data:{...y.data,balance:E,usd:a.price?.price?E.times(a.price.price).toNumber():void 0,usd_24h_change:a.price?.priceChange24h!==void 0?dl(E.times(a.price.price).toNumber(),a.price?.priceChange24h):void 0}}},[y,a]);return{derivedFungible:rh({fungible:g,fungibleCaip19:e,tokenDetails:d,tokenBalance:a}),isLoading:i||p||l,refetchFungibleBalance:s,refetchTokenBalance:m}};function rh({fungible:t,fungibleCaip19:e,tokenDetails:n,tokenBalance:r}){if(t)return t;if(!n)return;let o=ma(n),i="address"in e?oh(e,o):ih(e,o);if(i){if(r){r.extraMetadata?.compression?.compressed&&(i.type="CompressedSPL");let s=tn(r.totalQuantityString,r.decimals);i.data.balance=s,i.data.amount=r.totalQuantityString,i.data.usd=r.price?.price?s.times(r.price.price).toNumber():void 0,i.data.usd_24h_change=r.price?.priceChange24h!==void 0?dl(s.times(r.price.price).toNumber(),r.price?.priceChange24h):void 0,i.data.walletAddress=r.queriedWalletBalances.find(a=>a.quantity>0)?.address??""}return i}_.addBreadcrumb("tokens","deriveFungible","error",{fungibleCaip19:JSON.stringify(e),tokenDetails:JSON.stringify(n),tokenBalance:JSON.stringify(r)}),_.captureError(new Error(`Fungible type could not be derived from ${JSON.stringify(e)}`),"fungibles")}function oh(t,e){let n=no(t);if(He(n))throw new Error("Cannot create fake non-native fungible for native token");let r=e.address??t.address,o={amount:"0",balance:L(0),chain:e.chain,decimals:e.decimals,logoUri:e.logoURI??e.logoUri,name:e.name??"Unknown",symbol:e.symbol??"Unknown",key:r,walletAddress:"",spamStatus:e.spamStatus};switch(n){case"SPL":return{type:n,data:{...o,mintAddress:r,programId:"",splTokenAccountPubkey:""}};case"CompressedSPL":return{type:n,data:{...o,mintAddress:r,programId:""}};case"ERC20":case"SuiCoin":return{type:n,data:{...o,contractAddress:r}};case"BRC20":return{type:n,data:{...o,firstCreatedInscriptionId:r}};case"HypercoreAsset":return;default:Ce(n)}}function ih(t,e){let n=no(t),r={amount:"0",balance:L(0),chain:e.chain,decimals:e.decimals,logoUri:e.logoURI??e.logoUri,name:e.name??"Unknown",symbol:e.symbol??"Unknown",key:n,walletAddress:"",spamStatus:e.spamStatus};switch(t.slip44){case"501":return{type:"SolanaNative",data:r};case"0":return{type:"BitcoinNative",data:r};case"60":return{type:"EthereumNative",data:r};case"8453":return{type:"BaseNative",data:r};case"143":return{type:"MonadNative",data:r};case"9001":return{type:"ArbitrumNative",data:r};case"925":return{type:"HypercoreNative",data:r};case"966":return{type:"PolygonNative",data:r};case"784":return{type:"SuiNative",data:r};default:{let o=new Error("Missing native token implementation when creating fake a Fungible");throw Ce(t.slip44,o),o}}}var sh=(t,e)=>t?.length?[...t].sort((r,o)=>{if(e!==void 0){let i=r.type==="CompressedSPL",s=o.type==="CompressedSPL";if(i!==s)return e?i?-1:1:i?1:-1}return o.data.balance.minus(r.data.balance).toNumber()})[0]:void 0,dl=(t,e)=>{if(e===-100)return-1*t;let n=t/(1+e/100);return t-n};c();u();c();u();var Tl=M(B());c();u();c();u();var pl="@phantom/wallet-screening",fl=`${pl}:wallet-screen-action`,ah=`${pl}:wallet-screen-geo`,Vr={walletScreenAction(t){return[fl,t]},walletGeo(){return[ah]}};c();u();var yl=new Error("Failed to fetch wallet screen action.");async function hl(t){try{let e=await $.api().post("/wallet_screen/v1",t);if(!Pe(e))throw yl;let n=e.data;return da.parse(n)}catch{throw yl}}var gl=v({days:7}),bl=t=>{let e=t!==void 0&&A.isMainnetNetworkID(t.networkID),n=[];if(t!==void 0){let a=A.isEVMNetworkID(t.networkID)?t.address.toLowerCase():t.address;n=[{chainId:t.networkID,address:a,resourceType:"address"}]}let r={addresses:n},o=W(),i=Vr.walletScreenAction(r),s=[i[0]];return I({enabled:e,queryKey:i,gcTime:gl,staleTime:gl,refetchInterval:!1,refetchOnMount:!1,async queryFn(){if(uh(o,s))return"FAIL_SEVERE";let m=await hl(r);return lh(m)}})},uh=(t,e)=>{let n=t.getQueriesData({queryKey:e,exact:!1}),r=!1;for(let[o,i]of n){let s=i;if(s&&s==="FAIL_SEVERE"){r=!0;break}}return r},lh=t=>{let e=t.addressScreenResults;return e.some(n=>n.action==="FAIL_SEVERE")?"FAIL_SEVERE":e.some(n=>n.action==="FAIL_HIGH")?"FAIL_HIGH":e.some(n=>n.action==="NO_ACTION")?"NO_ACTION":"DATA_NOT_FOUND"};var mh=(t,e)=>{let n=Re(),{data:r}=bl(t);switch((0,Tl.useEffect)(()=>{r&&t&&n.capture("walletScreened",{data:{walletScreen:{action:r.toString(),surface:e},chainId:A.getChainID(t.networkID),networkId:t.networkID}})},[r,t,e,n]),r){case"FAIL_SEVERE":case"FAIL_HIGH":throw new fa(`Transaction disabled: ${e}`);case"NO_ACTION":case"DATA_NOT_FOUND":return}};c();u();c();u();c();u();var vl=new Error("Failed to fetch wallet geo.");async function El(){try{let t=await $.api().get("/wallet_screen/v1/geo");if(!Pe(t))throw vl;let e=t.data;return pa.parse(e).country}catch{throw vl}}var wl=v({hours:1}),dh=()=>{let t=Vr.walletGeo();return I({queryKey:t,staleTime:wl,refetchInterval:wl,queryFn:El})};c();u();c();u();function rt(t){return Array.isArray?Array.isArray(t):Dl(t)==="[object Array]"}var ph=1/0;function fh(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-ph?"-0":e}function yh(t){return t==null?"":fh(t)}function Ze(t){return typeof t=="string"}function xl(t){return typeof t=="number"}function hh(t){return t===!0||t===!1||gh(t)&&Dl(t)=="[object Boolean]"}function Il(t){return typeof t=="object"}function gh(t){return Il(t)&&t!==null}function Oe(t){return t!=null}function Si(t){return!t.trim().length}function Dl(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}var bh="Incorrect 'index' type",Th=t=>`Invalid value for key ${t}`,vh=t=>`Pattern length exceeds max of ${t}.`,Eh=t=>`Missing ${t} property in key`,wh=t=>`Property 'weight' in key '${t}' must be a positive integer`,Al=Object.prototype.hasOwnProperty,Pi=class{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(r=>{let o=Nl(r);this._keys.push(o),this._keyMap[o.id]=o,n+=o.weight}),this._keys.forEach(r=>{r.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function Nl(t){let e=null,n=null,r=null,o=1,i=null;if(Ze(t)||rt(t))r=t,e=Sl(t),n=Ci(t);else{if(!Al.call(t,"name"))throw new Error(Eh("name"));let s=t.name;if(r=s,Al.call(t,"weight")&&(o=t.weight,o<=0))throw new Error(wh(s));e=Sl(s),n=Ci(s),i=t.getFn}return{path:e,id:n,weight:o,src:r,getFn:i}}function Sl(t){return rt(t)?t:t.split(".")}function Ci(t){return rt(t)?t.join("."):t}function Ah(t,e){let n=[],r=!1,o=(i,s,a)=>{if(Oe(i))if(!s[a])n.push(i);else{let m=s[a],l=i[m];if(!Oe(l))return;if(a===s.length-1&&(Ze(l)||xl(l)||hh(l)))n.push(yh(l));else if(rt(l)){r=!0;for(let d=0,p=l.length;d<p;d+=1)o(l[d],s,a+1)}else s.length&&o(l,s,a+1)}};return o(t,Ze(e)?e.split("."):e,0),r?n:n[0]}var Sh={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Ph={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},Ch={location:0,threshold:.6,distance:100},kh={useExtendedSearch:!1,getFn:Ah,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},F={...Ph,...Sh,...Ch,...kh},xh=/[^ ]+/g;function Ih(t=1,e=3){let n=new Map,r=Math.pow(10,e);return{get(o){let i=o.match(xh).length;if(n.has(i))return n.get(i);let s=1/Math.pow(i,.5*t),a=parseFloat(Math.round(s*r)/r);return n.set(i,a),a},clear(){n.clear()}}}var kn=class{constructor({getFn:e=F.getFn,fieldNormWeight:n=F.fieldNormWeight}={}){this.norm=Ih(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Ze(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){let n=this.size();Ze(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!Oe(e)||Si(e))return;let r={v:e,i:n,n:this.norm.get(e)};this.records.push(r)}_addObject(e,n){let r={i:n,$:{}};this.keys.forEach((o,i)=>{let s=o.getFn?o.getFn(e):this.getFn(e,o.path);if(Oe(s)){if(rt(s)){let a=[],m=[{nestedArrIndex:-1,value:s}];for(;m.length;){let{nestedArrIndex:l,value:d}=m.pop();if(Oe(d))if(Ze(d)&&!Si(d)){let p={v:d,i:l,n:this.norm.get(d)};a.push(p)}else rt(d)&&d.forEach((p,y)=>{m.push({nestedArrIndex:y,value:p})})}r.$[i]=a}else if(Ze(s)&&!Si(s)){let a={v:s,n:this.norm.get(s)};r.$[i]=a}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}};function _l(t,e,{getFn:n=F.getFn,fieldNormWeight:r=F.fieldNormWeight}={}){let o=new kn({getFn:n,fieldNormWeight:r});return o.setKeys(t.map(Nl)),o.setSources(e),o.create(),o}function Dh(t,{getFn:e=F.getFn,fieldNormWeight:n=F.fieldNormWeight}={}){let{keys:r,records:o}=t,i=new kn({getFn:e,fieldNormWeight:n});return i.setKeys(r),i.setIndexRecords(o),i}function Gr(t,{errors:e=0,currentLocation:n=0,expectedLocation:r=0,distance:o=F.distance,ignoreLocation:i=F.ignoreLocation}={}){let s=e/t.length;if(i)return s;let a=Math.abs(r-n);return o?s+a/o:a?1:s}function Nh(t=[],e=F.minMatchCharLength){let n=[],r=-1,o=-1,i=0;for(let s=t.length;i<s;i+=1){let a=t[i];a&&r===-1?r=i:!a&&r!==-1&&(o=i-1,o-r+1>=e&&n.push([r,o]),r=-1)}return t[i-1]&&i-r>=e&&n.push([r,i-1]),n}var xt=32;function _h(t,e,n,{location:r=F.location,distance:o=F.distance,threshold:i=F.threshold,findAllMatches:s=F.findAllMatches,minMatchCharLength:a=F.minMatchCharLength,includeMatches:m=F.includeMatches,ignoreLocation:l=F.ignoreLocation}={}){if(e.length>xt)throw new Error(vh(xt));let d=e.length,p=t.length,y=Math.max(0,Math.min(r,p)),g=i,b=y,E=a>1||m,S=E?Array(p):[],N;for(;(N=t.indexOf(e,b))>-1;){let ee=Gr(e,{currentLocation:N,expectedLocation:y,distance:o,ignoreLocation:l});if(g=Math.min(ee,g),b=N+d,E){let xe=0;for(;xe<d;)S[N+xe]=1,xe+=1}}b=-1;let G=[],j=1,me=d+p,ie=1<<d-1;for(let ee=0;ee<d;ee+=1){let xe=0,fe=me;for(;xe<fe;)Gr(e,{errors:ee,currentLocation:y+fe,expectedLocation:y,distance:o,ignoreLocation:l})<=g?xe=fe:me=fe,fe=Math.floor((me-xe)/2+xe);me=fe;let Ae=Math.max(1,y-fe+1),w=s?p:Math.min(y+fe,p)+d,T=Array(w+2);T[w+1]=(1<<ee)-1;for(let P=w;P>=Ae;P-=1){let k=P-1,D=n[t.charAt(k)];if(E&&(S[k]=+!!D),T[P]=(T[P+1]<<1|1)&D,ee&&(T[P]|=(G[P+1]|G[P])<<1|1|G[P+1]),T[P]&ie&&(j=Gr(e,{errors:ee,currentLocation:k,expectedLocation:y,distance:o,ignoreLocation:l}),j<=g)){if(g=j,b=k,b<=y)break;Ae=Math.max(1,2*y-b)}}if(Gr(e,{errors:ee+1,currentLocation:y,expectedLocation:y,distance:o,ignoreLocation:l})>g)break;G=T}let se={isMatch:b>=0,score:Math.max(.001,j)};if(E){let ee=Nh(S,a);ee.length?m&&(se.indices=ee):se.isMatch=!1}return se}function Oh(t){let e={};for(let n=0,r=t.length;n<r;n+=1){let o=t.charAt(n);e[o]=(e[o]||0)|1<<r-n-1}return e}var Qr=class{constructor(e,{location:n=F.location,threshold:r=F.threshold,distance:o=F.distance,includeMatches:i=F.includeMatches,findAllMatches:s=F.findAllMatches,minMatchCharLength:a=F.minMatchCharLength,isCaseSensitive:m=F.isCaseSensitive,ignoreLocation:l=F.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:o,includeMatches:i,findAllMatches:s,minMatchCharLength:a,isCaseSensitive:m,ignoreLocation:l},this.pattern=m?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;let d=(y,g)=>{this.chunks.push({pattern:y,alphabet:Oh(y),startIndex:g})},p=this.pattern.length;if(p>xt){let y=0,g=p%xt,b=p-g;for(;y<b;)d(this.pattern.substr(y,xt),y),y+=xt;if(g){let E=p-xt;d(this.pattern.substr(E),E)}}else d(this.pattern,0)}searchIn(e){let{isCaseSensitive:n,includeMatches:r}=this.options;if(n||(e=e.toLowerCase()),this.pattern===e){let b={isMatch:!0,score:0};return r&&(b.indices=[[0,e.length-1]]),b}let{location:o,distance:i,threshold:s,findAllMatches:a,minMatchCharLength:m,ignoreLocation:l}=this.options,d=[],p=0,y=!1;this.chunks.forEach(({pattern:b,alphabet:E,startIndex:S})=>{let{isMatch:N,score:G,indices:j}=_h(e,b,E,{location:o+S,distance:i,threshold:s,findAllMatches:a,minMatchCharLength:m,includeMatches:r,ignoreLocation:l});N&&(y=!0),p+=G,N&&j&&(d=[...d,...j])});let g={isMatch:y,score:y?p/this.chunks.length:1};return y&&r&&(g.indices=d),g}},et=class{constructor(e){this.pattern=e}static isMultiMatch(e){return Pl(e,this.multiRegex)}static isSingleMatch(e){return Pl(e,this.singleRegex)}search(){}};function Pl(t,e){let n=t.match(e);return n?n[1]:null}var ki=class extends et{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){let n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}},xi=class extends et{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){let r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}},Ii=class extends et{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){let n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}},Di=class extends et{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){let n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}},Ni=class extends et{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){let n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},_i=class extends et{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){let n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}},Kr=class extends et{constructor(e,{location:n=F.location,threshold:r=F.threshold,distance:o=F.distance,includeMatches:i=F.includeMatches,findAllMatches:s=F.findAllMatches,minMatchCharLength:a=F.minMatchCharLength,isCaseSensitive:m=F.isCaseSensitive,ignoreLocation:l=F.ignoreLocation}={}){super(e),this._bitapSearch=new Qr(e,{location:n,threshold:r,distance:o,includeMatches:i,findAllMatches:s,minMatchCharLength:a,isCaseSensitive:m,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}},Hr=class extends et{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,r,o=[],i=this.pattern.length;for(;(r=e.indexOf(this.pattern,n))>-1;)n=r+i,o.push([r,n-1]);let s=!!o.length;return{isMatch:s,score:s?0:1,indices:o}}},Oi=[ki,Hr,Ii,Di,_i,Ni,xi,Kr],Cl=Oi.length,Mh=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Fh="|";function Rh(t,e={}){return t.split(Fh).map(n=>{let r=n.trim().split(Mh).filter(i=>i&&!!i.trim()),o=[];for(let i=0,s=r.length;i<s;i+=1){let a=r[i],m=!1,l=-1;for(;!m&&++l<Cl;){let d=Oi[l],p=d.isMultiMatch(a);p&&(o.push(new d(p,e)),m=!0)}if(!m)for(l=-1;++l<Cl;){let d=Oi[l],p=d.isSingleMatch(a);if(p){o.push(new d(p,e));break}}}return o})}var Uh=new Set([Kr.type,Hr.type]),Mi=class{constructor(e,{isCaseSensitive:n=F.isCaseSensitive,includeMatches:r=F.includeMatches,minMatchCharLength:o=F.minMatchCharLength,ignoreLocation:i=F.ignoreLocation,findAllMatches:s=F.findAllMatches,location:a=F.location,threshold:m=F.threshold,distance:l=F.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:o,findAllMatches:s,ignoreLocation:i,location:a,threshold:m,distance:l},this.pattern=n?e:e.toLowerCase(),this.query=Rh(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){let n=this.query;if(!n)return{isMatch:!1,score:1};let{includeMatches:r,isCaseSensitive:o}=this.options;e=o?e:e.toLowerCase();let i=0,s=[],a=0;for(let m=0,l=n.length;m<l;m+=1){let d=n[m];s.length=0,i=0;for(let p=0,y=d.length;p<y;p+=1){let g=d[p],{isMatch:b,indices:E,score:S}=g.search(e);if(b){if(i+=1,a+=S,r){let N=g.constructor.type;Uh.has(N)?s=[...s,...E]:s.push(E)}}else{a=0,i=0,s.length=0;break}}if(i){let p={isMatch:!0,score:a/i};return r&&(p.indices=s),p}}return{isMatch:!1,score:1}}},Fi=[];function Bh(...t){Fi.push(...t)}function Ri(t,e){for(let n=0,r=Fi.length;n<r;n+=1){let o=Fi[n];if(o.condition(t,e))return new o(t,e)}return new Qr(t,e)}var qr={AND:"$and",OR:"$or"},Ui={PATH:"$path",PATTERN:"$val"},Bi=t=>!!(t[qr.AND]||t[qr.OR]),Lh=t=>!!t[Ui.PATH],Vh=t=>!rt(t)&&Il(t)&&!Bi(t),kl=t=>({[qr.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function Ol(t,e,{auto:n=!0}={}){let r=o=>{let i=Object.keys(o),s=Lh(o);if(!s&&i.length>1&&!Bi(o))return r(kl(o));if(Vh(o)){let m=s?o[Ui.PATH]:i[0],l=s?o[Ui.PATTERN]:o[m];if(!Ze(l))throw new Error(Th(m));let d={keyId:Ci(m),pattern:l};return n&&(d.searcher=Ri(l,e)),d}let a={children:[],operator:i[0]};return i.forEach(m=>{let l=o[m];rt(l)&&l.forEach(d=>{a.children.push(r(d))})}),a};return Bi(t)||(t=kl(t)),r(t)}function Gh(t,{ignoreFieldNorm:e=F.ignoreFieldNorm}){t.forEach(n=>{let r=1;n.matches.forEach(({key:o,norm:i,score:s})=>{let a=o?o.weight:null;r*=Math.pow(s===0&&a?Number.EPSILON:s,(a||1)*(e?1:i))}),n.score=r})}function Qh(t,e){let n=t.matches;e.matches=[],Oe(n)&&n.forEach(r=>{if(!Oe(r.indices)||!r.indices.length)return;let{indices:o,value:i}=r,s={indices:o,value:i};r.key&&(s.key=r.key.src),r.idx>-1&&(s.refIndex=r.idx),e.matches.push(s)})}function Kh(t,e){e.score=t.score}function Hh(t,e,{includeMatches:n=F.includeMatches,includeScore:r=F.includeScore}={}){let o=[];return n&&o.push(Qh),r&&o.push(Kh),t.map(i=>{let{idx:s}=i,a={item:e[s],refIndex:s};return o.length&&o.forEach(m=>{m(i,a)}),a})}var It=class{constructor(e,n={},r){this.options={...F,...n},this.options.useExtendedSearch,this._keyStore=new Pi(this.options.keys),this.setCollection(e,r)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof kn))throw new Error(bh);this._myIndex=n||_l(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Oe(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){let n=[];for(let r=0,o=this._docs.length;r<o;r+=1){let i=this._docs[r];e(i,r)&&(this.removeAt(r),r-=1,o-=1,n.push(i))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){let{includeMatches:r,includeScore:o,shouldSort:i,sortFn:s,ignoreFieldNorm:a}=this.options,m=Ze(e)?Ze(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Gh(m,{ignoreFieldNorm:a}),i&&m.sort(s),xl(n)&&n>-1&&(m=m.slice(0,n)),Hh(m,this._docs,{includeMatches:r,includeScore:o})}_searchStringList(e){let n=Ri(e,this.options),{records:r}=this._myIndex,o=[];return r.forEach(({v:i,i:s,n:a})=>{if(!Oe(i))return;let{isMatch:m,score:l,indices:d}=n.searchIn(i);m&&o.push({item:i,idx:s,matches:[{score:l,value:i,norm:a,indices:d}]})}),o}_searchLogical(e){let n=Ol(e,this.options),r=(a,m,l)=>{if(!a.children){let{keyId:p,searcher:y}=a,g=this._findMatches({key:this._keyStore.get(p),value:this._myIndex.getValueForItemAtKeyId(m,p),searcher:y});return g&&g.length?[{idx:l,item:m,matches:g}]:[]}let d=[];for(let p=0,y=a.children.length;p<y;p+=1){let g=a.children[p],b=r(g,m,l);if(b.length)d.push(...b);else if(a.operator===qr.AND)return[]}return d},o=this._myIndex.records,i={},s=[];return o.forEach(({$:a,i:m})=>{if(Oe(a)){let l=r(n,a,m);l.length&&(i[m]||(i[m]={idx:m,item:a,matches:[]},s.push(i[m])),l.forEach(({matches:d})=>{i[m].matches.push(...d)}))}}),s}_searchObjectList(e){let n=Ri(e,this.options),{keys:r,records:o}=this._myIndex,i=[];return o.forEach(({$:s,i:a})=>{if(!Oe(s))return;let m=[];r.forEach((l,d)=>{m.push(...this._findMatches({key:l,value:s[d],searcher:n}))}),m.length&&i.push({idx:a,item:s,matches:m})}),i}_findMatches({key:e,value:n,searcher:r}){if(!Oe(n))return[];let o=[];if(rt(n))n.forEach(({v:i,i:s,n:a})=>{if(!Oe(i))return;let{isMatch:m,score:l,indices:d}=r.searchIn(i);m&&o.push({score:l,key:e,value:i,idx:s,norm:a,indices:d})});else{let{v:i,n:s}=n,{isMatch:a,score:m,indices:l}=r.searchIn(i);a&&o.push({score:m,key:e,value:i,norm:s,indices:l})}return o}};It.version="7.0.0";It.createIndex=_l;It.parseIndex=Dh;It.config=F;It.parseQuery=Ol;Bh(Mi);export{tc as a,C as b,wa as c,Yh as d,he as e,rn as f,Xh as g,Qt as h,lt as i,ve as j,lm as k,be as l,ym as m,Ua as n,Et as o,vo as p,po as q,fo as r,wt as s,Rm as t,lr as u,Wa as v,Wm as w,St as x,Cp as y,Io as z,Do as A,Ed as B,xp as C,Xo as D,tt as E,wd as F,cn as G,dc as H,un as I,Ip as J,Ad as K,ln as L,$c as M,Np as N,Op as O,Ar as P,Sr as Q,Vp as R,jo as S,Kc as T,Gp as U,Qp as V,Kp as W,vp as X,jp as Y,$p as Z,Xp as _,Sp as $,Jp as aa,Jo as ba,ef as ca,tf as da,Ct as ea,qy as fa,vi as ga,Yy as ha,rf as ia,Xy as ja,Jy as ka,of as la,py as ma,mu as na,fu as oa,Df as pa,_e as qa,qt as ra,Iu as sa,Dr as ta,mt as ua,Ee as va,Ou as wa,Ye as xa,di as ya,Xe as za,pt as Aa,Je as Ba,Rr as Ca,ay as Da,Hu as Ea,Br as Fa,An as Ga,Qu as Ha,jt as Ia,qu as Ja,yi as Ka,zu as La,gi as Ma,zt as Na,Cn as Oa,WU as Pa,Ny as Qa,My as Ra,Ry as Sa,Ai as Ta,Ly as Ua,Zy as Va,eh as Wa,Hy as Xa,nh as Ya,It as Za,fl as _a,mh as $a,dh as ab};
//# sourceMappingURL=chunk-IHXFHG2Y.js.map
