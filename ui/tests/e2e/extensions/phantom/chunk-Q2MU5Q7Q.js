import{$a as oi,A as Gr,Da as jr,I as kt,J as Hr,Sa as Jr,Za as ei,_ as ho,ab as ni,la as Lt,p as zr,u as Qr}from"./chunk-IHXFHG2Y.js";import{Aa as ti,Ba as me,ca as Nt,ma as $r,na as O,oa as Yr,pa as mn,qa as Xr,ya as Zr}from"./chunk-QCKHHJ5F.js";import{b as pe}from"./chunk-JSLOSOZX.js";import{e as lo}from"./chunk-R5GARSZH.js";import{$a as ee,Da as Mr,Ma as Ur,Rb as yt,Vb as Br,Z as _r,k as Er,tb as Or,y as Fr}from"./chunk-VOCOWPRG.js";import{$b as be,N as mo,O as Tt,Xb as ln,bb as fo,dc as Dr,ec as Rr,gc as pn,hc as qr,jb as So,jc as yo,kb as go,kc as Vr,mb as Gt,rc as ko,uc as Kr,zc as Wr}from"./chunk-F63TUCMM.js";import{e as ve}from"./chunk-CJHTJRVG.js";import{Ea as un,Fa as St,Gc as gt,Hc as xr,K as hr,Kc as Ir,Nd as Cr,Pc as G,Q as Ar,R as br,Rd as K,S as bt,T as Q,U as h,Yc as Lr,Zb as M,_ as vt,_c as X,_d as wt,ad as Fe,ba as Zt,cc as Tr,dc as te,jd as Y,k as ds,kc as Pr,ld as ct,od as L,z as gr}from"./chunk-PJ6PRBE2.js";import{R as j,S as V,c as ao,e as us}from"./chunk-DHKCVHRA.js";import{$b as dn,B as Ae,Ba as po,Ca as Z,D as co,Da as W,E as vr,F as uo,G as wr,S as v,X as J,c as E,g as cn,gb as Qt,h as Ee,i as Xt,j as yr,k as kr,kb as Nr,l as C,q as so}from"./chunk-UTOBJRXZ.js";import{c as ss,f as I,h as s,l as cs,m as Buffer,n as c}from"./chunk-SVG5OEFH.js";var ba=ss(P=>{"use strict";s();c();var Wc=P&&P.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(P,"__esModule",{value:!0});P.map=P.array=P.rustEnum=P.str=P.vecU8=P.tagged=P.vec=P.bool=P.option=P.publicKey=P.i256=P.u256=P.i128=P.u128=P.i64=P.u64=P.struct=P.f64=P.f32=P.i32=P.u32=P.i16=P.u16=P.i8=P.u8=void 0;var D=ln(),zc=gr(),Qc=Wc(ao()),jt=ln();Object.defineProperty(P,"u8",{enumerable:!0,get:function(){return jt.u8}});Object.defineProperty(P,"i8",{enumerable:!0,get:function(){return jt.s8}});Object.defineProperty(P,"u16",{enumerable:!0,get:function(){return jt.u16}});Object.defineProperty(P,"i16",{enumerable:!0,get:function(){return jt.s16}});Object.defineProperty(P,"u32",{enumerable:!0,get:function(){return jt.u32}});Object.defineProperty(P,"i32",{enumerable:!0,get:function(){return jt.s32}});Object.defineProperty(P,"f32",{enumerable:!0,get:function(){return jt.f32}});Object.defineProperty(P,"f64",{enumerable:!0,get:function(){return jt.f64}});Object.defineProperty(P,"struct",{enumerable:!0,get:function(){return jt.struct}});var ae=class extends D.Layout{constructor(t,o,n){super(t,n),this.blob=(0,D.blob)(t),this.signed=o}decode(t,o=0){let n=new Qc.default(this.blob.decode(t,o),10,"le");return this.signed?n.fromTwos(this.span*8).clone():n}encode(t,o,n=0){return this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),o,n)}};function ha(e){return new ae(8,!1,e)}P.u64=ha;function Gc(e){return new ae(8,!0,e)}P.i64=Gc;function Hc(e){return new ae(16,!1,e)}P.u128=Hc;function jc(e){return new ae(16,!0,e)}P.i128=jc;function Jc(e){return new ae(32,!1,e)}P.u256=Jc;function $c(e){return new ae(32,!0,e)}P.i256=$c;var Kt=class extends D.Layout{constructor(t,o,n,r){super(t.span,r),this.layout=t,this.decoder=o,this.encoder=n}decode(t,o){return this.decoder(this.layout.decode(t,o))}encode(t,o,n){return this.layout.encode(this.encoder(t),o,n)}getSpan(t,o){return this.layout.getSpan(t,o)}};function Yc(e){return new Kt((0,D.blob)(32),t=>new zc.PublicKey(t),t=>t.toBuffer(),e)}P.publicKey=Yc;var ir=class extends D.Layout{constructor(t,o){super(-1,o),this.layout=t,this.discriminator=(0,D.u8)()}encode(t,o,n=0){return t==null?this.discriminator.encode(0,o,n):(this.discriminator.encode(1,o,n),this.layout.encode(t,o,n+1)+1)}decode(t,o=0){let n=this.discriminator.decode(t,o);if(n===0)return null;if(n===1)return this.layout.decode(t,o+1);throw new Error("Invalid option "+this.property)}getSpan(t,o=0){let n=this.discriminator.decode(t,o);if(n===0)return 1;if(n===1)return this.layout.getSpan(t,o+1)+1;throw new Error("Invalid option "+this.property)}};function Xc(e,t){return new ir(e,t)}P.option=Xc;function Zc(e){return new Kt((0,D.u8)(),tu,eu,e)}P.bool=Zc;function tu(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function eu(e){return e?1:0}function ou(e,t){let o=(0,D.u32)("length"),n=(0,D.struct)([o,(0,D.seq)(e,(0,D.offset)(o,-o.span),"values")]);return new Kt(n,({values:r})=>r,r=>({values:r}),t)}P.vec=ou;function nu(e,t,o){let n=(0,D.struct)([ha("tag"),t.replicate("data")]);function r({tag:i,data:a}){if(!i.eq(e))throw new Error("Invalid tag, expected: "+e.toString("hex")+", got: "+i.toString("hex"));return a}return new Kt(n,r,i=>({tag:e,data:i}),o)}P.tagged=nu;function Aa(e){let t=(0,D.u32)("length"),o=(0,D.struct)([t,(0,D.blob)((0,D.offset)(t,-t.span),"data")]);return new Kt(o,({data:n})=>n,n=>({data:n}),e)}P.vecU8=Aa;function ru(e){return new Kt(Aa(),t=>t.toString("utf-8"),t=>Buffer.from(t,"utf-8"),e)}P.str=ru;function iu(e,t,o){let n=(0,D.union)(o??(0,D.u8)(),t);return e.forEach((r,i)=>n.addVariant(i,r,r.property)),n}P.rustEnum=iu;function au(e,t,o){let n=(0,D.struct)([(0,D.seq)(e,t,"values")]);return new Kt(n,({values:r})=>r,r=>({values:r}),o)}P.array=au;var ar=class extends D.Layout{constructor(t,o,n){super(t.span+o.span,n),this.keyLayout=t,this.valueLayout=o}decode(t,o){o=o||0;let n=this.keyLayout.decode(t,o),r=this.valueLayout.decode(t,o+this.keyLayout.getSpan(t,o));return[n,r]}encode(t,o,n){n=n||0;let r=this.keyLayout.encode(t[0],o,n),i=this.valueLayout.encode(t[1],o,n+r);return r+i}getSpan(t,o){return this.keyLayout.getSpan(t,o)+this.valueLayout.getSpan(t,o)}};function su(e,t,o){let n=(0,D.u32)("length"),r=(0,D.struct)([n,(0,D.seq)(new ar(e,t),(0,D.offset)(n,-n.span),"values")]);return new Kt(r,({values:i})=>new Map(i),i=>({values:Array.from(i.entries())}),o)}P.map=su});s();c();s();c();s();c();var Ht="@phantom/interstitials",we=`${Ht}:action-banners`,ri=`${Ht}:force-upgrade`,tt={actionBanners:(e,t)=>[we,{accountIdentifier:e,accessToken:t}],hasSeenInterstitial:e=>[`${Ht}:has-seen-interstitial`,{feature:e}],interstitialViewHistory:e=>[`${Ht}:interstitial-view-history`,{feature:e}],appLaunchTimes:()=>[`${Ht}:app-launch-times`],lastOnboardedAt:()=>[`${Ht}:last-onboarded-at`]};s();c();s();c();var Ao=(x=>(x.Buy="Buy",x.Collectibles="Collectibles",x.ConnectHardwareWallet="Connect Hardware Wallet",x.ConvertStakeAccount="Convert Stake Account",x.ConvertToJito="Convert to Jito",x.MintPSOL="Mint PSOL",x.Explore="Explore",x.Perps="Perps",x.MintCollectible="Mint Collectible",x.SocialLogin="Social Login",x.SettingsClaimUsername="Settings: Claim Username",x.SettingsCurrency="Settings: Currency",x.SettingsImportSeedPhrase="Settings: Import Seed Phrase",x.SettingsNotificationPreferences="Settings: Notification Preferences",x.SettingsSecurityAndPrivacy="Settings: Security & Privacy",x.TokenCategory="Token Category",x.Swapper="Swapper",x.ExternalLink="External Link",x.Token="Token",x.TokenChat="Token Chat",x))(Ao||{}),_e=class extends Error{message="Failed to set dismissed action banners to storage"};var ls={Multichain:2,MultichainSwapper:1,InvalidChecksum:1,SuiWelcome:1,SuiWelcomeDefaultOn:1,MonadWelcome:1,ArbitrumWelcome:1,ClaimUsernameNudge:1,QuickClaimUsername:1,SeedlessPinVerification:1,AdditionalPermissions:1,TermsOfServiceUpdate:1,StakingWelcomeNew:1,SocialFeedNux:1,SocialFeedNuxWelcome:1,PerpsJoinFeedbackGroup:1,NotificationsUpdate:1},ps={Multichain:3,MultichainSwapper:1,InvalidChecksum:1,SuiWelcome:1,SuiWelcomeDefaultOn:1,MonadWelcome:1,ArbitrumWelcome:1,StakingWelcomeNew:1,ClaimUsernameNudge:1,QuickClaimUsername:1,AdditionalPermissions:1,SeedlessPinVerification:1,TermsOfServiceUpdate:1,SocialFeedNux:1,SocialFeedNuxWelcome:1,PerpsJoinFeedbackGroup:1,NotificationsUpdate:1},fn=e=>uo?ls[e]:vr?ps[e]:-1;var bo=1,Dt=".phantom-labs.settings.interstitials",oe=class{static async getViewHistory(t,o){let n=await o.get(Dt);return n?n.interstitialsViewHistory[t]??[]:[]}static async hasSeen(t,o){let n=await o.get(Dt);if(!n)return!1;let r=fn(t);return(n.interstitialsSeen[t]??0)>=r}static async setHasSeen(t,o){let n=await o.get(Dt),r=fn(t);await o.set(Dt,{version:bo,interstitialsSeen:{...!!n&&n.interstitialsSeen,[t]:r},interstitialsViewHistory:{...!!n&&n.interstitialsViewHistory,[t]:[...n?.interstitialsViewHistory?.[t]??[],Date.now()]}})}static async resetHasSeen(t,o){let n=await o.get(Dt);if(n)return o.set(Dt,{version:bo,interstitialsSeen:{...n.interstitialsSeen,[t]:void 0},interstitialsViewHistory:{...n.interstitialsViewHistory,[t]:void 0}})}static async resetAllHasSeen(t){if(await t.get(Dt))return t.set(Dt,{version:bo,interstitialsSeen:{},interstitialsViewHistory:{}})}},ms={...Lr(Dt,[`${Ht}:has-seen-interstitial`,`${Ht}:interstitial-view-history`],(e,t)=>({version:bo,interstitialsSeen:{...e?.interstitialsSeen,...t?.interstitialsSeen},interstitialsViewHistory:{...e?.interstitialsViewHistory,...t?.interstitialsViewHistory}}))};s();c();var Sn=class{#t;constructor(t){this.#t=t}onBannerSeen=t=>{this.#t.capture("actionBannerSeenByUser",{data:{banner:t}})};onBannerClick=t=>{this.#t.capture("actionBannerClickedByUser",{data:{banner:t}})};onBannerDismiss=t=>{this.#t.capture("actionBannerDismissedByUser",{data:{banner:t}})};onInterstitialSeen=t=>{this.#t.capture("actionBannerInterstitialSeenByUser",{data:{banner:t}})};onInterstitialPrimaryClick=t=>{this.#t.capture("actionBannerInterstitialPrimaryButtonClickedByUser",{data:{banner:t}})};onInterstitialSecondaryClick=t=>{this.#t.capture("actionBannerInterstitialSecondaryButtonClickedByUser",{data:{banner:t}})};onInterstitialDismiss=t=>{this.#t.capture("actionBannerInterstitialDismissedByUser",{data:{banner:t}})}};s();c();var fs=({id:e,humanReadableId:t,description:o,bannerType:n})=>({id:e,humanReadableId:t,description:o,type:n}),Ss=({id:e,humanReadableId:t,description:o,bannerType:n,interstitial:r})=>{let{title:i,primaryButtonText:a,secondaryButtonText:u}=r,d;if(n==="Modal")for(let[l,m]of Object.values(r.lineItems).entries())d={...d??{},[`lineItem${l+1}`]:{title:m.title,description:m.description}};return{id:e,humanReadableId:t,description:o,type:n,interstitial:{title:i,body:d,primaryButtonText:a??v.t("commandContinue"),secondaryButtonText:u??v.t("commandDismiss")}}};s();c();s();c();var vo=e=>{let t=[];for(let o in e.errors)Array.isArray(e.errors[o])&&t.push(e.errors[o].join(", "));return t.join(", ")};var ai=async({locale:e})=>{let t;try{let o=JSON.stringify({platform:co,appVersion:Ae,locale:e}),n=await vt.api().headers({"Content-Type":"application/json"}).post(({apiEnv:i})=>`/banners/force_upgrade/${i}/v1`,o);if(n.status===400){let i=await n.data,a=vo(i);throw new Error(a)}else if(n.status<200||n.status>299)throw new Error(`status code: ${n.status}, body: ${n.statusText}`);let r=n.data;return r?{...r}:ii}catch(o){return t===400&&o instanceof Error&&G.captureError(o,"actionBanner"),ii}},ii={forceUpgradeStatus:"noop"};s();c();s();c();var si=async({locale:e})=>({...await ai({locale:e})});var gs=()=>L({queryKey:[ri],queryFn:async()=>{let t=lo(v.language)??"en";return si({locale:t})},enabled:!!Ae,staleTime:K({minutes:5})});s();c();var yn=e=>{let t=Fe(),o=tt.hasSeenInterstitial(e);return L({queryKey:o,queryFn:async()=>await oe.hasSeen(e,t)})};s();c();s();c();var ci=async e=>{await e.invalidateQueries({queryKey:[we]})};Cr(ci);var ui=async(e,t,o)=>{await e.setQueryData(tt.hasSeenInterstitial(t),o)};var Ct=e=>{let t=Fe(),o=Y();return ct({mutationFn:async()=>{await oe.setHasSeen(e,t),await ui(o,e,!0)},onSuccess:()=>o.invalidateQueries({queryKey:tt.interstitialViewHistory(e)})})};s();c();s();c();s();c();var kn=async e=>await e.get("dismissedActionBanners")??[],di=async(e,t)=>{try{let o=await kn(e);return o.includes(t)?void 0:e.set("dismissedActionBanners",[...o,t])}catch{throw new _e}};s();c();s();c();var pi=async({accountID:e,deviceId:t,locale:o,rootId:n,selectedAccountAddresses:r,accessToken:i})=>{let a;try{let u={accountID:e,deviceId:t,locale:o,platform:co,rootId:n,selectedAccountAddresses:r,version:Ae},d=await vt.api().headers({"Content-Type":"application/json"}).bearer(i).post(({apiEnv:m})=>`/banners/get_banners/${m}/v2`,u);if(d.status===400){let m=await d.data,p=vo(m);throw new Error(p)}else if(d.status<200||d.status>299)throw new Error(`status code: ${d.status}, body: ${await d.statusText}`);let l=d.data;return l?{...l,banners:l.banners??[]}:li}catch(u){return a===400&&u instanceof Error&&G.captureError(u,"actionBanner"),li}},li={id:void 0,banners:[]};s();c();s();c();var hn=e=>e?Object.values(Ao).includes(e):!1;s();c();var mi=e=>{switch(e){case"Bottom Sheet":return uo;case"Modal":return!0;default:return!1}};var fi=e=>{let{bannerType:t,destinationType:o}=e;switch(t){case"Deep Link":return hn(o);case"Bottom Sheet":case"Modal":return mi(t)&&hn(o);default:return!1}};var Si=async({accountID:e,deviceId:t,dismissedBanners:o,locale:n,rootId:r,selectedAccountAddresses:i,accessToken:a})=>{let u=await pi({accountID:e,deviceId:t,locale:n,rootId:r,selectedAccountAddresses:i,accessToken:a});return{...u,banners:u.banners.filter(d=>fi(d)&&!o.includes(d.id))}};var ys=K({minutes:1}),ks=()=>{let e=wt(),t=X(),{data:o,isLoading:n}=_r(),{data:r}=ee(),i=async()=>{let a=r?.type!=="readOnly"?r?.addresses.map(Pr)??[]:[],u=r?.type==="seed"?r.seedIdentifier:null,d=await kn(t),l=lo(v.language)??"en",m=await e.getDeviceId();return Si({accountID:r?.identifier??"",deviceId:m,dismissedBanners:d,locale:l,rootId:u,selectedAccountAddresses:a,accessToken:o?.accessToken})};return L({queryKey:tt.actionBanners(r?.identifier,o?.accessToken),queryFn:i,enabled:!n&&!!r?.identifier,staleTime:ys})};s();c();var bn=()=>{let e=X(),{data:t}=L({queryKey:tt.appLaunchTimes(),queryFn:async()=>await e.get("appLaunchTimes")??[]});return t??[]};s();c();var hs=()=>{let e=X(),t=Y();return ct({mutationFn:async({actionBannerId:n})=>{di(e,n),t.setQueriesData({queryKey:[we]},r=>{if(!r)return;let i=r.banners.filter(a=>a.id!==n);return{...r,banners:i}})}})};s();c();s();c();var wo=I(E());s();c();s();c();var vn=()=>{let e=X(),{data:t}=L({queryKey:tt.lastOnboardedAt(),queryFn:async()=>await e.get("lastOnboardedAt")??-1});return t};var yi=()=>{let e=vn(),t=bn();if(t.length<2)return!0;if(e!==void 0){let[o,n]=t;if(e<o&&e<n)return!1}return!0};function Me(e,t,o){let{data:n,isSuccess:r}=yn(e),{data:i}=Ir(t?[t]:[]),a=i?.length===1?i[0]:!0,u=yi(),d=(0,wo.useCallback)(()=>o(),[o]);return(0,wo.useMemo)(()=>a&&r&&!n&&!u&&d(),[a,n,u,d,r])}s();c();var As=()=>{let e=X(),t=Y();return ct({mutationFn:async()=>{let o=Date.now(),r=[...(await e.get("appLaunchTimes")||[]).slice(-1),o];return e.set("appLaunchTimes",r)},onSuccess:()=>{t.invalidateQueries({queryKey:tt.appLaunchTimes()})}})};s();c();var bs=()=>{let e=X(),t=Y();return ct({mutationFn:()=>{let o=Date.now();return e.set("lastOnboardedAt",o)},onSuccess:()=>{t.invalidateQueries({queryKey:tt.lastOnboardedAt()})}})};s();c();var Rt=I(E());var wn={data:{feature:"arbitrum"}},vs=({onPrimaryAction:e,onSecondaryAction:t,image:o,condition:n=()=>!0})=>{let{t:r}=J(),{mutateAsync:i}=Mr(),[a]=Ur(["arbitrum"]),{mutate:u}=Ct("ArbitrumWelcome"),d=Me("ArbitrumWelcome","enable-arbitrum",()=>n()&&!a&&!so()),l=(0,Rt.useCallback)(async()=>{await i({chainIDs:["arbitrum"]}),e(),u()},[i,e,u]),m=(0,Rt.useCallback)(()=>{t(),u()},[t,u]),p=(0,Rt.useMemo)(()=>({title:r("interstitialArbitrumWelcomeTitle"),items:[{key:"arbitrumValueProp1",title:r("interstitialArbitrumWelcomeItemTitle_1"),icon:Rt.default.createElement(Qt,{icon:"InfoCircle",color:"spotBase",backgroundColor:"brandMidnight",shape:"square"}),description:r("interstitialArbitrumWelcomeItemDescription_1")},{key:"arbitrumValueProp2",title:r("interstitialArbitrumWelcomeItemTitle_2"),icon:Rt.default.createElement(Qt,{icon:"InfoCircle",color:"spotBase",backgroundColor:"brandMidnight",shape:"square"}),description:r("interstitialArbitrumWelcomeItemDescription_2")},{key:"arbitrumValueProp3",title:r("interstitialArbitrumWelcomeItemTitle_3"),icon:Rt.default.createElement(Qt,{icon:"InfoCircle",color:"spotBase",backgroundColor:"brandMidnight",shape:"square"}),description:r("interstitialArbitrumWelcomeItemDescription_3")}],primaryButton:{children:r("interstitialArbitrumWelcomePrimaryButtonText"),onAction:l,analyticsEvent:{event:"welcomeInterstitialPrimaryButtonClickedByUser",payload:wn}},secondaryButton:{children:r("commandNotNow"),onAction:m,analyticsEvent:{event:"welcomeInterstitialSecondaryButtonClickedByUser",payload:wn}},onDismiss:u,image:o,displayEvent:{event:"welcomeInterstitialSeen",payload:wn}}),[r,l,m,o,u]);return(0,Rt.useMemo)(()=>({interstitial:p,shouldShow:d}),[p,d])};s();c();var qt=I(E());var Tn={data:{feature:"staking"}},ws=({onPrimaryAction:e,onSecondaryAction:t,image:o,condition:n=()=>!0})=>{let{t:r}=J(),{mutate:i}=Ct("StakingWelcomeNew"),a=Me("StakingWelcomeNew","enable-psol-welcome-modal",()=>n()&&!so()),u=(0,qt.useCallback)(()=>{e(),i()},[e,i]),d=(0,qt.useCallback)(()=>{t(),i()},[t,i]),l=(0,qt.useMemo)(()=>({title:void 0,mobileTitleSheetInset:wr,items:[{key:"stakingValueProp1",title:r("stakingInterstitialWelcomeItemTitle_1"),icon:qt.default.createElement(Qt,{icon:"InfoCircle",color:"spotPositive",backgroundColor:"areaBase",shape:"square"}),description:r("stakingInterstitialWelcomeItemDescription_1")},{key:"stakingValueProp2",title:r("stakingInterstitialWelcomeItemTitle_2"),icon:qt.default.createElement(Qt,{icon:"TrendingUp",color:"spotPositive",backgroundColor:"areaBase",shape:"square"}),description:r("stakingInterstitialWelcomeItemDescription_2")},{key:"stakingValueProp3",title:r("stakingInterstitialWelcomeItemTitle_3"),icon:qt.default.createElement(Qt,{icon:"Shield",color:"spotPositive",backgroundColor:"areaBase",shape:"square"}),description:r("stakingInterstitialWelcomeItemDescription_3")}],primaryButton:{children:r("stakingInterstitialWelcomePrimaryButtonText"),onAction:u,analyticsEvent:{event:"welcomeInterstitialPrimaryButtonClickedByUser",payload:Tn},background:"spot",theme:"positive"},secondaryButton:{children:r("commandNotNow"),onAction:d,analyticsEvent:{event:"welcomeInterstitialSecondaryButtonClickedByUser",payload:Tn}},onDismiss:i,image:o,displayEvent:{event:"welcomeInterstitialSeen",payload:Tn},disclaimers:[r("mintStakeInfoPageDisclaimer1"),r("mintStakeInfoPageDisclaimer2_US")]}),[r,u,d,o,i]);return(0,qt.useMemo)(()=>({interstitial:l,shouldShow:a}),[l,a])};s();c();var ut=I(E());var Ts="https://phantom.com/terms",Ps="https://phantom.com/privacy",xs="https://phantom.com/terms-and-privacy-update",Is=({onConfirm:e,openUrl:t})=>{let{t:o}=J(),n=wt(),{mutate:r}=Ct("TermsOfServiceUpdate"),i=(0,ut.useCallback)(async()=>{r(),e()},[r,e]),a=(0,ut.useCallback)(d=>async()=>{await n.capture("termsOfServiceUpdateClick",{data:{uiContext:"interstitial"}}),await t(d)},[n,t]),u=(0,ut.useMemo)(()=>({title:o("interstitialTermsOfServiceUpdateTitle"),items:[],primaryButton:{children:o("commandContinue"),onAction:i,analyticsEvent:{event:"termsOfServiceUpdateAgreedByUser",payload:{data:{uiContext:"interstitial"}}}},image:"",displayEvent:{event:"termsOfServiceUpdateSeen",payload:{data:{uiContext:"interstitial"}}},description:ut.default.createElement(Ls,{openUrl:a}),dismissGestureDisabled:!0}),[o,i,a]);return(0,ut.useMemo)(()=>({interstitial:u}),[u])},Ls=({openUrl:e})=>ut.default.createElement(Z,{marginTop:24},ut.default.createElement(W,{font:"body",align:"center"},ut.default.createElement(pe,{i18nKey:"interstitialTermsOfServiceUpdateSubtitle"},"Please review our updated",ut.default.createElement(W,{onPress:e(Ts),color:"spotBase"},"Terms of Use"),"and",ut.default.createElement(W,{onPress:e(Ps),color:"spotBase"},"Privacy Policy"),". By continuing, you agree to the updated terms and policies.",ut.default.createElement(W,{onPress:e(xs),color:"spotBase"},"Learn More"),".")));s();c();var Pn=I(E());s();c();var xn=I(E());s();c();s();c();s();c();function Io(e,t,o,n){function r(i){return i instanceof o?i:new o(function(a){a(i)})}return new(o||(o=Promise))(function(i,a){function u(m){try{l(n.next(m))}catch(p){a(p)}}function d(m){try{l(n.throw(m))}catch(p){a(p)}}function l(m){m.done?i(m.value):r(m.value).then(u,d)}l((n=n.apply(e,t||[])).next())})}var Cs="ENTRIES",vi="KEYS",wi="VALUES",et="",Ue=class{constructor(t,o){let n=t._tree,r=Array.from(n.keys());this.set=t,this._type=o,this._path=r.length>0?[{node:n,keys:r}]:[]}next(){let t=this.dive();return this.backtrack(),t}dive(){if(this._path.length===0)return{done:!0,value:void 0};let{node:t,keys:o}=Te(this._path);if(Te(o)===et)return{done:!1,value:this.result()};let n=t.get(Te(o));return this._path.push({node:n,keys:Array.from(n.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;let t=Te(this._path).keys;t.pop(),!(t.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:t})=>Te(t)).filter(t=>t!==et).join("")}value(){return Te(this._path).node.get(et)}result(){switch(this._type){case wi:return this.value();case vi:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}},Te=e=>e[e.length-1],Es=(e,t,o)=>{let n=new Map;if(t===void 0)return n;let r=t.length+1,i=r+o,a=new Uint8Array(i*r).fill(o+1);for(let u=0;u<r;++u)a[u]=u;for(let u=1;u<i;++u)a[u*r]=u;return Ti(e,t,o,n,a,1,r,""),n},Ti=(e,t,o,n,r,i,a,u)=>{let d=i*a;t:for(let l of e.keys())if(l===et){let m=r[d-1];m<=o&&n.set(u,[e.get(l),m])}else{let m=i;for(let p=0;p<l.length;++p,++m){let g=l[p],S=a*m,y=S-a,k=r[S],A=Math.max(0,m-o-1),b=Math.min(a-1,m+o);for(let T=A;T<b;++T){let F=g!==t[T],x=r[y+T]+ +F,N=r[y+T+1]+1,R=r[S+T]+1,z=r[S+T+1]=Math.min(x,N,R);z<k&&(k=z)}if(k>o)continue t}Ti(e.get(l),t,o,n,r,m,a,u+l)}},Oe=class e{constructor(t=new Map,o=""){this._size=void 0,this._tree=t,this._prefix=o}atPrefix(t){if(!t.startsWith(this._prefix))throw new Error("Mismatched prefix");let[o,n]=Lo(this._tree,t.slice(this._prefix.length));if(o===void 0){let[r,i]=Un(n);for(let a of r.keys())if(a!==et&&a.startsWith(i)){let u=new Map;return u.set(a.slice(i.length),r.get(a)),new e(u,t)}}return new e(o,t)}clear(){this._size=void 0,this._tree.clear()}delete(t){return this._size=void 0,Fs(this._tree,t)}entries(){return new Ue(this,Cs)}forEach(t){for(let[o,n]of this)t(o,n,this)}fuzzyGet(t,o){return Es(this._tree,t,o)}get(t){let o=Fn(this._tree,t);return o!==void 0?o.get(et):void 0}has(t){let o=Fn(this._tree,t);return o!==void 0&&o.has(et)}keys(){return new Ue(this,vi)}set(t,o){if(typeof t!="string")throw new Error("key must be a string");return this._size=void 0,In(this._tree,t).set(et,o),this}get size(){if(this._size)return this._size;this._size=0;let t=this.entries();for(;!t.next().done;)this._size+=1;return this._size}update(t,o){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;let n=In(this._tree,t);return n.set(et,o(n.get(et))),this}fetch(t,o){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;let n=In(this._tree,t),r=n.get(et);return r===void 0&&n.set(et,r=o()),r}values(){return new Ue(this,wi)}[Symbol.iterator](){return this.entries()}static from(t){let o=new e;for(let[n,r]of t)o.set(n,r);return o}static fromObject(t){return e.from(Object.entries(t))}},Lo=(e,t,o=[])=>{if(t.length===0||e==null)return[e,o];for(let n of e.keys())if(n!==et&&t.startsWith(n))return o.push([e,n]),Lo(e.get(n),t.slice(n.length),o);return o.push([e,t]),Lo(void 0,"",o)},Fn=(e,t)=>{if(t.length===0||e==null)return e;for(let o of e.keys())if(o!==et&&t.startsWith(o))return Fn(e.get(o),t.slice(o.length))},In=(e,t)=>{let o=t.length;t:for(let n=0;e&&n<o;){for(let i of e.keys())if(i!==et&&t[n]===i[0]){let a=Math.min(o-n,i.length),u=1;for(;u<a&&t[n+u]===i[u];)++u;let d=e.get(i);if(u===i.length)e=d;else{let l=new Map;l.set(i.slice(u),d),e.set(t.slice(n,n+u),l),e.delete(i),e=l}n+=u;continue t}let r=new Map;return e.set(t.slice(n),r),r}return e},Fs=(e,t)=>{let[o,n]=Lo(e,t);if(o!==void 0){if(o.delete(et),o.size===0)Pi(n);else if(o.size===1){let[r,i]=o.entries().next().value;xi(n,r,i)}}},Pi=e=>{if(e.length===0)return;let[t,o]=Un(e);if(t.delete(o),t.size===0)Pi(e.slice(0,-1));else if(t.size===1){let[n,r]=t.entries().next().value;n!==et&&xi(e.slice(0,-1),n,r)}},xi=(e,t,o)=>{if(e.length===0)return;let[n,r]=Un(e);n.set(r+t,o),n.delete(r)},Un=e=>e[e.length-1],On="or",Ii="and",_s="and_not",Be=class e{constructor(t){if(t?.fields==null)throw new Error('MiniSearch: option "fields" must be provided');let o=t.autoVacuum==null||t.autoVacuum===!0?En:t.autoVacuum;this._options=Object.assign(Object.assign(Object.assign({},Cn),t),{autoVacuum:o,searchOptions:Object.assign(Object.assign({},ki),t.searchOptions||{}),autoSuggestOptions:Object.assign(Object.assign({},Ns),t.autoSuggestOptions||{})}),this._index=new Oe,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Mn,this.addFields(this._options.fields)}add(t){let{extractField:o,tokenize:n,processTerm:r,fields:i,idField:a}=this._options,u=o(t,a);if(u==null)throw new Error(`MiniSearch: document does not have ID field "${a}"`);if(this._idToShortId.has(u))throw new Error(`MiniSearch: duplicate ID ${u}`);let d=this.addDocumentId(u);this.saveStoredFields(d,t);for(let l of i){let m=o(t,l);if(m==null)continue;let p=n(m.toString(),l),g=this._fieldIds[l],S=new Set(p).size;this.addFieldLength(d,g,this._documentCount-1,S);for(let y of p){let k=r(y,l);if(Array.isArray(k))for(let A of k)this.addTerm(g,d,A);else k&&this.addTerm(g,d,k)}}}addAll(t){for(let o of t)this.add(o)}addAllAsync(t,o={}){let{chunkSize:n=10}=o,r={chunk:[],promise:Promise.resolve()},{chunk:i,promise:a}=t.reduce(({chunk:u,promise:d},l,m)=>(u.push(l),(m+1)%n===0?{chunk:[],promise:d.then(()=>new Promise(p=>setTimeout(p,0))).then(()=>this.addAll(u))}:{chunk:u,promise:d}),r);return a.then(()=>this.addAll(i))}remove(t){let{tokenize:o,processTerm:n,extractField:r,fields:i,idField:a}=this._options,u=r(t,a);if(u==null)throw new Error(`MiniSearch: document does not have ID field "${a}"`);let d=this._idToShortId.get(u);if(d==null)throw new Error(`MiniSearch: cannot remove document with ID ${u}: it is not in the index`);for(let l of i){let m=r(t,l);if(m==null)continue;let p=o(m.toString(),l),g=this._fieldIds[l],S=new Set(p).size;this.removeFieldLength(d,g,this._documentCount,S);for(let y of p){let k=n(y,l);if(Array.isArray(k))for(let A of k)this.removeTerm(g,d,A);else k&&this.removeTerm(g,d,k)}}this._storedFields.delete(d),this._documentIds.delete(d),this._idToShortId.delete(u),this._fieldLength.delete(d),this._documentCount-=1}removeAll(t){if(t)for(let o of t)this.remove(o);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new Oe,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(t){let o=this._idToShortId.get(t);if(o==null)throw new Error(`MiniSearch: cannot discard document with ID ${t}: it is not in the index`);this._idToShortId.delete(t),this._documentIds.delete(o),this._storedFields.delete(o),(this._fieldLength.get(o)||[]).forEach((n,r)=>{this.removeFieldLength(o,r,this._documentCount,n)}),this._fieldLength.delete(o),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;let{minDirtFactor:t,minDirtCount:o,batchSize:n,batchWait:r}=this._options.autoVacuum;this.conditionalVacuum({batchSize:n,batchWait:r},{minDirtCount:o,minDirtFactor:t})}discardAll(t){let o=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(let n of t)this.discard(n)}finally{this._options.autoVacuum=o}this.maybeAutoVacuum()}replace(t){let{idField:o,extractField:n}=this._options,r=n(t,o);this.discard(r),this.add(t)}vacuum(t={}){return this.conditionalVacuum(t)}conditionalVacuum(t,o){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&o,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{let n=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=Mn,this.performVacuuming(t,n)}),this._enqueuedVacuum)):this.vacuumConditionsMet(o)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(t),this._currentVacuum)}performVacuuming(t,o){return Io(this,void 0,void 0,function*(){let n=this._dirtCount;if(this.vacuumConditionsMet(o)){let r=t.batchSize||_n.batchSize,i=t.batchWait||_n.batchWait,a=1;for(let[u,d]of this._index){for(let[l,m]of d)for(let[p]of m)this._documentIds.has(p)||(m.size<=1?d.delete(l):m.delete(p));this._index.get(u).size===0&&this._index.delete(u),a%r===0&&(yield new Promise(l=>setTimeout(l,i))),a+=1}this._dirtCount-=n}yield null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null})}vacuumConditionsMet(t){if(t==null)return!0;let{minDirtCount:o,minDirtFactor:n}=t;return o=o||En.minDirtCount,n=n||En.minDirtFactor,this.dirtCount>=o&&this.dirtFactor>=n}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(t){return this._idToShortId.has(t)}getStoredFields(t){let o=this._idToShortId.get(t);if(o!=null)return this._storedFields.get(o)}search(t,o={}){let{searchOptions:n}=this._options,r=Object.assign(Object.assign({},n),o),i=this.executeQuery(t,o),a=[];for(let[u,{score:d,terms:l,match:m}]of i){let p=l.length||1,g={id:this._documentIds.get(u),score:d*p,terms:Object.keys(m),queryTerms:l,match:m};Object.assign(g,this._storedFields.get(u)),(r.filter==null||r.filter(g))&&a.push(g)}return t===e.wildcard&&r.boostDocument==null||a.sort(Ai),a}autoSuggest(t,o={}){o=Object.assign(Object.assign({},this._options.autoSuggestOptions),o);let n=new Map;for(let{score:i,terms:a}of this.search(t,o)){let u=a.join(" "),d=n.get(u);d!=null?(d.score+=i,d.count+=1):n.set(u,{score:i,terms:a,count:1})}let r=[];for(let[i,{score:a,terms:u,count:d}]of n)r.push({suggestion:i,terms:u,score:a/d});return r.sort(Ai),r}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(t,o){if(o==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(t),o)}static loadJSONAsync(t,o){return Io(this,void 0,void 0,function*(){if(o==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(t),o)})}static getDefault(t){if(Cn.hasOwnProperty(t))return Ln(Cn,t);throw new Error(`MiniSearch: unknown option "${t}"`)}static loadJS(t,o){let{index:n,documentIds:r,fieldLength:i,storedFields:a,serializationVersion:u}=t,d=this.instantiateMiniSearch(t,o);d._documentIds=Po(r),d._fieldLength=Po(i),d._storedFields=Po(a);for(let[l,m]of d._documentIds)d._idToShortId.set(m,l);for(let[l,m]of n){let p=new Map;for(let g of Object.keys(m)){let S=m[g];u===1&&(S=S.ds),p.set(parseInt(g,10),Po(S))}d._index.set(l,p)}return d}static loadJSAsync(t,o){return Io(this,void 0,void 0,function*(){let{index:n,documentIds:r,fieldLength:i,storedFields:a,serializationVersion:u}=t,d=this.instantiateMiniSearch(t,o);d._documentIds=yield xo(r),d._fieldLength=yield xo(i),d._storedFields=yield xo(a);for(let[m,p]of d._documentIds)d._idToShortId.set(p,m);let l=0;for(let[m,p]of n){let g=new Map;for(let S of Object.keys(p)){let y=p[S];u===1&&(y=y.ds),g.set(parseInt(S,10),yield xo(y))}++l%1e3===0&&(yield Li(0)),d._index.set(m,g)}return d})}static instantiateMiniSearch(t,o){let{documentCount:n,nextId:r,fieldIds:i,averageFieldLength:a,dirtCount:u,serializationVersion:d}=t;if(d!==1&&d!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");let l=new e(o);return l._documentCount=n,l._nextId=r,l._idToShortId=new Map,l._fieldIds=i,l._avgFieldLength=a,l._dirtCount=u||0,l._index=new Oe,l}executeQuery(t,o={}){if(t===e.wildcard)return this.executeWildcardQuery(o);if(typeof t!="string"){let g=Object.assign(Object.assign(Object.assign({},o),t),{queries:void 0}),S=t.queries.map(y=>this.executeQuery(y,g));return this.combineResults(S,g.combineWith)}let{tokenize:n,processTerm:r,searchOptions:i}=this._options,a=Object.assign(Object.assign({tokenize:n,processTerm:r},i),o),{tokenize:u,processTerm:d}=a,p=u(t).flatMap(g=>d(g)).filter(g=>!!g).map(Bs(a)).map(g=>this.executeQuerySpec(g,a));return this.combineResults(p,a.combineWith)}executeQuerySpec(t,o){let n=Object.assign(Object.assign({},this._options.searchOptions),o),r=(n.fields||this._options.fields).reduce((k,A)=>Object.assign(Object.assign({},k),{[A]:Ln(n.boost,A)||1}),{}),{boostDocument:i,weights:a,maxFuzzy:u,bm25:d}=n,{fuzzy:l,prefix:m}=Object.assign(Object.assign({},ki.weights),a),p=this._index.get(t.term),g=this.termResults(t.term,t.term,1,t.termBoost,p,r,i,d),S,y;if(t.prefix&&(S=this._index.atPrefix(t.term)),t.fuzzy){let k=t.fuzzy===!0?.2:t.fuzzy,A=k<1?Math.min(u,Math.round(t.term.length*k)):k;A&&(y=this._index.fuzzyGet(t.term,A))}if(S)for(let[k,A]of S){let b=k.length-t.term.length;if(!b)continue;y?.delete(k);let T=m*k.length/(k.length+.3*b);this.termResults(t.term,k,T,t.termBoost,A,r,i,d,g)}if(y)for(let k of y.keys()){let[A,b]=y.get(k);if(!b)continue;let T=l*k.length/(k.length+b);this.termResults(t.term,k,T,t.termBoost,A,r,i,d,g)}return g}executeWildcardQuery(t){let o=new Map,n=Object.assign(Object.assign({},this._options.searchOptions),t);for(let[r,i]of this._documentIds){let a=n.boostDocument?n.boostDocument(i,"",this._storedFields.get(r)):1;o.set(r,{score:a,terms:[],match:{}})}return o}combineResults(t,o=On){if(t.length===0)return new Map;let n=o.toLowerCase(),r=Ms[n];if(!r)throw new Error(`Invalid combination operator: ${o}`);return t.reduce(r)||new Map}toJSON(){let t=[];for(let[o,n]of this._index){let r={};for(let[i,a]of n)r[i]=Object.fromEntries(a);t.push([o,r])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:t,serializationVersion:2}}termResults(t,o,n,r,i,a,u,d,l=new Map){if(i==null)return l;for(let m of Object.keys(a)){let p=a[m],g=this._fieldIds[m],S=i.get(g);if(S==null)continue;let y=S.size,k=this._avgFieldLength[g];for(let A of S.keys()){if(!this._documentIds.has(A)){this.removeTerm(g,A,o),y-=1;continue}let b=u?u(this._documentIds.get(A),o,this._storedFields.get(A)):1;if(!b)continue;let T=S.get(A),F=this._fieldLength.get(A)[g],x=Os(T,y,this._documentCount,F,k,d),N=n*r*p*b*x,R=l.get(A);if(R){R.score+=N,Ds(R.terms,t);let z=Ln(R.match,o);z?z.push(m):R.match[o]=[m]}else l.set(A,{score:N,terms:[t],match:{[o]:[m]}})}}return l}addTerm(t,o,n){let r=this._index.fetch(n,bi),i=r.get(t);if(i==null)i=new Map,i.set(o,1),r.set(t,i);else{let a=i.get(o);i.set(o,(a||0)+1)}}removeTerm(t,o,n){if(!this._index.has(n)){this.warnDocumentChanged(o,t,n);return}let r=this._index.fetch(n,bi),i=r.get(t);i==null||i.get(o)==null?this.warnDocumentChanged(o,t,n):i.get(o)<=1?i.size<=1?r.delete(t):i.delete(o):i.set(o,i.get(o)-1),this._index.get(n).size===0&&this._index.delete(n)}warnDocumentChanged(t,o,n){for(let r of Object.keys(this._fieldIds))if(this._fieldIds[r]===o){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(t)} has changed before removal: term "${n}" was not present in field "${r}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(t){let o=this._nextId;return this._idToShortId.set(t,o),this._documentIds.set(o,t),this._documentCount+=1,this._nextId+=1,o}addFields(t){for(let o=0;o<t.length;o++)this._fieldIds[t[o]]=o}addFieldLength(t,o,n,r){let i=this._fieldLength.get(t);i==null&&this._fieldLength.set(t,i=[]),i[o]=r;let u=(this._avgFieldLength[o]||0)*n+r;this._avgFieldLength[o]=u/(n+1)}removeFieldLength(t,o,n,r){if(n===1){this._avgFieldLength[o]=0;return}let i=this._avgFieldLength[o]*n-r;this._avgFieldLength[o]=i/(n-1)}saveStoredFields(t,o){let{storeFields:n,extractField:r}=this._options;if(n==null||n.length===0)return;let i=this._storedFields.get(t);i==null&&this._storedFields.set(t,i={});for(let a of n){let u=r(o,a);u!==void 0&&(i[a]=u)}}};Be.wildcard=Symbol("*");var Ln=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0,Ms={[On]:(e,t)=>{for(let o of t.keys()){let n=e.get(o);if(n==null)e.set(o,t.get(o));else{let{score:r,terms:i,match:a}=t.get(o);n.score=n.score+r,n.match=Object.assign(n.match,a),hi(n.terms,i)}}return e},[Ii]:(e,t)=>{let o=new Map;for(let n of t.keys()){let r=e.get(n);if(r==null)continue;let{score:i,terms:a,match:u}=t.get(n);hi(r.terms,a),o.set(n,{score:r.score+i,terms:r.terms,match:Object.assign(r.match,u)})}return o},[_s]:(e,t)=>{for(let o of t.keys())e.delete(o);return e}},Us={k:1.2,b:.7,d:.5},Os=(e,t,o,n,r,i)=>{let{k:a,b:u,d}=i;return Math.log(1+(o-t+.5)/(t+.5))*(d+e*(a+1)/(e+a*(1-u+u*n/r)))},Bs=e=>(t,o,n)=>{let r=typeof e.fuzzy=="function"?e.fuzzy(t,o,n):e.fuzzy||!1,i=typeof e.prefix=="function"?e.prefix(t,o,n):e.prefix===!0,a=typeof e.boostTerm=="function"?e.boostTerm(t,o,n):1;return{term:t,fuzzy:r,prefix:i,termBoost:a}},Cn={idField:"id",extractField:(e,t)=>e[t],tokenize:e=>e.split(Rs),processTerm:e=>e.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(e,t)=>{typeof console?.[e]=="function"&&console[e](t)},autoVacuum:!0},ki={combineWith:On,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:Us},Ns={combineWith:Ii,prefix:(e,t,o)=>t===o.length-1},_n={batchSize:1e3,batchWait:10},Mn={minDirtFactor:.1,minDirtCount:20},En=Object.assign(Object.assign({},_n),Mn),Ds=(e,t)=>{e.includes(t)||e.push(t)},hi=(e,t)=>{for(let o of t)e.includes(o)||e.push(o)},Ai=({score:e},{score:t})=>t-e,bi=()=>new Map,Po=e=>{let t=new Map;for(let o of Object.keys(e))t.set(parseInt(o,10),e[o]);return t},xo=e=>Io(void 0,void 0,void 0,function*(){let t=new Map,o=0;for(let n of Object.keys(e))t.set(parseInt(n,10),e[n]),++o%1e3===0&&(yield Li(0));return t}),Li=e=>new Promise(t=>setTimeout(t,e)),Rs=/[\n\r\p{Z}\p{P}]+/u;var Ne=I(E()),Wf=(e,t,o,n=!1)=>{let r=(0,Ne.useMemo)(()=>n?null:new ei(e,o),[e,o,n]);return(0,Ne.useMemo)(()=>n||!r?e:t?r.search(t).map(a=>a.item):e,[r,e,t,n])},zf=(e,t,o,n=!1)=>{let r=(0,Ne.useMemo)(()=>{if(n)return null;let a=new Be(o);return a.addAll(e),a},[e,o,n]);return(0,Ne.useMemo)(()=>n||!r?e:t?r.search(t).map(a=>a):e,[r,e,t,n])};s();c();var Se=(e,t)=>{let o=t?.format??"0,0.00%";return`${(t?.includePlusPrefix??!1)&&e>0?"+":""}${(0,Qr.default)(e).format(e===0?"0%":o)}`};s();c();s();c();var Co=I(ds(),1);var Ei=I(gr(),1);var Ci=(0,Co.struct)([(0,Co.u8)("instruction"),Dr("amount")]);function Bn(e,t,o,n,r=[],i=be){let a=qr([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1}],o,r),u=Buffer.alloc(Ci.span);return Ci.encode({instruction:Rr.Approve,amount:BigInt(n)},u),new Ei.TransactionInstruction({keys:a,programId:i,data:u})}var Fi=new h.PublicKey("Config1111111111111111111111111111111111111"),Vs="https://docs.solana.com/staking",Ks="https://help.phantom.com/hc/en-us/articles/4406379756307-Why-is-my-stake-still-activating-or-deactivating",dt={type:"SolanaNative",data:{amount:"0",balance:new j(0),chain:{id:M.solana.mainnetID,imageUrl:M.solana.iconUrl,name:M.solana.name,symbol:M.solana.tokenSymbol},decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:"NOT_VERIFIED"}},_i=new Map([[St.Solana.Mainnet,dt]]);var Nn="https://www.jito.network/staking/?mode=unstake",Dn="https://help.phantom.com/hc/en-us/articles/29846774040467",Ws="https://www.jito.network/blog/reward-bearing-vs-rebasing-solana-liquid-staking-tokens/",Rn="https://help.phantom.com/hc/en-us/articles/41210373532307";var qn="https://app.kamino.finance/lending/reserve/7u3HeHxYDLhnCoErrtycNokbQYbWGzLs6JSDqGAv5PfF/HV9KsS5mB4b9CFhDJVKdfxWBAomYfUk5PeUsdgMQsUrB",re="solana:101/address:J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn",Eo=4e6,De=2282880;s();c();var Re=C.object({apy:C.number()}),zs=C.object({validators:C.array(C.string())}),Mi=C.object({epoch:C.number(),effectiveSlot:C.number(),amount:C.number(),postBalance:C.number(),percentChange:C.number(),apr:C.number(),timestamp:C.number()}),Qs=C.object({items:C.array(Mi)}),Gs=C.object({address:C.string(),chainId:un,decimals:C.number(),logoURI:C.string(),name:C.string(),symbol:C.string()}),Hs=C.object({caip19:C.string(),metadata:Gs}),js=C.object({vote_account:C.string()}),Js=C.object({apy:C.string(),totalRewardsFeePercentage:C.string().optional(),chainId:un,convertRatio:C.string(),name:C.string(),stakePoolAddress:C.string(),stakePoolTokenMetadata:Hs,validators:C.array(js)}),Ui=C.record(C.string(),C.array(Js)),gS=C.object({totalStaked:C.string(),rewards:C.string()}),qe=e=>e==="inactive",Ve=e=>e==="active"||e==="activating";s();c();function Oi(e,t){let o=new V(e/100),n=new V(t/100);return o.minus(o.times(n)).times(100).decimalPlaces(2).toNumber()}s();c();s();c();s();c();var $="staking";var Vn=[$,"stakeAccounts"],Kn=[$,"stakeActivationData"],Wn=[$,"convertStakeAccountList"],zn=[$,"convertStakeTransaction"],Qn=[$,"mintTokenTransaction"],$s=[$,"withdrawLiquidStakeTransaction"],Ys=[$,"deactivateStakeTransaction"],Gn="averageValidatorApy",Xs="recommendedValidators",Zs="signatureStatus",tc="stakeAccountMinBalance",ec="stakeRewardsHistory",oc="stakeApy",nc="validatorInfo",rc="voteAccounts",ic="keybaseUserAvatar",ac="epochTimeRemaining",U={keybaseUserAvatar(e){return[$,ic,e]},signatureStatus(e){return[$,Zs,e]},stakeAccounts(e,t){return[...Vn,e,t]},stakeAccountMinBalance(){return[$,tc]},stakeActivationData(e){return[...Kn,e]},stakeRewardsHistory(e){return[$,ec,e]},stakeApy(){return[$,oc]},averageValidatorApy(){return[$,Gn]},recommendedValidators(){return[$,Xs]},validatorInfo(){return[$,nc]},voteAccounts(e){return[$,rc,e]},convertStakeAccountList(e,t){return[...Wn,e,t]},liquidStakingSupportedTokens(){return[$,"liquidStakingSupportedTokens"]},getConvertStakeTransaction(e){return[...zn,e]},getMintTokenTransaction(e){return[...Qn,e]},getWithdrawLiquidStakeTransaction(e){return[...$s,e]},featureUsed(){return[$,"featureUsed"]},epochTimeRemaining(e){return[$,ac,e]},getDeactivateStakeTransaction(e){return[...Ys,e]}};var Ke=e=>()=>{e.invalidateQueries({predicate:t=>{let o=n=>n.every((r,i)=>t.queryKey[i]===r);return o(Vn)||o(Kn)||o(Wn)||o(zn)||o(Qn)}})};s();c();function Fo(e,t=9){return e.match(new RegExp(`^\\d*(\\.\\d{0,${t}})?$`))}s();c();var Bi={type:"fungible",isNativeOfType:"sol",chain:"solana",name:"Solana",symbol:"SOL",iconUrl:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",decimals:9},sc="stake",Ni=e=>new Hn(e,sc),Hn=class extends ve{createStakeAccountAndDelegateStake=t=>{this.analytics.capture("createStakeAccountAndDelegateStake",{data:{...t,...Bi}})};deactivateStake=()=>{this.analytics.capture("deactivateStake",{data:{...Bi}})}};var jn=Or(wt,e=>Ni(e));s();c();var _o=I(E());s();c();var Ri=(e,t)=>e+t[1];function qi(e){let t=cc(e),o={commissionWeight:.6,epochCreditsWeight:.1,activatedStakeWeight:.3},n=dc(t.maxEpochCredits,t.maxActivatedStake,o);return e.sort(n)}function cc(e){let t={maxEpochCredits:0,maxActivatedStake:0};for(let o of e){let n=o.epochCredits.reduce(Ri,0);t.maxEpochCredits<n&&(t.maxEpochCredits=n),t.maxActivatedStake<o.activatedStake&&(t.maxActivatedStake=o.activatedStake)}return t}function uc(e,t,o,n,r){let i=(100-e)/100,a=t/o,u=Math.log10(n+1)/Math.log10(r+1);return{normalizedCommission:i,normalizedEpochCredits:a,normalizedActivatedStake:u}}function Di(e,t,o,n){let{commission:r,epochCredits:i,activatedStake:a}=e,{commissionWeight:u,epochCreditsWeight:d,activatedStakeWeight:l}=n,{normalizedCommission:m,normalizedEpochCredits:p,normalizedActivatedStake:g}=uc(r,i.reduce(Ri,0),t,a,o);return(r>10?.5:1)*(u*m+d*p+l*g)}function dc(e,t,o){return(n,r)=>{let i=Di(n,e,t,o);return Di(r,e,t,o)-i}}s();c();s();c();var We=(r=>(r[r.Always=1/0]="Always",r[r.Short=K({days:1})]="Short",r[r.Medium=K({days:3})]="Medium",r[r.Long=K({days:7})]="Long",r))(We||{}),lt=(i=>(i[i.Immediate=0]="Immediate",i[i.Short=K({minutes:1})]="Short",i[i.Medium=K({minutes:2.5})]="Medium",i[i.Long=K({minutes:5})]="Long",i[i.Never=1/0]="Never",i))(lt||{});var lc=e=>async()=>(await e.getParsedProgramAccounts(Fi)).reduce((o,n)=>{if(n.account.data.parsed?.type!=="validatorInfo")return o;let r=n.pubkey.toString(),i=n.account.data.parsed.info.keys,[,a]=i;if(!a.signer)return o;let u=a.pubkey,d=n.account.data.parsed.info.configData;return o.push({identityPubkey:u,infoPubkey:r,info:d}),o},[]);function Jn(e){let t=U.validatorInfo(),o=lc(e);return L({queryKey:t,queryFn:o,placeholderData:[],staleTime:1/0})}s();c();var pc=async e=>{let t=await e.getVoteAccounts();return[...t.current,...t.delinquent].map(o=>({identityPubkey:o.nodePubkey,voteAccountPubkey:o.votePubkey,commission:o.commission,lastVote:o.lastVote,epochCredits:o.epochCredits,activatedStake:o.activatedStake})).filter(o=>o.commission<99)};function $n(e){let t=U.voteAccounts(e.rpcEndpoint);return L({queryKey:t,queryFn:async()=>pc(e),placeholderData:[],staleTime:1/0})}function Pe(e){let{isFetched:t,isFetching:o,isPending:n,isSuccess:r,isError:i,dataUpdatedAt:a,errorUpdatedAt:u,error:d,refetch:l,data:m}=$n(e),p=Math.max(a,u),{isFetched:g,isFetching:S,isPending:y,isSuccess:k,isError:A,dataUpdatedAt:b,errorUpdatedAt:T,error:F,refetch:x,data:N}=Jn(e),R=Math.max(b,T),z=Math.max(p,R),_=t&&g,ot=o||S,at=r||k,nt=i||A,rt=d||F,It=n||y,Bt=(0,_o.useCallback)(async()=>{Promise.all([l(),x()])},[x,l]);return{results:(0,_o.useMemo)(()=>{if(!m)return[];if(!N)return[];let Jt=qi(m),Wt=new Map(Jt.map(q=>[q.identityPubkey,q])),$t=new Map(N.map(q=>[q.identityPubkey,q])),zt=[];for(let[q,At]of Wt){let H=$t.get(q);zt.push({...At,...H})}return zt},[N,m]),dataUpdatedAt:z,error:rt,isSuccess:at,isError:nt,isFetched:_,isFetching:ot,isPending:It,refetch:Bt}}s();c();function Yn(e){let t=!!e?.info.meta.lockup,o=new Date((e?.info.meta.lockup?.unixTimestamp??0)*1e3);return t&&o.getTime()>Date.now()}s();c();var Bo=I(E());s();c();var Qi=I(E());s();c();var mc="https://keybase.io/_/api/1.0/user/pic_url.json",Mo=async e=>{let t=await vt.get(`${mc}?username=${encodeURIComponent(e)}`);if(!Zt(t)||t.data.status?.code!==0)throw new Error("Couldn't fetch keybase user avatar");return t.data.pic_url};s();c();s();c();s();c();function Uo(e,t){for(let o of t)if(o.epoch===e)return o;return null}var Vi=.09;function fc(e,t,o){if(e.activationEpoch===e.deactivationEpoch)return{effective:BigInt(0),activating:BigInt(0)};if(t===e.activationEpoch)return{effective:BigInt(0),activating:e.stake};if(t<e.activationEpoch)return{effective:BigInt(0),activating:BigInt(0)};let n=e.activationEpoch,r=Uo(n,o);if(r!==null){let i=BigInt(0);for(;r!==null;){n++;let a=e.stake-i,u=Number(a)/Number(r.activating),d=Number(r.effective)*Vi,l=BigInt(Math.max(1,Math.round(u*d)));if(i+=l,i>=e.stake){i=e.stake;break}if(n>=t||n>=e.deactivationEpoch)break;r=Uo(n,o)}return{effective:i,activating:e.stake-i}}else return{effective:e.stake,activating:BigInt(0)}}function Ki(e,t,o){let{effective:n,activating:r}=fc(e,t,o);if(t<e.deactivationEpoch)return{effective:n,activating:r,deactivating:BigInt(0)};if(t==e.deactivationEpoch)return{effective:n,activating:BigInt(0),deactivating:n};let i=e.deactivationEpoch,a=Uo(i,o);if(a!==null){let u=n;for(;a!==null&&(i++,a.deactivating!==BigInt(0));){let d=Number(u)/Number(a.deactivating),l=Number(a.effective)*Vi,m=BigInt(Math.max(1,Math.round(d*l)));if(u-=m,u<=0){u=BigInt(0);break}if(i>=t)break;a=Uo(i,o)}return{effective:u,deactivating:u,activating:BigInt(0)}}else return{effective:BigInt(0),activating:BigInt(0),deactivating:BigInt(0)}}s();c();var Wi=function(e){if(e.value===null||e.value.data instanceof Buffer)throw new Error("Account not found");let t=[];return e.value.data.parsed.info.forEach(o=>{t.push({epoch:BigInt(o.epoch),effective:BigInt(o.stakeHistory.effective),activating:BigInt(o.stakeHistory.activating),deactivating:BigInt(o.stakeHistory.deactivating)})}),t},zi=function(e){let t=BigInt(0);if(e.value===null||e.value.data instanceof Buffer)throw new Error("Account not found");return e.value.data.parsed.type==="delegated"&&(t=BigInt(1)),{discriminant:t,meta:{rentExemptReserve:BigInt(e.value.data.parsed.info.meta.rentExemptReserve),authorized:{staker:e.value.data.parsed.info.meta.authorized.staker,withdrawer:e.value.data.parsed.info.meta.authorized.withdrawer},lockup:{unixTimestamp:BigInt(e.value.data.parsed.info.meta.lockup.unixTimestamp),epoch:BigInt(e.value.data.parsed.info.meta.lockup.epoch),custodian:e.value.data.parsed.info.meta.lockup.custodian}},stake:{delegation:{voterPubkey:e.value.data.parsed.info.stake.delegation.voterPubkey,stake:BigInt(e.value.data.parsed.info.stake.delegation.stake),activationEpoch:BigInt(e.value.data.parsed.info.stake.delegation.activationEpoch),deactivationEpoch:BigInt(e.value.data.parsed.info.stake.delegation.deactivationEpoch)},creditsObserved:BigInt(e.value.data.parsed.info.stake.creditsObserved)}}};async function ze(e,t){let o=new h.PublicKey("SysvarStakeHistory1111111111111111111111111"),n=await e.getParsedAccountInfo(t);if(n===null||n.value===null)throw new Error("Account not found");let r=await e.getParsedAccountInfo(o);if(r===null)throw new Error("StakeHistory not found");let i=Wi(r),a=await e.getEpochInfo(),u=zi(n),{effective:d,activating:l,deactivating:m}=Ki(u.stake.delegation,BigInt(a.epoch),i),p;m>0?p="deactivating":l>0?p="activating":d>0?p="active":p="inactive";let g=BigInt(n.value.lamports)-d-u.meta.rentExemptReserve;return{state:p,active:Number(d),inactive:Number(g)}}var Sc=e=>{let t=[];return e.ownerPublicKey&&t.push({memcmp:{offset:44,bytes:e.ownerPublicKey}}),e.voteAccountPublicKey&&t.push({dataSize:200},{memcmp:{offset:124,bytes:e.voteAccountPublicKey}}),t},Gi=async(e,t,o)=>{let n=Sc(t),r=await e.getParsedProgramAccounts(h.StakeProgram.programId,{filters:n}),a=(await Promise.allSettled(r.map(l=>ze(e,l.pubkey)))).map(l=>{if(l.status==="fulfilled")return l.value.state}),d=(await Promise.allSettled(r.map(l=>{let m=l.account.data?.parsed?.info?.stake?.delegation?.voter,p=o.get(m),g=p?.info?.keybaseUsername,S=p?.info?.iconUrl;return S?new Promise(y=>y(S)):g?Mo(g):new Promise(y=>y(null))}))).map(l=>{if(l.status==="fulfilled"&&l.value!==null)return l.value});return r.map((l,m)=>({pubkey:l.pubkey.toString(),lamports:l.account.lamports,activationState:a[m],imageUri:d[m],...l.account.data.parsed}))},Hi=(e,t)=>U.convertStakeAccountList(e,t),gc=(e,t,o)=>()=>Gi(e,{ownerPublicKey:t},o);function ji(e,t,o,n=!0){let r=Hi(t,e.rpcEndpoint),i=gc(e,t,o);return L({queryKey:r,queryFn:i,enabled:!!t&&n,staleTime:1/0})}var Ji=(e,t,o,n)=>{let r=Y();return(0,Qi.useCallback)(async()=>{n&&await r.prefetchQuery({queryKey:Hi(t,e.rpcEndpoint),queryFn:()=>Gi(e,{ownerPublicKey:t},o)})},[r,t,e,o,n])};s();c();var Pt=I(E()),Oo=null,yc=e=>{if(!Oo&&e){let t="liquidStake";Oo=new ve(e,t)}if(!Oo)throw new Error("liquidStakeAnalytics was not properly configured");return Oo},Ft=()=>{let e=wt(),t=yc(e),o=(0,Pt.useCallback)((S,y)=>{e.capture("liquidStakingConvertAccountClicked",{data:{stake:{validatorName:S,stakeAccountBalance:y}}})},[e]),n=(0,Pt.useCallback)(S=>{e.capture("liquidStakingConvertAccountListSeen",{data:{stake:{stakeAccounts:S}}})},[e]),r=(0,Pt.useCallback)(()=>{e.capture("liquidStakingConvertBannerClicked")},[e]),i=(0,Pt.useCallback)(()=>{e.capture("liquidStakingConvertBannerSeen")},[e]),a=(0,Pt.useCallback)(()=>{e.capture("liquidStakingConvertModalContinue")},[e]),u=(0,Pt.useCallback)(()=>{e.capture("liquidStakingConvertModalNotNow")},[e]),d=(0,Pt.useCallback)(({provider:S,convertDetails:y,amount:k,fromAmount:A,toAmount:b,fromAmountUSD:T,toAmountUSD:F})=>{e.capture("liquidStakingConvertApprovedByUser",{data:{stake:{stakePoolAddress:S?.stakePoolAddress,token:S?.stakePoolTokenMetadata.metadata.name,fromAmount:A,toAmount:b,fromAmountUSD:T,toAmountUSD:F,apy:S?.apy,convertRatio:S?.convertRatio,caip19:S?.stakePoolTokenMetadata.caip19,validatorName:y?.validatorName,stakeAccountBalance:k}}})},[e]),l=(0,Pt.useCallback)(S=>{t.submittedTransaction(S,{chainType:"solana",chainName:"solana",networkId:"mainnet",method:"signAndSendTransaction"})},[t]),m=(0,Pt.useCallback)(({amount:S,convertDetails:y,provider:k})=>{e.capture("liquidStakingConvertSuccess",{data:{stake:{apy:k?.apy,convertRatio:k?.convertRatio,caip19:k?.stakePoolTokenMetadata.caip19,stakePoolAddress:k?.stakePoolAddress,token:k?.stakePoolTokenMetadata.metadata.name,totalAmount:S,validatorName:y?.validatorName}}})},[e]),p=(0,Pt.useCallback)(({amount:S,convertDetails:y})=>{e.capture("liquidStakingConvertFailed",{data:{stake:{validatorName:y?.validatorName,stakeAccountBalance:S}}})},[e]),g=(0,Pt.useCallback)(()=>{e.capture("liquidStakingConvertMoreClicked")},[e]);return{trackConvertStakeAccountClicked:o,trackConvertStakeAccountListSeen:n,trackConvertBannerClicked:r,trackConvertBannerSeen:i,trackConvertModalContinue:a,trackConvertModalNotNow:u,trackConvertApprovedByUser:d,trackConvertFailed:p,trackConvertSubmitted:l,trackConvertSuccess:m,trackConvertMoreClicked:g}};var kc=()=>{let{connection:e}=kt(),{data:t}=yt("solana"),{trackConvertModalContinue:o,trackConvertModalNotNow:n}=Ft(),{results:r,isFetched:i}=Pe(e),a=(0,Bo.useMemo)(()=>new Map(r.map(d=>[d.voteAccountPubkey,d])),[r]),u=Ji(e,t?.address??"",a,i);return(0,Bo.useEffect)(()=>{u()},[u]),{trackConvertModalContinue:o,trackConvertModalNotNow:n}};s();c();s();c();var $i=({numSignatures:e,lamportsPerSignature:t,lamportBalance:o,rentExemptionMinimum:n})=>{let r=j(t).multipliedBy(e),i=o.minus(r);return j.max(i.minus(n),0)};var hc=({balance:e,rentExemptionMinimum:t})=>{let o=$i({numSignatures:11,lamportsPerSignature:Wr,lamportBalance:j(e),rentExemptionMinimum:br(t)});return parseFloat(Ar(o).toFixed(9))};s();c();var Ac=e=>{let t=U.keybaseUserAvatar(e);return L({enabled:!!e,queryKey:t,async queryFn(){if(!e)throw new Error("Keybase username is required");return Mo(e)},placeholderData:"",staleTime:1/0})};s();c();s();c();var Yi=new Error("Missing sender address for staking fungibles."),Xi=new Error("Missing signature from waiting for staking transaction confirmation."),Zi=new Error("PublicKey is required");var ge=class extends Error{constructor(t){super(t)}};var bc=async(e,t)=>await e.getSignatureStatuses([t],{searchTransactionHistory:!0});function vc(e,t,o){let n=Y(),r=U.signatureStatus(o),i=async()=>{if(!o)throw Xi;let l=await bc(e,o);return{...l,value:l.value[0]}},u=n.getQueryData(r)?.value?.confirmationStatus;return L({queryKey:r,queryFn:i,enabled:!!o&&u!=="finalized",refetchInterval:t,staleTime:1/0})}s();c();var wc=e=>async()=>await e.getMinimumBalanceForRentExemption(h.StakeProgram.space);function Tc(e){let t=U.stakeAccountMinBalance(),o=wc(e);return L({queryKey:t,queryFn:o,placeholderData:0,staleTime:1/0})}s();c();var Pc=async(e,t,o,n="confirmed")=>await e.getInflationReward(t,o,n),xc=async(e,t)=>{let o=[];t.ownerPublicKey&&o.push({memcmp:{offset:44,bytes:t.ownerPublicKey}}),t.voteAccountPublicKey&&o.push({dataSize:200},{memcmp:{offset:124,bytes:t.voteAccountPublicKey}});let n=await e.getParsedProgramAccounts(h.StakeProgram.programId,{filters:o}),r=[];if(t.fetchInflationRewards)try{r=await Pc(e,n.map(({pubkey:i})=>i))}catch(i){let a=i;!a.message.includes("RPC request timed out")&&G.captureError(a,"staking")}return n.map((i,a)=>({pubkey:i.pubkey.toString(),lamports:i.account.lamports,inflationReward:r[a]?.amount,...i.account.data.parsed}))},Ic=(e,t)=>U.stakeAccounts(e,t),Lc=(e,t)=>()=>xc(e,{ownerPublicKey:t,fetchInflationRewards:!0});function Cc(e,t){let o=Ic(t,e.rpcEndpoint),n=Lc(e,t);return L({queryKey:o,queryFn:n,placeholderData:[],staleTime:K({minutes:5})})}s();c();function Ec(e,t){let o=U.stakeActivationData(t);return L({queryKey:o,queryFn:async()=>{if(!t)throw Zi;return await ze(e,new h.PublicKey(t))},enabled:!!t,staleTime:1/0})}s();c();s();c();var ta=new Error("Failed to fetch staking APY");async function ea(){try{let e=await vt.api().get("/staking/v1/apy");if(!Zt(e))throw ta;let t=e.data;return Re.parse(t).apy}catch{throw ta}}var Fc=()=>{let e=U.stakeApy();return L({enabled:!0,queryKey:e,gcTime:We.Short,staleTime:1/0,async queryFn(){return ea()}})};s();c();var ra=I(E());s();c();s();c();var oa=new Error("Failed to fetch liquid staking supported tokens"),_c=new Error("Missing supported tokens in response");async function na(){try{let e=await vt.api().get("/liquid-staking/v1/supported-tokens");if(!Zt(e))throw oa;let t=Ui.safeParse(e.data.supportedTokens);if(!t.success)throw _c;return t.data}catch{throw oa}}var No=()=>{let e=U.liquidStakingSupportedTokens();return L({queryKey:e,staleTime:K({minutes:15}),async queryFn(){return await na()}})};function Mc(e){return typeof e=="string"?e:e?te(Nt(e)):""}var Vt=e=>{let t=Mc(e),o=gt("enable-psol-staking"),{data:n={}}=No(),r=(0,ra.useMemo)(()=>!!Object.values(n).flat().find(a=>a.stakePoolTokenMetadata.caip19===t),[t,n]);return t===O?o&&r:r};s();c();s();c();var Qe=I(E());s();c();s();c();var ia=new Error("Failed to fetch Average Validator APY");async function aa(){let e=await vt.api().get("/staking/v1/avg-validator-apy");if(!Zt(e))throw ia;let t=Re.safeParse(e.data);if(t.success)return t.data.apy;throw ia}var sa=()=>{let e=U.averageValidatorApy();return L({enabled:!0,queryKey:e,gcTime:K({hours:1}),staleTime:1/0,async queryFn(){return aa()}})};var ca=e=>{let t=(0,Qe.useMemo)(()=>e?te(Nt(e)):"",[e]),{data:o,isPending:n}=sa(),r=o?o/100:null,{data:i={},isPending:a}=No(),u=(0,Qe.useMemo)(()=>i[t]??[],[t,i]),d=u?u[0]:void 0,l=(0,Qe.useCallback)((m,p=!1)=>m?u.find(g=>g.stakePoolTokenMetadata.caip19===m):p?void 0:d,[d,u]);return{isLoading:a||n,isSupported:u.length>0,providers:u,pickedLSTProvider:l,defaultProvider:d,avgValidatorApy:r}};var _t=e=>{let t=_i.get(e);return ca(t)};s();c();var ua=I(E());var Uc=({onLiquidStake:e,onNativeStake:t})=>{let{t:o}=J(),n=Dn,{avgValidatorApy:r,pickedLSTProvider:i}=_t(St.Solana.Mainnet),a=Vt(O),u=i(a?O:mn);return{options:(0,ua.useMemo)(()=>[{type:"liquid",isRecommended:!0,title:o("stakeMethodSelectionLiquidStakingTitle"),description:o("stakeMethodSelectionLiquidStakingDescription",{poolTokenSymbol:u?.stakePoolTokenMetadata?.metadata?.symbol}),apy:u?o("stakeMethodEstApy",{apy:Se(parseFloat(u.apy))}):null,disabled:!u,onClick:e??(()=>{})},{type:"native",isRecommended:!1,title:o("stakeMethodSelectionNativeStakingTitle"),description:o("stakeMethodSelectionNativeStakingDescription"),apy:r?o("stakeMethodEstApy",{apy:Se(r)}):null,onClick:t,disabled:!1}],[r,u,e,t,o]),learnMoreLink:n}};s();c();function da({hideOnLowBalance:e}){let{pickedLSTProvider:t}=_t(St.Solana.Mainnet),o=Vt(O),n=t(O),{data:r}=jr();if(!r||!n)return{shouldHide:!0,apy:0,formattedApy:"0%"};let i=Tt(r.totalQuantityString,r.decimals),a=!1;e&&(a=!i.isGreaterThan(0)),o||(a=!0);let u=parseFloat(n.apy),d=`${(u*100).toFixed(2)}%`;return{shouldHide:a,apy:u,formattedApy:d}}s();c();var ie=()=>{let{data:e}=ni(),t=e==="GB",o=gt("enable-uk-staking-disclaimers"),n=gt("enable-uk-staking-override"),r=Vt(O);return n?!0:o&&t&&r};s();c();var pa=I(E());s();c();var Oc=async e=>{let t=await e.getEpochInfo(),o=t.slotsInEpoch-t.slotIndex;return{hours:o*.4/3600,totalSlots:t.slotsInEpoch,remainingSlots:o,epoch:t.epoch}},la=e=>{let t=U.epochTimeRemaining(e.rpcEndpoint);return L({queryKey:t,queryFn:async()=>Oc(e),placeholderData:{hours:0,totalSlots:0,remainingSlots:0,epoch:0},staleTime:lt.Long})};var ye=()=>{let{t:e}=J(),{connection:t}=kt(),{data:o}=la(t);return(0,pa.useMemo)(()=>{if(!o)return"";if(o.hours<24){let r=Math.max(o.hours,1),i=e(r===1?"timeUnitHour":"timeUnitHours");return`${r.toFixed(0)} ${i}`}else{let r=o.hours,i=Math.floor(r/24),a=r%24,u=Math.floor(a),d=e(u===1?"timeUnitHour":"timeUnitHours"),l=e(i===1?"timeUnitDay":"timeUnitDays");return u===0?`${i} ${l}`:`${i} ${l} ${u} ${d}`}},[o,e])};s();c();s();c();var Ge=I(E());s();c();var Xn=e=>Yn(e)?!1:qe(e.activationState);var He=e=>{let t=gt("enable-psol-native-convert"),o=gt("enable-psol-native-delayed-convert"),{connection:n}=kt(),{data:r}=yt("solana"),{results:i,isFetched:a,isError:u}=Pe(n),d=(0,Ge.useMemo)(()=>new Map(i.map(T=>[T.voteAccountPubkey,T])),[i]),{data:l,isLoading:m,isFetching:p,error:g,refetch:S}=ji(n,r?.address??"",d,a||u),y=m||p,k=(0,Ge.useMemo)(()=>y||!l?[]:l.map(T=>Nc(T,d)).sort((T,F)=>T.lamports>F.lamports?-1:1),[y,l,d]),A=(0,Ge.useMemo)(()=>k.filter(T=>T.eligible),[k]),b=(0,Ge.useMemo)(()=>k.filter(T=>!T.eligible),[k]);return e?.stakePoolTokenMetadata.caip19===O?{hasConvertibleStakeAccounts:t&&A.length>0||o&&b.length>0,eligibleStakeAccounts:A,inelegibleStakeAccounts:b,isLoadingList:y,error:g,refetch:S}:{hasConvertibleStakeAccounts:!1,eligibleStakeAccounts:[],inelegibleStakeAccounts:[],isLoadingList:y,error:g,refetch:S}},Nc=(e,t)=>{let o=Xn(e),n=Dc(e,t),r=e.lamports;return{...e,amount:r,eligible:o,title:n,imageUri:e.imageUri}},Dc=(e,t)=>{let o="";if(e.type==="delegated"){let{voter:n}=e.info.stake.delegation,r=t.get(n),i=r?.info?.keybaseUsername;o=r?.info?.name??i??Fr(n)}else e.type==="initialized"&&(o=e.pubkey);return o};s();c();var Rc=()=>{let e=je();if(!e)throw new Error("PSOL provider not found");return e},je=()=>{let{pickedLSTProvider:e}=_t(M.solana.mainnetID);return e(O,!0)};s();c();var Sa=I(E());s();c();var Do=I(E());s();c();function ma({key:e,queryKey:t,defaultValue:o=null}){let n=X();return L({enabled:!0,queryKey:t,gcTime:We.Long,staleTime:1/0,async queryFn(){try{return await n.get(e)}catch(r){return r instanceof Error&&G.captureError(r,"staking"),o}}})}function fa({key:e,queryKey:t}){let o=X(),n=Y();return ct({async mutationFn(r){try{return await o.set(e,r)}catch(i){i instanceof Error&&G.captureError(i,"staking");return}},async onMutate(r){await n.cancelQueries({queryKey:t});let i=n.getQueryData(t);return n.setQueryData(t,r),{previousValue:i}},onError(r,i,a){n.setQueryData(t,a?.previousValue)}})}var qc=C.object({convert:C.boolean(),mint:C.boolean()}),Zn={convert:!1,mint:!1},Vc=JSON.stringify(Zn),xe=()=>{let{data:e}=ma({key:"featureUsed",queryKey:U.featureUsed(),defaultValue:Vc}),t=(0,Do.useMemo)(()=>{if(!e)return Zn;let r=qc.safeParse(JSON.parse(e));return r.success?r.data:Zn},[e]),{mutateAsync:o}=fa({key:"featureUsed",queryKey:U.featureUsed()}),n=(0,Do.useCallback)(async r=>{let i={...t,...r};await o(JSON.stringify(i))},[o,t]);return{usageState:t,setUsageState:n}};var tr=({method:e,goToInfoPage:t,goToInitFlowPage:o})=>{let{usageState:n}=xe();return(0,Sa.useCallback)(()=>{n[e]?o():t()},[t,o,e,n])};s();c();s();c();var ga=I(E());s();c();s();c();var Je={transactionData:void 0,provider:void 0,convert:{validatorVote:"",stakeAccount:"",validatorName:"",eligibleAccountsCount:0,activationState:void 0,stakeAuthorityPubkey:""},amount:"",navigateTo:null},B=Br(e=>({...Je,resetStaking:()=>e(t=>({...t,amount:Je.amount,transactionData:Je.transactionData,convert:Je.convert,navigateTo:Je.navigateTo})),setTransactionData:t=>e({transactionData:t}),setProvider:t=>e({provider:t}),setConvertStakeAccount:t=>e({convert:t}),setAmount:t=>e({amount:t}),setNavigateTo:t=>e({navigateTo:t})}));var Ro=e=>{let t=B(l=>l.setConvertStakeAccount),o=B(l=>l.setAmount),{trackConvertStakeAccountClicked:n}=Ft(),r=je(),i=gt("enable-psol-native-delayed-convert"),{eligibleStakeAccounts:a,inelegibleStakeAccounts:u}=He(r);return(0,ga.useCallback)(({stakeAccount:l,validatorName:m,activationState:p})=>{let g=l?.info?.stake?.delegation?.voter??"",S=`${l?.lamports??"0"}`;t({validatorVote:g,stakeAccount:l.pubkey,stakeAuthorityPubkey:l?.info?.meta?.authorized?.staker??"",validatorName:m??"",activationState:p,eligibleAccountsCount:i?a.length+u.length:a.length}),o(S),n(m??"",S),e()},[n,e,t,o,a.length,u.length,i])};s();c();var $e=I(E());var Kc=e=>{let t=dt,{pickedLSTProvider:o}=_t(M.solana.mainnetID),n=o(O,!0),{trackConvertStakeAccountListSeen:r}=Ft(),{error:i,refetch:a,isLoadingList:u,eligibleStakeAccounts:d,inelegibleStakeAccounts:l}=He(n);(0,$e.useEffect)(()=>{u||r([...d,...l].map(y=>({title:y.title,amount:y.amount,eligible:y.eligible})))},[r,d,l,u]);let m=Ro(e),p=(0,$e.useCallback)(y=>{m({stakeAccount:y,validatorName:y.title,activationState:y.activationState})},[m]),g=ye(),S=(0,$e.useCallback)(()=>{a()},[a]);return{isLoading:u,error:i,eligibleStakeAccounts:d,inelegibleStakeAccounts:l,onReload:S,onSelectStakeAccount:p,tokenSymbol:t?.data.symbol??"",tokenDecimals:t?.data.decimals??0,durationUntilEpochEnds:g}};s();c();s();c();var ya=I(E());var qo=()=>{let e=Y();return(0,ya.useCallback)(()=>Ke(e)(),[e])},er=(e,t,o)=>ko({connection:e,signature:t,commitment:"finalized"}).then(()=>{Ke(o)()});s();c();var Le=I(ao());s();c();var or=I(cs());var Gb=new h.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s");var ht=new h.PublicKey("SPoo1Ku8WFXoNDMHPsrGSTSG1Y47rzgn41SLUNakuHy");var Hb=or.Buffer.from("ephemeral"),ka=or.Buffer.from("transient"),Ye=h.LAMPORTS_PER_SOL;s();c();var nr=Object.freeze({DepositStake:{index:9,layout:bt.struct([bt.u8("instruction")])},DepositSol:{index:14,layout:bt.struct([bt.u8("instruction"),bt.ns64("lamports")])},WithdrawStake:{index:10,layout:bt.struct([bt.u8("instruction"),bt.ns64("poolTokens")])},WithdrawSol:{index:16,layout:bt.struct([bt.u8("instruction"),bt.ns64("poolTokens")])}});function rr(e,t){let o=e.layout.span,n=Buffer.alloc(o),r=Object.assign({instruction:e.index},t);return e.layout.encode(r,n),n}var Ie=class{static depositSol(t){let{stakePool:o,withdrawAuthority:n,depositAuthority:r,reserveStake:i,fundingAccount:a,destinationPoolAccount:u,managerFeeAccount:d,referralPoolAccount:l,poolMint:m,lamports:p,referralAccount:g}=t,S=nr.DepositSol,y=rr(S,{lamports:p}),k=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:h.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:be,isSigner:!1,isWritable:!1}];return r&&k.push({pubkey:r,isSigner:!0,isWritable:!1}),g&&k.push({pubkey:g,isSigner:!1,isWritable:!1}),new Q.TransactionInstruction({programId:ht,keys:k,data:y})}static withdrawStake(t){let{stakePool:o,validatorList:n,withdrawAuthority:r,validatorStake:i,destinationStake:a,destinationStakeAuthority:u,sourceTransferAuthority:d,sourcePoolAccount:l,managerFeeAccount:m,poolMint:p,poolTokens:g}=t,S=nr.WithdrawStake,y=rr(S,{poolTokens:g}),k=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:h.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:be,isSigner:!1,isWritable:!1},{pubkey:h.StakeProgram.programId,isSigner:!1,isWritable:!1}];return new Q.TransactionInstruction({programId:ht,keys:k,data:y})}static withdrawSol(t){let{stakePool:o,withdrawAuthority:n,sourceTransferAuthority:r,sourcePoolAccount:i,reserveStake:a,destinationSystemAccount:u,managerFeeAccount:d,solWithdrawAuthority:l,poolMint:m,poolTokens:p}=t,g=nr.WithdrawSol,S=rr(g,{poolTokens:p}),y=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:h.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:h.SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:h.StakeProgram.programId,isSigner:!1,isWritable:!1},{pubkey:be,isSigner:!1,isWritable:!1}];return l&&y.push({pubkey:l,isSigner:!0,isWritable:!1}),new Q.TransactionInstruction({programId:ht,keys:y,data:S})}};s();c();var w=I(ba());var va=I(ao()),wa=I(ln());var se=[(0,w.u64)("denominator"),(0,w.u64)("numerator")];var Vo=cn().transform(e=>new va.default(e,10)),Ko=cn().transform(e=>new h.PublicKey(e)),cu=yr(["uninitialized","initialized","delegated","rewardsPool"]),uu=Xt({rentExemptReserve:Vo,authorized:Xt({staker:Ko,withdrawer:Ko}),lockup:Xt({unixTimestamp:Ee(),epoch:Ee(),custodian:Ko})}),du=Xt({meta:uu,stake:Xt({delegation:Xt({voter:Ko,stake:Vo,activationEpoch:Vo,deactivationEpoch:Vo,warmupCooldownRate:Ee()}),creditsObserved:Ee()}).nullish().default(null)}),Ta=Xt({type:cu,info:kr(du)}),cr=class extends wa.Layout{layout;discriminator;constructor(t,o){super(-1,o),this.layout=t,this.discriminator=(0,w.u8)()}encode(t,o,n=0){return t==null?this.discriminator.encode(0,o,n):(this.discriminator.encode(2,o,n),this.layout.encode(t,o,n+1)+1)}decode(t,o=0){let n=this.discriminator.decode(t,o);if(n===0)return null;if(n===1||n===2)return this.layout.decode(t,o+1);throw new Error("Invalid future epoch "+this.property)}getSpan(t,o=0){let n=this.discriminator.decode(t,o);if(n===0)return 1;if(n===1||n===2)return this.layout.getSpan(t,o+1)+1;throw new Error("Invalid future epoch "+this.property)}};function sr(e,t){return new cr(e,t)}var Pa=(0,w.struct)([(0,w.u8)("accountType"),(0,w.publicKey)("manager"),(0,w.publicKey)("staker"),(0,w.publicKey)("stakeDepositAuthority"),(0,w.u8)("stakeWithdrawBumpSeed"),(0,w.publicKey)("validatorList"),(0,w.publicKey)("reserveStake"),(0,w.publicKey)("poolMint"),(0,w.publicKey)("managerFeeAccount"),(0,w.publicKey)("tokenProgramId"),(0,w.u64)("totalLamports"),(0,w.u64)("poolTokenSupply"),(0,w.u64)("lastUpdateEpoch"),(0,w.struct)([(0,w.u64)("unixTimestamp"),(0,w.u64)("epoch"),(0,w.publicKey)("custodian")],"lockup"),(0,w.struct)(se,"epochFee"),sr((0,w.struct)(se),"nextEpochFee"),(0,w.option)((0,w.publicKey)(),"preferredDepositValidatorVoteAddress"),(0,w.option)((0,w.publicKey)(),"preferredWithdrawValidatorVoteAddress"),(0,w.struct)(se,"stakeDepositFee"),(0,w.struct)(se,"stakeWithdrawalFee"),sr((0,w.struct)(se),"nextStakeWithdrawalFee"),(0,w.u8)("stakeReferralFee"),(0,w.option)((0,w.publicKey)(),"solDepositAuthority"),(0,w.struct)(se,"solDepositFee"),(0,w.u8)("solReferralFee"),(0,w.option)((0,w.publicKey)(),"solWithdrawAuthority"),(0,w.struct)(se,"solWithdrawalFee"),sr((0,w.struct)(se),"nextSolWithdrawalFee"),(0,w.u64)("lastEpochPoolTokenSupply"),(0,w.u64)("lastEpochTotalLamports")]);var lu=(0,w.struct)([(0,w.u64)("activeStakeLamports"),(0,w.u64)("transientStakeLamports"),(0,w.u64)("lastUpdateEpoch"),(0,w.u64)("transientSeedSuffixStart"),(0,w.u64)("transientSeedSuffixEnd"),(0,w.u8)("status"),(0,w.publicKey)("voteAccountAddress")]),Wo=(0,w.struct)([(0,w.u8)("accountType"),(0,w.u32)("maxValidators"),(0,w.vec)(lu,"validators")]);s();c();var Mt=I(ao());function ur(e){return isNaN(e)?0:Number(e*h.LAMPORTS_PER_SOL)}function zo(e,t){let o=t.mul(e.totalLamports),n=e.poolTokenSupply;return o.lt(n)?new Mt.default(0):o.div(n)}async function Qo(e,t){let[o]=await h.PublicKey.findProgramAddress([t.toBuffer(),Buffer.from("withdraw")],e);return o}async function Go(e,t,o,n){let[r]=await h.PublicKey.findProgramAddress([t.toBuffer(),o.toBuffer(),n?new Mt.default(n).toArrayLike(Buffer,"le",4):Buffer.alloc(0)],e);return r}function ke(e){if(typeof e=="number")return Math.abs(e)/h.LAMPORTS_PER_SOL;if(typeof e=="bigint")return Math.abs(Number(e))/h.LAMPORTS_PER_SOL;let t=1;e.isNeg()&&(t=-1);let n=e.abs().toString(10).padStart(10,"0"),r=n.length-9,i=n.slice(0,r)+"."+n.slice(r);return t*parseFloat(i)}async function pu(e,t,o,n){let[r]=await h.PublicKey.findProgramAddress([ka,t.toBuffer(),o.toBuffer(),n.toArrayLike(Buffer,"le",8)],e);return r}function mu(e,t){return e.poolTokenSupply.isZero()||e.totalLamports.isZero()?t:t.mul(e.poolTokenSupply).div(e.totalLamports)}async function xa(e,t,o,n,r,i){let a=await e.getAccountInfo(t.validatorList),u=Wo.decode(a?.data);if(!u?.validators||u?.validators.length==0)throw new Error("No accounts found");let d=await e.getMinimumBalanceForRentExemption(h.StakeProgram.space),l=new Mt.default(d+Ye),m=[];for(let b of u.validators){if(b.status!==0)continue;let T=await Go(ht,b.voteAccountAddress,o);if(!b.activeStakeLamports.isZero()){let x=t?.preferredWithdrawValidatorVoteAddress?.equals(b.voteAccountAddress);m.push({type:x?"preferred":"active",voteAddress:b.voteAccountAddress,stakeAddress:T,lamports:b.activeStakeLamports})}let F=b.transientStakeLamports.sub(l);if(F.gt(new Mt.default(0))){let x=await pu(ht,b.voteAccountAddress,o,b.transientSeedSuffixStart);m.push({type:"transient",voteAddress:b.voteAccountAddress,stakeAddress:x,lamports:F})}}m=m.sort(r||((b,T)=>T.lamports.sub(b.lamports).toNumber()));let p=await e.getAccountInfo(t.reserveStake),g=new Mt.default((p?.lamports??0)-d);g.gt(new Mt.default(0))&&m.push({type:"reserve",stakeAddress:t.reserveStake,lamports:g});let S=[],y=new Mt.default(n),k=t.stakeWithdrawalFee,A={numerator:k.denominator.sub(k.numerator),denominator:k.denominator};for(let b of["preferred","active","transient","reserve"]){let T=m.filter(F=>F.type==b);for(let{stakeAddress:F,voteAddress:x,lamports:N}of T){if(N.lte(l)&&b=="transient")continue;let R=mu(t,N);!i&&!A.numerator.isZero()&&(R=R.mul(A.denominator).div(A.numerator));let z=Mt.default.min(R,y);if(!z.lte(new Mt.default(0))&&(S.push({stakeAddress:F,voteAddress:x,poolAmount:z}),y=y.sub(z),y.isZero()))break}if(y.isZero())break}if(y.gt(new Mt.default(0)))throw new Error(`No stake accounts found in this pool with enough balance to withdraw ${ke(n)} pool tokens.`);return S}function Ia(e,t,o){let n=h.Keypair.generate();return t.push(h.SystemProgram.createAccount({fromPubkey:e,newAccountPubkey:n.publicKey,lamports:o,space:h.StakeProgram.space,programId:h.StakeProgram.programId})),n}function Xe(e){let t,o;return e.solWithdrawalFee&&(t=e.solWithdrawalFee.numerator.toNumber()*100/e.solWithdrawalFee.denominator.toNumber()),e.stakeWithdrawalFee&&(o=e.stakeWithdrawalFee.numerator.toNumber()*100/e.stakeWithdrawalFee.denominator.toNumber()),{solWithdrawalFee:t,stakeWithdrawalFee:o}}async function Ho(e,t){let o=await e.getAccountInfo(t);if(!o)throw new Error("Invalid stake pool account");return{pubkey:t,account:{data:Pa.decode(o.data),executable:o.executable,lamports:o.lamports,owner:o.owner}}}async function fu(e,t){let o=(await e.getParsedAccountInfo(t)).value;if(!o||!("parsed"in o.data))throw new Error("Invalid stake account");if(o.data.program!="stake")throw new Error("Not a stake account");return Ta.parse(o.data.parsed)}async function jo(e,t,o,n,r,i,a,u,d=!0){if(d){let b=await e.getBalance(o,"confirmed");if(b<n)throw new Error(`Not enough SOL to deposit into pool. Maximum deposit amount is ${ke(b)} SOL.`)}let m=(await Ho(e,t)).account.data,p=new h.Keypair,g=[p],S=[];if(S.push(h.SystemProgram.transfer({fromPubkey:o,toPubkey:p.publicKey,lamports:n})),!r){let b=yo(m.poolMint,o);S.push(Vr(o,b,o,m.poolMint)),r=b}let y=await Qo(ht,t);S.push(Ie.depositSol({stakePool:t,reserveStake:m.reserveStake,fundingAccount:p.publicKey,destinationPoolAccount:r,managerFeeAccount:m.managerFeeAccount,referralPoolAccount:a??r,poolMint:m.poolMint,lamports:n,withdrawAuthority:y,depositAuthority:u,referralAccount:i}));let{solWithdrawalFee:k,stakeWithdrawalFee:A}=Xe(m);return{instructions:S,signers:g,solWithdrawalFee:k,stakeWithdrawalFee:A}}async function La(e,t){let o=await Ho(e,t);return Xe(o.account.data)}async function Ca(e,t,o,n,r=!1,i,a,u,d){let l=await Ho(e,t),m=new Le.default(ur(n));u||(u=yo(l.account.data.poolMint,o));let p=await pn(e,u);if(p.amount<m.toNumber())throw new Error(`Not enough token balance to withdraw ${ke(m)} pool tokens.
          Maximum withdraw amount is ${ke(p.amount)} pool tokens.`);let g=await e.getMinimumBalanceForRentExemption(h.StakeProgram.space),S=await Qo(ht,t),y=null;a&&(y=await fu(e,a));let k=[];if(r)k.push({stakeAddress:l.account.data.reserveStake,voteAddress:void 0,poolAmount:m});else if(y&&y?.type=="delegated"){let _=y.info?.stake?.delegation.voter;if(!_)throw new Error(`Invalid stake reciever ${a} delegation`);let ot=await e.getAccountInfo(l.account.data.validatorList),nt=Wo.decode(ot?.data).validators.find(rt=>rt.voteAccountAddress.equals(_));if(i&&i!==_)throw new Error(`Provided withdrawal vote account ${i} does not match delegation on stake receiver account ${_},
        remove this flag or provide a different stake account delegated to ${i}`);if(nt){let rt=await Go(ht,_,t),It=await e.getAccountInfo(rt);if(!It)throw new Error("Preferred withdraw valdator's stake account is invalid");let Bt=zo(l.account.data,new Le.default(It.lamports-Ye-g));if(Bt.lt(m))throw new Error(`Not enough lamports available for withdrawal from ${rt},
              ${m} asked, ${Bt} available.`);k.push({stakeAddress:rt,voteAddress:_,poolAmount:m})}else throw new Error(`Provided stake account is delegated to a vote account ${_} which does not exist in the stake pool`)}else if(i){let _=await Go(ht,i,t),ot=await e.getAccountInfo(_);if(!ot)throw new Error("Invalid Stake Account");let at=new Le.default(ot.lamports-Ye-g);if(at.lt(new Le.default(0)))throw new Error("Invalid Stake Account");let nt=zo(l.account.data,at);if(nt.lt(m))throw new Error(`Not enough lamports available for withdrawal from ${_},
            ${m} asked, ${nt} available.`);k.push({stakeAddress:_,voteAddress:i,poolAmount:m})}else{let _=await xa(e,l.account.data,t,m,d,u.equals(l.account.data.managerFeeAccount));k.push(..._)}let A=[],b=h.Keypair.generate(),T=[b];A.push(Bn(u,b.publicKey,o,m.toNumber()));let F=0,x=5,N=0;for(let _ of k){if(N>x)break;let at=`Withdrawing \u25CE${zo(l.account.data,_.poolAmount)},
        from stake account ${_.stakeAddress?.toBase58()}`;_.voteAddress&&(at=`${at}, delegated to ${_.voteAddress?.toBase58()}`);let nt;if(!a||y&&y.type==="delegated"){let rt=Ia(o,A,g);T.push(rt),F+=g,nt=rt.publicKey}else nt=a;A.push(Ie.withdrawStake({stakePool:t,validatorList:l.account.data.validatorList,validatorStake:_.stakeAddress,destinationStake:nt,destinationStakeAuthority:o,sourceTransferAuthority:b.publicKey,sourcePoolAccount:u,managerFeeAccount:l.account.data.managerFeeAccount,poolMint:l.account.data.poolMint,poolTokens:_.poolAmount.toNumber(),withdrawAuthority:S})),N++}a&&y&&y.type==="delegated"&&T.forEach(_=>{A.concat(h.StakeProgram.merge({stakePubkey:a,sourceStakePubKey:_.publicKey,authorizedPubkey:o}).instructions)});let{solWithdrawalFee:R,stakeWithdrawalFee:z}=Xe(l.account.data);return{instructions:A,signers:T,stakeReceiver:a,totalRentFreeBalances:F,solWithdrawalFee:R,stakeWithdrawalFee:z}}async function Ea(e,t,o,n,r,i){let a=await Ho(e,t),u=new Le.default(ur(r)),d=yo(a.account.data.poolMint,o),l=await pn(e,d);if(l.amount<u.toNumber())throw new Error(`Not enough token balance to withdraw ${ke(u)} pool tokens.
            Maximum withdraw amount is ${ke(l.amount)} pool tokens.`);let m=[],p=h.Keypair.generate(),g=[p];m.push(Bn(d,p.publicKey,o,u.toNumber()));let S=await Qo(ht,t);if(i){let b=a.account.data.solWithdrawAuthority;if(!b)throw new Error("SOL withdraw authority specified in arguments but stake pool has none");if(i.toBase58()!=b.toBase58())throw new Error(`Invalid deposit withdraw specified, expected ${b.toBase58()}, received ${i.toBase58()}`)}let y=Ie.withdrawSol({stakePool:t,withdrawAuthority:S,reserveStake:a.account.data.reserveStake,sourcePoolAccount:d,sourceTransferAuthority:p.publicKey,destinationSystemAccount:n,managerFeeAccount:a.account.data.managerFeeAccount,poolMint:a.account.data.poolMint,poolTokens:u.toNumber(),solWithdrawAuthority:i});m.push(y);let{solWithdrawalFee:k,stakeWithdrawalFee:A}=Xe(a.account.data);return{instructions:m,signers:g,solWithdrawalFee:k,stakeWithdrawalFee:A}}function _a({stakePubkey:e,stakeAuthorityPubkey:t,authorizedPubkey:o,transaction:n=new Q.Transaction}){return t.equals(o)||n.add(h.StakeProgram.authorize({authorizedPubkey:o,newAuthorizedPubkey:o,stakeAuthorizationType:h.StakeAuthorizationLayout.Staker,stakePubkey:e})),n.add(h.StakeProgram.deactivate({stakePubkey:e,authorizedPubkey:o})),n}var Vv=e=>{let{t}=J(),o=Y(),n=jn(),{mutateAsync:r}=Hr(e);return ct({mutationFn:async({accountIdentifier:u,senderAddress:d,stakePubkey:l,stakeAuthorityPubkey:m,authorizedPubkey:p})=>{if(!d)throw Yi;let{networkID:g,address:S}=d,y=_a({stakePubkey:l,stakeAuthorityPubkey:m,authorizedPubkey:p}),k=await Gt(y,{connection:e}),A={ownerAddress:S??"",networkID:g,data:{signature:""},type:"deactivateState",display:{summary:{topLeft:{text:t("transactionsPendingDeactivatingStake")}}}};n.approved({chainType:"solana",chainName:"solana",networkId:M.getSolanaNetworkIDValue(g),type:"undelegate"});let b=await r({accountIdentifier:u,feePayer:new h.PublicKey(S),transaction:k,pendingTransactionInput:A});return n.submittedTransaction(b,{chainType:"solana",chainName:"solana",networkId:M.getSolanaNetworkIDValue(g),method:"signAndSendTransaction"}),n.deactivateStake(),{networkID:g,id:b??""}},onSuccess:u=>{ko({connection:e,signature:u.id}).then(()=>{n.transactionStatus(u.id,{chainType:"solana",chainName:"solana",networkId:M.getSolanaNetworkIDValue(u.networkID),status:{type:"confirmed"}})}).catch(d=>{n.transactionStatus(u.id,{chainType:"solana",chainName:"solana",networkId:M.getSolanaNetworkIDValue(u.networkID),status:{type:"error"}}),G.captureError(d,"staking")}),er(e,u.id,o)}})};async function Su({connection:e,stakePubkey:t,stakeAuthorityPubkey:o,authorizedPubkey:n}){let r=_a({stakePubkey:t,stakeAuthorityPubkey:o,authorizedPubkey:n}),i=(await e.getLatestBlockhash("confirmed")).blockhash,a=new Q.TransactionMessage({instructions:r.instructions,payerKey:o,recentBlockhash:i}).compileToV0Message(),u=new Q.VersionedTransaction(a);return await Gt(u,{connection:e})}var Ma=({stakePubkey:e,stakeAuthorityPubkey:t,authorizedPubkey:o,connection:n,stakePoolAddress:r,disabled:i})=>{let a=U.getDeactivateStakeTransaction({stakePubkey:e.toString(),stakeAuthorityPubkey:t.toString(),authorizedPubkey:o.toString()});return L({enabled:!i&&!!e&&!!t&&!!o,queryKey:a,staleTime:K({seconds:30}),async queryFn(){try{let[d,{solWithdrawalFee:l,stakeWithdrawalFee:m}]=await Promise.all([Su({connection:n,stakePubkey:e,stakeAuthorityPubkey:t,authorizedPubkey:o}),La(n,r)]);return{transaction:d,networkID:St.Solana.Mainnet,solWithdrawalFee:l,stakeWithdrawalFee:m}}catch(d){throw G.captureError(d,"staking"),d}}})};s();c();var it=I(E());s();c();var Ua=I(E());var Jo=({txReceipt:e,isTxError:t,poolTokenFungible:o,invalidateQueries:n,dismissLiquidStaking:r})=>{let i=B(u=>u.resetStaking),a=B(u=>u.setNavigateTo);return(0,Ua.useCallback)(()=>{if(i(),!e||t)return r();n(),a(o?{screen:"FungibleDetail",caip19:te(Nt(o))}:{screen:"Activity"}),r()},[e,t,o,n,r,a,i])};s();c();var $o=I(E());s();c();var Oa=({connection:e})=>{let t=X(),o=Er();return ct({mutationFn:async({accountIdentifier:r,ownerAddress:i,pendingActivityRow:a,activityType:u,transactionData:{networkID:d,transaction:l,signers:m}})=>{if(M.isSolanaNetworkID(d)){await hr(l,e);let p={ownerAddress:i,networkID:d,data:{signature:""},type:u,display:{summary:a}};return{id:await Kr({accountIdentifier:r,feePayer:new h.PublicKey(i),connection:e,accountSigner:o,transaction:l,pendingTransactionInput:p,storage:t,opts:{additionalSignerAccounts:m}}),networkID:d}}throw new Error(`Unsupported network for liquid staking: ${d}`)}})};function Yo({isLoadingPoolToken:e,pendingActivityRow:t,onTransactionSubmitted:o,onTransactionFailed:n,activityType:r}){let{connection:i}=kt(),a=B(A=>A.transactionData),u=dt,{data:d,isLoading:l}=ee(),{mutateAsync:m}=Oa({connection:i}),g=(0,$o.useMemo)(()=>(d?.addresses??[]).find(A=>A.networkID===u?.data.chain.id),[u?.data.chain.id,d?.addresses])?.address??"",S=d?.identifier??"";return{executeLiquidStake:(0,$o.useCallback)(async()=>{try{if(!a)throw new ge("MissingTransactionData");let A=await m({accountIdentifier:S,ownerAddress:g,pendingActivityRow:t,activityType:r,transactionData:a});o(A)}catch(A){n(A)}},[S,g,t,a,m,o,n,r]),isReadyToExecute:!l&&!e}}s();c();function Xo(e){return e instanceof ge?e:new ge("UnknownError")}function yu({stakedTokenSymbol:e,poolTokenSymbol:t,txHash:o,txError:n,confirmationStatus:r,eligibleAccountsCount:i,isConvertDelayed:a,durationUntilEpochEnds:u,onDismiss:d,onConvertMore:l}){let m={title:v.t("commandClose"),onPress:d},p={title:v.t("convertStakeStatusConvertMore"),onPress:l},g={txHash:o,txHashTitle:v.t("commandViewTransaction")};return n?{type:"error",title:v.t("convertStakeStatusErrorTitle"),message:v.t("convertStakeStatusErrorMessage",{poolTokenSymbol:t}),...g,primaryButton:m,showUKDisclaimer:!1,openExternalLink:void 0}:r==="confirmed"?{type:"success",title:v.t("convertStakeStatusSuccessTitle",{poolTokenSymbol:t}),message:"",...g,...i>1?{primaryButton:p,secondaryButton:m}:{primaryButton:m},showUKDisclaimer:!1,openExternalLink:void 0,...a?{title:v.t("convertStakeStatusSuccessTitleDelayed"),message:v.t("convertStakeStatusSuccessMessageDelayed",{durationUntilEpochEnds:u})}:{}}:{type:"loading",title:v.t("convertStakeStatusLoadingTitle",{poolTokenSymbol:t}),message:v.t("convertStakeStatusLoadingMessage",{stakedTokenSymbol:e,poolTokenSymbol:t}),...g,primaryButton:m,showUKDisclaimer:!1,openExternalLink:void 0}}var ku=({dismissConvertFlow:e,goToConvertAccountList:t})=>{let o=qo(),[n,r]=(0,it.useState)("loading"),[i,a]=(0,it.useState)(),[u,d]=(0,it.useState)(),{trackConvertSubmitted:l,trackConvertSuccess:m,trackConvertFailed:p,trackConvertMoreClicked:g}=Ft(),{usageState:S,setUsageState:y}=xe(),k=je(),A=B(st=>st.convert),b=B(st=>st.amount),[T]=(0,it.useState)(A?.eligibleAccountsCount??0),F=B(st=>st.convert),x=B(st=>st.setTransactionData),N=dt,R=N?.data.symbol??"",z=k?.stakePoolTokenMetadata.metadata.symbol??"",_=k?.stakePoolTokenMetadata.metadata.address??"",{data:ot}=ee(),at=ot?.type==="ledger",rt=(0,it.useMemo)(()=>(ot?.addresses??[]).find(st=>st.networkID===N?.data.chain.id),[N?.data.chain.id,ot?.addresses])?.addressType??"solana",{fungible:It,isLoadingTokens:Bt}=Lt({key:_}),le=ye(),Jt=(0,it.useCallback)(st=>{l(st.id),a(st),S.convert||y({convert:!0})},[y,l,S.convert]),Wt=(0,it.useCallback)(st=>{p({amount:b,convertDetails:A});let as=Xo(st);d(as)},[p,b,A]),$t=(0,it.useMemo)(()=>({topLeft:{text:v.t("convertStakePendingTitle",{symbol:z})}}),[z]),{executeLiquidStake:zt,isReadyToExecute:q}=Yo({isLoadingPoolToken:Bt,pendingActivityRow:$t,onTransactionSubmitted:Jt,onTransactionFailed:Wt,activityType:"convertStake"}),At=(0,it.useCallback)(()=>{m({amount:b,convertDetails:A,provider:k}),x(void 0),o()},[b,m,x,o,k,A]),{isSuccess:H,isError:Yt,error:no}=ho(At,i);(0,it.useEffect)(()=>{H?r("confirmed"):Yt&&(r("error"),d(no),p({amount:b,convertDetails:A}))},[b,A,H,Yt,p,no,i]);let ro=Jo({txReceipt:i,isTxError:Yt,poolTokenFungible:It,invalidateQueries:o,dismissLiquidStaking:e}),io=(0,it.useCallback)(()=>{g(),t()},[g,t]),is=(0,it.useMemo)(()=>yu({stakedTokenSymbol:R,poolTokenSymbol:z,txHash:i?.id,txError:u,confirmationStatus:n,eligibleAccountsCount:T,isConvertDelayed:Ve(F?.activationState),durationUntilEpochEnds:le,onDismiss:ro,onConvertMore:io}),[R,z,i?.id,u,n,T,F?.activationState,le,ro,io]);return{addressType:rt,isLedger:at,isReadyToExecute:q,statusPageProps:is,txError:u,executeLiquidStake:zt,learnMoreLink:Rn,isJitoSOL:!1,isPSOL:!0}};s();c();s();c();var Ya=I(E());s();c();var za=I(E());s();c();var Ba=(e,t)=>{let o=[],n=e?Nt(e):void 0,r=Tr(t?.stakePoolTokenMetadata.caip19??"");return n&&r&&(o.push(n),o.push(r)),{query:{data:o}}};s();c();var he=I(E());s();c();function Zo(e){return e?e.stakePoolTokenMetadata.caip19===re:!1}s();c();s();c();var Yw={name:"Jito",stakePoolAddress:"Jito4APyf642JPZPx3hGc6WWJ8zPKtRbRs4P815Awbb",apy:"0.0760131222374123",convertRatio:"1.1067926864808721",stakePoolTokenMetadata:{metadata:{address:"J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn",name:"Jito Staked SOL",symbol:"JitoSOL",decimals:9,logoURI:"https://storage.googleapis.com/token-metadata/JitoSOL-256.png",chainId:"solana:101"},caip19:"solana:101/address:J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn"},chainId:"solana:101",validators:[{vote_account:"validator"}]},Na={name:"Phantom Staked SOL",stakePoolAddress:"pSPcvR8GmG9aKDUbn9nbKYjkxt9hxMS7kF1qqKJaPqJ",apy:"0.0950000000000000",convertRatio:"1.0500000000000000",stakePoolTokenMetadata:{metadata:{address:$r,name:"Phantom Staked SOL",symbol:"PSOL",decimals:9,logoURI:"https://storage.googleapis.com/token-metadata/PSOL-256.png",chainId:"solana:101"},caip19:"solana:101/address:pSo1f9nQXWgXibFtKf7NWYxb5enAM4qfP6UJSiXRQfL"},chainId:"solana:101",validators:[{vote_account:"validator"}]};function Ze(e){return e?e.stakePoolTokenMetadata.caip19===Na.stakePoolTokenMetadata.caip19:!1}var Au=(e,t)=>{if(t===void 0)return;let o=Nt(e),n=te(o);return t[n]},bu=(e,t,o)=>{if(!t)return V(0);let n=new V(t.convertRatio),r=Tt(e,t.stakePoolTokenMetadata.metadata.decimals);return o?r.multipliedBy(n):r.div(n)};function Da(e,t,o){return t?{network:{id:t.stakePoolTokenMetadata.metadata.chainId??"solana:101",name:e.data.chain.name,symbol:e.data.chain.symbol,imageUrl:e.data.chain.imageUrl},priceData:o?o[t.stakePoolTokenMetadata.caip19]:void 0,decimals:t.stakePoolTokenMetadata.metadata.decimals,logoUri:t.stakePoolTokenMetadata.metadata.logoURI??null,symbol:t.stakePoolTokenMetadata.metadata.symbol,tokenAddress:t.stakePoolTokenMetadata.metadata.address,tokenType:"SPL"}:{network:{id:e.data.chain.id,name:e.data.chain.name,symbol:e.data.chain.symbol,imageUrl:e.data.chain.imageUrl},priceData:Au(e,o),decimals:e.data.decimals,logoUri:e.data.logoUri??null,symbol:e.data.symbol,tokenAddress:e.data.tokenAddress,tokenType:e.type??"SolanaNative"}}var Ra=(e,t,o,n,r=!1)=>{if(!e)return null;let{priceData:i,decimals:a,...u}=Da(e,r?t:void 0,n),d=Tt(o,a),l=i?.usd?d.multipliedBy(i.usd):null;return{amount:me(d),amountUsd:l?l.toNumber():null,border:!1,title:v.t("liquidStakeReviewYouPay"),...u}},qa=(e,t,o,n,r=!1)=>{if(!t||!e)return null;let{priceData:i,...a}=Da(e,r?void 0:t,n),u=bu(o,t,r),d=i?.usd?u.multipliedBy(i.usd):null;return{amount:me(u),amountUsd:d?d.toNumber():null,border:!1,title:r?v.t("liquidStakeUnstakeReviewYouReceive"):v.t("liquidStakeReviewYouReceive"),...a}},Va=({process:e,fungibleToStake:t,amount:o,provider:n,selectedChainAddress:r,transactionFees:i,isLoading:a,canSubmit:u,transactionData:d,priceMap:l,networkFeeErrorMsg:m,showUKDisclaimer:p})=>{let g=(0,he.useMemo)(()=>Ra(t,n,o,l),[t,n,o,l]),S=(0,he.useMemo)(()=>qa(t,n,o,l),[t,n,o,l]),y=n?.name??"",k=r?.address??"",A=n?.apy!==void 0?Se(Number.parseFloat(n.apy)):"",b=`${me(Tt(i,t?.data.decimals??0))} ${t?.data.symbol}`,T=Zo(n),F=Ze(n),x=n?.totalRewardsFeePercentage??"8",N=d?.solWithdrawalFee??d?.stakeWithdrawalFee,R=(0,he.useMemo)(()=>({accountLabelText:v.t("stakeReviewAccount"),providerLabelText:v.t("liquidStakeReviewProvider"),apyLabelText:v.t("stakeReviewAPY"),apyLabelTextTooltip:v.t("stakeReviewAPYTooltip"),networkFeeLabelText:v.t("liquidStakeReviewNetworkFee"),primaryButtonText:v.t(e==="convert"||e==="convertDelayed"?"commandConvert":"commandStake"),feeFootnoteText:v.t("liquidStakeReviewPhantomFeeFootnote",{totalRewardsFeePercentage:x}),feeFootnoteDescriptionText:v.t("liquidStakeReviewPhantomFeeFootnoteDescription",{withdrawalFeePercentage:N}),feeFootnoteTooltipText:v.t("liquidStakeReviewPhantomFeeFootnoteTooltip",{totalRewardsFeePercentage:x})}),[e,x,N]);return{process:e,payAsset:g,receiveAsset:S,account:k,providerName:y,apy:A,networkFee:b,strings:R,isLoading:a,canSubmit:u,networkFeeErrorMsg:m,isJitoSOL:T,isPSOL:F,showUKDisclaimer:p,totalRewardsFeePercentage:x}},fT=({stakedFungible:e,amount:t,provider:o,selectedChainAddress:n,transactionFees:r,isLoading:i,canSubmit:a,priceMap:u,networkFeeErrorMsg:d,transactionData:l})=>{let m=(0,he.useMemo)(()=>Ra(e,o,t,u,!0),[e,o,t,u]),p=(0,he.useMemo)(()=>qa(e,o,t,u,!0),[e,o,t,u]),g=n?.address??"",S=`${me(Tt(r,e?.data.decimals??0))} ${e?.data.symbol}`,y=l?.isWithdrawSol??!0,k=y?l?.solWithdrawalFee??.1:l?.stakeWithdrawalFee??.1,A=(0,he.useMemo)(()=>({accountLabelText:v.t("stakeReviewAccount"),networkFeeLabelText:v.t("liquidStakeReviewNetworkFee"),primaryButtonText:v.t("commandUnstake"),feeLabelText:v.t("unstakeLiquidStakeFee"),feeLabelTextTooltip:v.t("unstakeLiquidStakeFeeTooltip"),unstakeDelayDisclaimerText:v.t("unstakeLiquidStakeDelayDisclaimer"),feePercentageText:`${k}%`}),[k]),b=ie();return{payAsset:m,receiveAsset:p,account:g,networkFee:S,strings:A,isLoading:i,canSubmit:a,networkFeeErrorMsg:d,isWithdrawSol:y,showUKDisclaimer:b}};s();c();var Ka=I(E());var vu=K({seconds:10}),Wa=({hasPoolTokenAccount:e,chainAddress:t,transactionData:o})=>{let{data:n,isPending:r,isFetched:i,isSuccess:a}=Gr({networkID:o?.networkID??M.solana.mainnetID,multichainTransaction:Tu(o),queryOptions:{refetchInterval:vu}}),{data:u=0}=Xr(t),d=j(Eo).plus(De),l=e?j(d):j(u).plus(d),{hasSufficientFunds:m,isLoading:p,nativeTokenSymbol:g}=Jr({networkID:o?.networkID??M.solana.mainnetID,addressType:t?.addressType,gasEstimation:n,transactionValue:l}),S=Pu({hasSufficientFunds:m,hasGasEstimationFailed:i&&!a,nativeTokenSymbol:g}),y=wu(n),k=l.plus(y),A=r||p;return(0,Ka.useMemo)(()=>({isLoading:A,hasSufficientFunds:m,transactionFees:k,networkFeeErrorMsg:S,nativeTokenSymbol:g}),[A,m,k,S,g])},wu=e=>e?M.isSolanaNetworkID(e.networkID)?new j(e.value):new j(0):new j(0),Tu=e=>{if(e&&M.isSolanaNetworkID(e.networkID)){let{networkID:t,transaction:o}=e;return{networkID:t,transaction:[o]}}},Pu=({hasSufficientFunds:e,hasGasEstimationFailed:t,nativeTokenSymbol:o})=>t?v.t("transactionGasEstimationError"):e==="insufficient"?v.t("transactionNotEnoughNative",{nativeTokenSymbol:o}):void 0;var tn=({process:e,provider:t,transactionData:o,isLoadingTransactionData:n})=>{let r=dt,i=B(x=>x.amount),{data:a}=yt("solana"),{fungible:u,isLoadingTokens:d}=Lt({key:t?.stakePoolTokenMetadata.metadata.address||""}),{isLoading:l,hasSufficientFunds:m,transactionFees:p,networkFeeErrorMsg:g}=Wa({hasPoolTokenAccount:!!u,chainAddress:a,transactionData:o}),S=(0,za.useMemo)(()=>Ba(r,t),[r,t]),{data:y}=zr(S),k=n||l||d,A=!k&&!!o&&m!=="insufficient"&&!g,b=ie();return Va({process:e,fungibleToStake:r,amount:i,provider:t,selectedChainAddress:a,transactionFees:p,transactionData:o,isLoading:k,canSubmit:A,priceMap:y,networkFeeErrorMsg:g,showUKDisclaimer:e==="mint"&&b})};s();c();s();c();s();c();s();c();s();c();s();c();s();c();function xu(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function dr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Qa(e,t){xu(e);let o=t.outputLen;if(e.length<o)throw new Error(`digestInto() expects output buffer of length at least ${o}`)}s();c();var Iu=e=>e instanceof Uint8Array;var on=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Ut=(e,t)=>e<<32-t|e>>>t,Lu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Lu)throw new Error("Non little-endian hardware is not supported");function Cu(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function lr(e){if(typeof e=="string"&&(e=Cu(e)),!Iu(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var en=class{clone(){return this._cloneInto()}},QT={}.toString;function Ga(e){let t=n=>e().update(lr(n)).digest(),o=e();return t.outputLen=o.outputLen,t.blockLen=o.blockLen,t.create=()=>e(),t}function Eu(e,t,o,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,o,n);let r=BigInt(32),i=BigInt(4294967295),a=Number(o>>r&i),u=Number(o&i),d=n?4:0,l=n?0:4;e.setUint32(t+d,a,n),e.setUint32(t+l,u,n)}var nn=class extends en{constructor(t,o,n,r){super(),this.blockLen=t,this.outputLen=o,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=on(this.buffer)}update(t){dr(this);let{view:o,buffer:n,blockLen:r}=this;t=lr(t);let i=t.length;for(let a=0;a<i;){let u=Math.min(r-this.pos,i-a);if(u===r){let d=on(t);for(;r<=i-a;a+=r)this.process(d,a);continue}n.set(t.subarray(a,a+u),this.pos),this.pos+=u,a+=u,this.pos===r&&(this.process(o,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){dr(this),Qa(t,this),this.finished=!0;let{buffer:o,view:n,blockLen:r,isLE:i}=this,{pos:a}=this;o[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>r-a&&(this.process(n,0),a=0);for(let p=a;p<r;p++)o[p]=0;Eu(n,r-8,BigInt(this.length*8),i),this.process(n,0);let u=on(t),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=d/4,m=this.get();if(l>m.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<l;p++)u.setUint32(4*p,m[p],i)}digest(){let{buffer:t,outputLen:o}=this;this.digestInto(t);let n=t.slice(0,o);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:o,buffer:n,length:r,finished:i,destroyed:a,pos:u}=this;return t.length=r,t.pos=u,t.finished=i,t.destroyed=a,r%o&&t.buffer.set(n),t}};var Fu=(e,t,o)=>e&t^~e&o,_u=(e,t,o)=>e&t^e&o^t&o,Mu=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ce=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ue=new Uint32Array(64),pr=class extends nn{constructor(){super(64,32,8,!1),this.A=ce[0]|0,this.B=ce[1]|0,this.C=ce[2]|0,this.D=ce[3]|0,this.E=ce[4]|0,this.F=ce[5]|0,this.G=ce[6]|0,this.H=ce[7]|0}get(){let{A:t,B:o,C:n,D:r,E:i,F:a,G:u,H:d}=this;return[t,o,n,r,i,a,u,d]}set(t,o,n,r,i,a,u,d){this.A=t|0,this.B=o|0,this.C=n|0,this.D=r|0,this.E=i|0,this.F=a|0,this.G=u|0,this.H=d|0}process(t,o){for(let p=0;p<16;p++,o+=4)ue[p]=t.getUint32(o,!1);for(let p=16;p<64;p++){let g=ue[p-15],S=ue[p-2],y=Ut(g,7)^Ut(g,18)^g>>>3,k=Ut(S,17)^Ut(S,19)^S>>>10;ue[p]=k+ue[p-7]+y+ue[p-16]|0}let{A:n,B:r,C:i,D:a,E:u,F:d,G:l,H:m}=this;for(let p=0;p<64;p++){let g=Ut(u,6)^Ut(u,11)^Ut(u,25),S=m+g+Fu(u,d,l)+Mu[p]+ue[p]|0,k=(Ut(n,2)^Ut(n,13)^Ut(n,22))+_u(n,r,i)|0;m=l,l=d,d=u,u=a+S|0,a=i,i=r,r=n,n=S+k|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,a=a+this.D|0,u=u+this.E|0,d=d+this.F|0,l=l+this.G|0,m=m+this.H|0,this.set(n,r,i,a,u,d,l,m)}roundClean(){ue.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Ha=Ga(()=>new pr);var ja=I(us()),Uu=[69,107,109,106,121,122,120,100,105,53,52,51,110,99,76,56,54,116,99,97,67,65,100,117,108,79,119,121,110,86,53,68,118,54,86,67,109,73,84,117,118,48,51,118,53,101,98,76,80,98,48,88,101,57,111,108,82,71,75,72,85,71,119,68,117,116,111,117,68,117,77,55,49,88,65,106,55,97,111,74,102,77,78,106,56,119,61,61],rn=e=>{let t=`${String.fromCharCode(...Uu)}||${e}`,o=Ha(Buffer.from(t));return ja.default.encode(o)};var mr=async({connection:e,stakePoolAddress:t,ownerAddress:o,amount:n,poolTokenAccountAddress:r})=>{let i=new h.PublicKey(t),a=new h.PublicKey(o),u=r?new h.PublicKey(r):void 0,d=new h.PublicKey(rn(o)),{instructions:l,signers:m,solWithdrawalFee:p,stakeWithdrawalFee:g}=await jo(e,i,a,n,u,d),S=(await e.getLatestBlockhash("confirmed")).blockhash,y=new Q.VersionedTransaction(new Q.TransactionMessage({instructions:l,payerKey:a,recentBlockhash:S}).compileToV0Message());return{transaction:await Gt(y,{connection:fo(St.Solana.Mainnet),calculators:{cost:go,budget:new So(2e5,2e5)}}),signers:m,solWithdrawalFee:p,stakeWithdrawalFee:g}};s();c();async function Ja({connection:e,stakePoolAddress:t,amount:o,senderAddress:n,useWithdrawSol:r}){let i=new h.PublicKey(n),a,u,d,l;if(r){let S=await Ea(e,new h.PublicKey(t),i,i,o).catch(y=>{throw G.captureError(y,"staking"),y});a=S.instructions,u=S.signers,d=S.solWithdrawalFee,l=S.stakeWithdrawalFee}else{let S=await Ca(e,new h.PublicKey(t),i,o).catch(y=>{throw G.captureError(y,"staking"),y});a=S.instructions,u=S.signers,d=S.solWithdrawalFee,l=S.stakeWithdrawalFee}let m=(await e.getLatestBlockhash("confirmed")).blockhash,p=new Q.VersionedTransaction(new Q.TransactionMessage({instructions:a,payerKey:i,recentBlockhash:m}).compileToV0Message());return{transaction:await Gt(p,{connection:e}),signers:u,solWithdrawalFee:d,stakeWithdrawalFee:l}}async function Ou({connection:e,stakePoolAddress:t,amount:o,senderAddress:n,useWithdrawSol:r}){try{let i=await Ja({connection:e,stakePoolAddress:t,amount:o,senderAddress:n,useWithdrawSol:r}),a=await e.simulateTransaction(i.transaction,{sigVerify:!1});if(a.value.err)throw new Error(`Simulation failed with useWithdrawSol: true - ${JSON.stringify(a.value.err)}`);return{...i,isWithdrawSol:r}}catch(i){G.captureError(i instanceof Error?i:new Error(String(i)),"staking");try{return{...await Ja({connection:e,stakePoolAddress:t,amount:o,senderAddress:n,useWithdrawSol:!1}),isWithdrawSol:!1}}catch(a){throw G.captureError(a instanceof Error?a:new Error(String(a)),"staking"),a}}}s();c();var an=async({connection:e,stakePoolAddress:t,stakePubkey:o,ownerAddress:n,amount:r})=>{let i=new h.PublicKey(t),a=new h.PublicKey(n),u=new h.PublicKey(o),d=new h.PublicKey(rn(n)),l=h.StakeProgram.withdraw({stakePubkey:u,authorizedPubkey:a,toPubkey:a,lamports:r}),[m]=l.instructions,{instructions:p,signers:g,solWithdrawalFee:S,stakeWithdrawalFee:y}=await jo(e,i,a,r,void 0,d,void 0,void 0,!1),k=[m,...p],A=(await e.getLatestBlockhash("confirmed")).blockhash,b=new Q.TransactionMessage({instructions:k,payerKey:a,recentBlockhash:A}).compileToV0Message(),T=new Q.VersionedTransaction(b);return{transaction:await Gt(T,{connection:fo(St.Solana.Mainnet),calculators:{cost:go,budget:new So(2e5,2e5)}}),signers:g,solWithdrawalFee:S,stakeWithdrawalFee:y}};var $a=e=>{let t=U.getConvertStakeTransaction({stakePoolAddress:e.stakePoolAddress,ownerAddress:e.ownerAddress,validatorVoteAddress:"",stakeAccountAddress:e.stakePubkey}),o=!e.disabled&&!!e.stakePoolAddress&&!!e.ownerAddress&&!!e.stakePubkey&&!!e.amount;return L({enabled:o,queryKey:t,staleTime:K({seconds:30}),async queryFn(){if(M.isSolanaNetworkID(e.networkId))try{let{transaction:n,signers:r,solWithdrawalFee:i,stakeWithdrawalFee:a}=await an({connection:e.connection,stakePoolAddress:e.stakePoolAddress,stakePubkey:e.stakePubkey,ownerAddress:e.ownerAddress,amount:e.amount});return{networkID:e.networkId,transaction:n,signers:r,solWithdrawalFee:i,stakeWithdrawalFee:a}}catch(n){throw G.captureError(n,"staking"),n}throw new Error(`Unsupported networkId: ${e.networkId}`)}})};var Bu=(e,t,o)=>{let{data:n}=yt("solana"),{trackConvertApprovedByUser:r}=Ft(),i=B(F=>F.amount),a=B(F=>F.setTransactionData),u=ye(),{connection:d}=kt(),{data:l,isLoading:m}=Ma({connection:d,stakePubkey:new h.PublicKey(t.stakeAccount??""),stakeAuthorityPubkey:new h.PublicKey(t.stakeAuthorityPubkey??""),authorizedPubkey:new h.PublicKey(n?.address??""),stakePoolAddress:new h.PublicKey(e?.stakePoolAddress??""),disabled:t.activationState!=="active"&&t.activationState!=="activating"}),{data:p,isLoading:g}=$a({connection:d,networkId:e?.chainId??M.solana.mainnetID,stakePoolAddress:e?.stakePoolAddress??"",ownerAddress:n?.address??"",stakePubkey:t?.stakeAccount??"",amount:parseInt(i),disabled:t?.activationState!=="inactive"}),S=qe(t?.activationState),y=Ve(t?.activationState),k=S?p:y?l:void 0,A=S?g:y?m:!1,b=tn({process:t?.activationState==="active"?"convertDelayed":"convert",provider:e,transactionData:k,isLoadingTransactionData:A}),T=(0,Ya.useCallback)(()=>{r({provider:e,convertDetails:t,amount:i,fromAmount:b.payAsset?.amount,toAmount:b.receiveAsset?.amount,fromAmountUSD:b.payAsset?.amountUsd,toAmountUSD:b.receiveAsset?.amountUsd}),a(k),o()},[o,a,k,r,t,e,b,i]);return{...b,durationUntilEpochEnds:u,onPrimaryButtonPress:T}};s();c();s();c();s();c();var Xa=(e,t)=>new j(e).div(mo(t)).toString();s();c();var Za=e=>e.replace(/,|\.{2,}/g,".").replace(/^[0]+/g,"0").replace(/^\./g,"0.").replace(/[^\d.]/g,"");s();c();var ts=(e,t)=>t===0?new j(e):new j(e).multipliedBy(mo(t));var Ot=I(E());s();c();var Nu=2,es=({networkID:e,poolTokenMintAddress:t})=>{let o=M.getAddressType(e),{fungible:n}=Lt({key:t}),r=Zr(e,o),{fungible:i}=Lt({key:r}),a=V(i?.data.amount??""),u=V(Eo),d=V(De),l=V(De),m=V(Nu).plus(u),p=n?V(m).plus(d):V(l).plus(m).plus(d),g=V(a).minus(p),S=V.max(g,0);return{minAmount:p,maxAmount:S,balance:a}};var Du=e=>{if(e.isLessThan(.01))return e.toString();let t=e.dp();return e.isLessThan(1)&&t&&t>1?e.toFixed(2,V.ROUND_FLOOR):parseFloat(e.toFixed(1,V.ROUND_FLOOR)).toString()},Ru=({goBack:e,goToReviewPage:t,showInfoPage:o,lstCaip19:n})=>{let r=dt,i=B(q=>q.amount),a=B(q=>q.setAmount),u=B(q=>q.setProvider),d=r?.data.symbol??"",l=r?.data.chain.id??M.solana.mainnetID,m=r?.data.decimals??dt.data.decimals,{data:p}=yt("solana"),{pickedLSTProvider:g}=_t(M.solana.mainnetID),S=g(n),y=S?.stakePoolTokenMetadata.metadata.address??"";oi(p,"STAKE_FUNGIBLE");let{minAmount:k,maxAmount:A,balance:b}=es({networkID:l,poolTokenMintAddress:y}),T=(0,Ot.useMemo)(()=>{if(i)return Xa(i,m);let q=b.multipliedBy(.95),At=V.max(V.min(q,A),k);return Du(Tt(At,m))},[i,b,m,A,k]),[F,x]=(0,Ot.useState)(T),N=Tt(A,m),R=Tt(k,m),z=Tt(b,m),_=ts(F,m).toString(),ot=V(_),at=b.isLessThan(k),nt=ot.isGreaterThan(A),rt=ot.isFinite(),It=(0,Ot.useMemo)(()=>{if(!S)return v.t("mintLiquidStakeAmountNoProviders");if(_&&at)return v.t("mintLiquidStakeAmountMinRequired",{symbol:d,amount:R});if(_&&nt)return v.t("mintLiquidStakeAmountInsufficientBalance")},[S,_,at,nt,R,d]),Bt=rt&&!It,le=(0,Ot.useMemo)(()=>{if(!S)return;let q=Se(Number.parseFloat(S.apy)),{address:At,name:H,symbol:Yt,logoURI:no}=S.stakePoolTokenMetadata.metadata,ro=V(1).dividedBy(V(S.convertRatio)),io=`1 ${d} \u2248 ${me(ro)} ${Yt}`;return{identifier:At,apy:q,name:H,symbol:Yt,rate:io,logoURI:no}},[S,d]),Jt=(0,Ot.useCallback)(()=>{x(String(N))},[N]),Wt=(0,Ot.useCallback)(q=>{let At=Za(q);Fo(At,m??9)&&x(At)},[m]),$t=(0,Ot.useCallback)(()=>{u(S),a(_),t()},[S,_,t,a,u]),zt=(0,Ot.useCallback)(()=>{a(""),e()},[a,e]);return{amount:F,amountError:It,balance:z,symbol:d,poolToken:le,canSubmit:Bt,onBack:zt,onContinue:$t,onChangeAmount:Wt,onSetMax:Jt,onInfoPress:o}};s();c();var de=I(E());var sn=null,qu=e=>{if(!sn&&e){let t="liquidStake";sn=new ve(e,t)}if(!sn)throw new Error("liquidStakeAnalytics was not properly configured");return sn},xt=()=>{let e=wt(),t=qu(e),o=p=>{switch(p){case O:return"Phantom Staked SOL";case re:return"Jito Staked SOL";default:return}},n=p=>{switch(p){case O:return"PSOL";case re:return"JITOSOL";default:return}},r=(0,de.useCallback)(({provider:p,entryPoint:g,testVariant:S})=>{e.capture("liquidStakingMarketingPageSeen",{data:{lstCaip19:p,lstSymbol:n(p),entryPoint:g,testVariant:S??""}})},[e]),i=(0,de.useCallback)(({lstCaip19:p,testVariant:g,entryPoint:S})=>{e.capture("liquidStakingMarketingPagePrimaryButtonClicked",{data:{stake:{caip19:p,lstSymbol:n(p),testVariant:g,entryPoint:S}}})},[e]),a=(0,de.useCallback)(p=>{let g=p?o(p):void 0,S=p?n(p):void 0;e.capture("liquidStakingMintModalContinueClicked",{data:{stake:{caip19:p,token:g,tokenSymbol:S}}})},[e]),u=(0,de.useCallback)(({provider:p,payAmount:g,receiveAmount:S,payAmountUSD:y,receiveAmountUSD:k,payAssetTitle:A,providerName:b,receiveAssetTitle:T})=>{e.capture("liquidStakingMintApprovedByUser",{data:{stake:{stakePoolAddress:p?.stakePoolAddress,token:p?.stakePoolTokenMetadata.metadata.name,apy:p?.apy,convertRatio:p?.convertRatio,caip19:p?.stakePoolTokenMetadata.caip19,payAmount:g,receiveAmount:S,payAmountUSD:y,receiveAmountUSD:k,payAssetTitle:A,receiveAssetTitle:T,providerName:b}}})},[e]),d=(0,de.useCallback)(p=>{t.submittedTransaction(p,{chainType:"solana",chainName:"solana",networkId:"mainnet",method:"signAndSendTransaction"})},[t]),l=(0,de.useCallback)(({provider:p,amount:g})=>{e.capture("liquidStakingMintSuccess",{data:{stake:{apy:p?.apy,convertRatio:p?.convertRatio,caip19:p?.stakePoolTokenMetadata.caip19,stakePoolAddress:p?.stakePoolAddress,token:p?.stakePoolTokenMetadata.metadata.name,totalAmount:g}}})},[e]),m=(0,de.useCallback)(p=>{e.capture("liquidStakingMintFailed",{data:{stake:{amount:p}}})},[e]);return{trackMintModalContinue:a,trackMarketingModalSeen:r,trackMarketingModalContinue:i,trackMintSubmitted:d,trackMintSuccess:l,trackMintFailed:m,trackMintApprovedByUser:u}};s();c();var pt=I(E());var Vu="https://www.jito.network/defi/";function Ku({poolTokenSymbol:e,txHash:t,txError:o,confirmationStatus:n,showUKDisclaimer:r,onDismiss:i,openExternalLink:a}){let u={title:v.t("commandClose"),onPress:i},d={txHash:t,txHashTitle:v.t("commandViewTransaction")};return o?{type:"error",title:v.t("mintStakeStatusErrorTitle"),message:v.t("mintStakeStatusErrorMessage",{poolTokenSymbol:e}),...d,primaryButton:u,showUKDisclaimer:r,openExternalLink:a}:n==="confirmed"?{type:"success",title:v.t("mintStakeStatusSuccessTitle"),message:"",...d,primaryButton:u,showUKDisclaimer:r,openExternalLink:a}:{type:"loading",title:v.t("mintStakeStatusLoadingTitle"),message:v.t("mintStakeStatusLoadingMessage"),...d,primaryButton:u,showUKDisclaimer:r,openExternalLink:a}}var Wu=(e,t)=>{let o=qo(),[n,r]=(0,pt.useState)("loading"),[i,a]=(0,pt.useState)(),[u,d]=(0,pt.useState)(),{trackMintSubmitted:l,trackMintSuccess:m,trackMintFailed:p}=xt(),{usageState:g,setUsageState:S}=xe(),y=B(H=>H.provider),k=B(H=>H.setTransactionData),A=B(H=>H.amount),b=dt,T=y?.stakePoolTokenMetadata.metadata.symbol??"",F=y?.stakePoolTokenMetadata.metadata.address??"",{data:x}=ee(),N=x?.type==="ledger",z=(0,pt.useMemo)(()=>(x?.addresses??[]).find(H=>H.networkID===b?.data.chain.id),[b?.data.chain.id,x?.addresses])?.addressType??"solana",{fungible:_,isLoadingTokens:ot}=Lt({key:F}),at=(0,pt.useCallback)(H=>{l(H.id),a(H),g.mint||S({mint:!0})},[S,l,g.mint]),nt=(0,pt.useCallback)(H=>{p(A);let Yt=Xo(H);d(Yt)},[p,A]),rt=(0,pt.useMemo)(()=>({topLeft:{text:v.t("mintLiquidStakePendingTitle")}}),[]),{executeLiquidStake:It,isReadyToExecute:Bt}=Yo({isLoadingPoolToken:ot,pendingActivityRow:rt,onTransactionSubmitted:at,onTransactionFailed:nt,activityType:"delegateStake"}),le=(0,pt.useCallback)(()=>{m({amount:A,provider:y}),k(void 0),o()},[m,A,y,k,o]),{isSuccess:Jt,isError:Wt,error:$t}=ho(le,i);(0,pt.useEffect)(()=>{Jt?r("confirmed"):Wt&&(r("error"),d($t),p(A))},[Jt,p,A,Wt,$t,i]);let zt=Jo({txReceipt:i,isTxError:Wt,poolTokenFungible:_,invalidateQueries:o,dismissLiquidStaking:e}),q=ie(),At=(0,pt.useMemo)(()=>Ku({poolTokenSymbol:T,txHash:i?.id,txError:u,confirmationStatus:n,showUKDisclaimer:q,onDismiss:zt,openExternalLink:t}),[T,i?.id,u,n,zt,t,q]);return{addressType:z,isLedger:N,isReadyToExecute:Bt,statusPageProps:At,learnMoreLink:Vu,txError:u,executeLiquidStake:It,isJitoSOL:Zo(y),isPSOL:Ze(y)}};s();c();var eo=I(E());function zu({navigateToMintLiquidStakeAmountPage:e,navigateBack:t,entryPoint:o}){let{trackMarketingModalContinue:n}=xt(),{mutate:r}=Ct("StakingWelcomeNew"),i=xr("psol-popup-copy-test"),a=(0,eo.useCallback)(()=>{n({lstCaip19:O,testVariant:i,entryPoint:o}),e(O),r()},[e,n,r,i,o]),u=(0,eo.useCallback)(()=>{t(),r()},[t,r]),{t:d}=J(),l={title:d("liquidStakingInfoPageStillEarningZero"),description:d("liquidStakingInfoPageConvertYourSOL"),primaryButtonText:d("liquidStakingInfoPageConvertYourSOLButton")},m={title:d("liquidStakingInfoPageEarnUpTo9APY"),description:d("liquidStakingInfoPageConvertYourSOL2"),primaryButtonText:d("liquidStakingInfoPageStartEarning")},p=i==="test1"?l:i==="test2"?m:l;return(0,eo.useLayoutEffect)(()=>()=>r(),[r]),{onPrimaryButtonPress:a,onClose:u,viewState:p}}s();c();s();c();var ns=I(E());s();c();var os=e=>{let t=U.getMintTokenTransaction({stakePoolAddress:e.stakePoolAddress,ownerAddress:e.ownerAddress,amount:e.amount,poolTokenAccountAddress:e.poolTokenAccountAddress}),o=!!e.stakePoolAddress&&!!e.ownerAddress&&!!e.amount;return L({enabled:o,queryKey:t,staleTime:1/0,async queryFn(){if(M.isSolanaNetworkID(e.networkId))try{let{transaction:n,signers:r,solWithdrawalFee:i,stakeWithdrawalFee:a}=await mr(e);return{networkID:e.networkId,transaction:n,signers:r,solWithdrawalFee:i,stakeWithdrawalFee:a}}catch(n){throw G.captureError(n,"staking"),n}throw new Error(`Unsupported networkId: ${e.networkId}`)}})};var Qu=(e,t)=>{let o=B(S=>S.amount),n=B(S=>S.setTransactionData),{data:r}=yt("solana"),{connection:i}=kt(),{fungible:a}=Lt({key:e?.stakePoolTokenMetadata.metadata.address||""}),u=a?ti(a):void 0,{trackMintApprovedByUser:d}=xt(),{data:l,isPending:m}=os({amount:j(o).toNumber(),connection:i,networkId:e?.chainId??M.solana.mainnetID,stakePoolAddress:e?.stakePoolAddress??"",ownerAddress:r?.address??"",poolTokenAccountAddress:u}),p=tn({provider:e,process:"mint",transactionData:l,isLoadingTransactionData:m}),g=(0,ns.useCallback)(()=>{d({provider:e,payAmount:p.payAsset?.amount,receiveAmount:p.receiveAsset?.amount,payAmountUSD:p.payAsset?.amountUsd,receiveAmountUSD:p.receiveAsset?.amountUsd,payAssetTitle:p.payAsset?.title,receiveAssetTitle:p.receiveAsset?.title,providerName:p.providerName}),n(l),t()},[d,e,p.payAsset?.amount,p.payAsset?.amountUsd,p.payAsset?.title,p.receiveAsset?.amount,p.receiveAsset?.amountUsd,p.receiveAsset?.title,p.providerName,n,l,t]);return{...p,onPrimaryButtonPress:g}};s();c();var Gu=I(E());s();c();s();c();var oo=I(E());var Hu=(e,t)=>{let{navigateToStake:o,navigateToUnstake:n,navigateToExternalLink:r}=e,{trackMintModalContinue:i}=xt(),a=Vt(O),u=gt("enable-psol-staking"),d=gt("enable-deposit-psol-with-kamino-link"),p=!t||t===Yr?u&&a?O:re:t,g=(0,oo.useCallback)(()=>{o(p)},[o,p]),S=(0,oo.useCallback)(()=>{i(p),o(p)},[o,i,p]),y=(0,oo.useCallback)(()=>{p===O?n():r(Nn)},[n,r,p]),k=(0,oo.useCallback)(()=>{r(qn)},[r]),A=tr({method:"mint",goToInfoPage:g,goToInitFlowPage:S});return Vt(p)?{isSupported:!0,onStake:A,onUnstake:y,onDepositWithKamino:d?k:void 0}:{isSupported:!1,onStake:void 0,onUnstake:void 0,onDepositWithKamino:void 0}};s();c();var Ce=I(E()),ju="https://phantom.com/en-GB/uk-risk-summary";function fr({navigateToExternalLink:e,paddingTop:t,marginX:o,paddingX:n}){let{t:r}=J();return Ce.default.createElement(Z,{backgroundColor:"brandMidnight",paddingX:n??"screen",marginX:o,paddingBottom:12,style:{paddingTop:(t??0)+4},gap:8},Ce.default.createElement(W,null,Ce.default.createElement(pe,null,Ce.default.createElement(W,{font:"captionSemibold",color:"textBase"},r("stakingUKDisclaimerPart1"))," ",Ce.default.createElement(W,{font:"captionSemibold",color:"textBase",onPress:()=>e(ju),style:{textDecorationLine:"underline"}},r("stakingUKDisclaimerTake2Mins")))))}s();c();var Sr=I(E());function Ju({navigateToMintLiquidStakeAmountPage:e,navigateBack:t}){let{trackMintModalContinue:o}=xt(),n=(0,Sr.useCallback)(()=>{o(O),e(O)},[e,o]),r=(0,Sr.useCallback)(()=>{t()},[t]),i={imageUrl:"https://assets.phantom.app/assets/metadata/PSOL.png",title:v.t("mintPSOLInfoPageTitle"),features:[{icon:"InfoCircle",title:v.t("mintPSOLFeature1Title"),description:v.t("mintPSOLFeature1Description")},{icon:"TrendingUp",title:v.t("mintPSOLFeature2Title"),description:v.t("mintPSOLFeature2Description")},{icon:"ShieldVerified",title:v.t("mintPSOLFeature3Title"),description:v.t("mintPSOLFeature3Description")}],primaryButtonText:v.t("gotIt")};return{onPrimaryButtonPress:n,onClose:r,viewState:i}}s();c();var ft=I(E());s();c();var mt=I(E());function rs({marginTop:e}){let{t}=J();return mt.default.createElement(Z,{marginTop:e},mt.default.createElement(dn,{content:mt.default.createElement(Z,{padding:16},mt.default.createElement(W,null,t("stakingUKDisclaimerPastPerformanceBody")))},mt.default.createElement(W,{font:"caption",color:"brandYellowMoon"},t("stakingUKDisclaimerPastPerformance"))),mt.default.createElement(W,null,mt.default.createElement(pe,null,mt.default.createElement(W,{font:"caption",color:"textDiminished"},t("stakingUKDisclaimerExchangeRates"))," ")),mt.default.createElement(dn,{content:mt.default.createElement(Z,{padding:16},mt.default.createElement(W,null,t("stakingUKDisclosuresMarketDataBody")))},mt.default.createElement(W,{font:"caption",color:"brandPrimary"},t("stakingUKDisclaimerDisclosures"))),mt.default.createElement(W,{font:"caption",color:"textDiminished",marginTop:24},t("stakingUKDisclaimerApproval")))}var $u={InfoCircle:po.InfoCircle,TrendingUp:po.TrendingUp,ShieldVerified:po.ShieldVerified};function Yu(e){return ft.default.createElement($u[e],{size:24})}function Xu({viewState:e,openLink:t,onPastPerformancePress:o,onDisclosuresPress:n}){let{features:r,title:i,imageUrl:a}=e;return ft.default.createElement(Z,{flex:1,backgroundColor:"areaBase",borderRadius:"row",width:"100%",maxWidth:400},ft.default.createElement(fr,{marginX:"-16",paddingX:12,paddingTop:8,navigateToExternalLink:t}),ft.default.createElement(Z,{alignItems:"center",padding:24,marginY:16},ft.default.createElement(Nr,{src:a,size:100})),ft.default.createElement(W,{color:"white",font:"title1Bold",marginBottom:16,align:"center"},i),ft.default.createElement(Z,{gap:"list",marginBottom:"screen"},r.map(u=>ft.default.createElement(Z,{key:u.title,direction:"row",alignItems:"flex-start",marginBottom:16},ft.default.createElement(Z,{width:24,height:24,marginRight:"screen",alignItems:"center",justifyContent:"center"},Yu(u.icon)),ft.default.createElement(Z,{flex:1},ft.default.createElement(W,{color:"white",font:"bodySemibold",marginBottom:2},u.title),ft.default.createElement(W,{color:"textDiminished",font:"caption"},u.description))))),ft.default.createElement(rs,{marginTop:0,showPastPerformanceInline:!0,onPastPerformancePress:o,onDisclosuresPress:n}))}s();c();s();c();var Zu=["liquidStakingSupportedTokens","featureUsed",Gn],td=e=>{let t=String(e.queryKey[1]);return Zu.includes(t)};s();c();export{we as a,Dt as b,ms as c,Sn as d,fs as e,Ss as f,ks as g,hs as h,gs as i,yn as j,Me as k,As as l,ci as m,Ct as n,bs as o,vs as p,ws as q,Is as r,Wf as s,zf as t,Se as u,Xa as v,Za as w,ts as x,Vs as y,Ks as z,dt as A,Ws as B,Rn as C,re as D,Eo as E,De as F,zs as G,gS as H,qe as I,Ve as J,Oi as K,U as L,Fo as M,jn as N,B as O,td as P,We as Q,Pe as R,Yn as S,Ft as T,kc as U,hc as V,Ac as W,Yi as X,vc as Y,Tc as Z,Cc as _,Ec as $,Fc as aa,He as ba,Vt as ca,_t as da,Rc as ea,tr as fa,Uc as ga,da as ha,ie as ia,ye as ja,Ro as ka,Kc as la,Ba as ma,Na as na,fT as oa,Wa as pa,er as qa,Vv as ra,Ou as sa,Bu as ta,Yo as ua,ku as va,Ru as wa,xt as xa,Qu as ya,Wu as za,zu as Aa,Hu as Ba,fr as Ca,Ju as Da,rs as Ea,Xu as Fa};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-Q2MU5Q7Q.js.map
