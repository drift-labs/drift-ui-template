import{G as et,K as B,L as at,N as R,Q as ot,R as W,X as K,aa as O,ba as nt,da as Q,qa as E,s as tt}from"./chunk-Q2MU5Q7Q.js";import{I as M,J as F}from"./chunk-IHXFHG2Y.js";import{na as $}from"./chunk-QCKHHJ5F.js";import{na as X}from"./chunk-R5GARSZH.js";import{mb as C,rc as V}from"./chunk-F63TUCMM.js";import{Lc as Y,Pc as N,Q as q,T as L,U as s,Zb as c,_ as G,ba as J,jd as v,ld as x,od as Z}from"./chunk-PJ6PRBE2.js";import{X as g,c as P}from"./chunk-UTOBJRXZ.js";import{f as I,h as o,n}from"./chunk-SVG5OEFH.js";o();n();var U=I(P());o();n();var rt={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"info.name",weight:.5},{name:"info.keybaseUsername",weight:.3},{name:"info.website",weight:.1},{name:"voteAccountPubkey",weight:.1},{name:"identityPubkey",weight:.1}]},it={identityPublicKey:"7GkMBmtrTZz8QbjSe1sXvAUtz7Pp42SQxfT5ymmJD4We",voteAccountPublicKey:"J2nUHEAgZFRyuJbFjdqPrAa9gyWDuc7hErtDQHPhsYRp"};o();n();var st=e=>(r,i)=>{let t=e.indexOf(r.voteAccountPubkey),u=e.indexOf(i.voteAccountPubkey);return(t>-1?t:1/0)-(u>-1?u:1/0)};o();n();o();n();var ct=new Error("Failed to fetch recommended staking validators.");async function ut(){try{let e=await G.api().get("/staking/v1/recommended");if(!J(e))throw ct;let r=e.data;return et.parse(r).validators}catch{throw ct}}var mt=()=>{let e=at.recommendedValidators();return Z({enabled:!0,queryKey:e,gcTime:ot.Long,staleTime:1/0,async queryFn(){return ut()}})};function At(){let{connection:e}=M(),r=W(e),{results:i=[]}=r,t=mt(),{data:u=null,isFetched:b}=O(),h=Y.isFeatureEnabled("kill-phantom-validator"),[a,m]=(0,U.useState)(""),y=X(a),k=(0,U.useMemo)(()=>{let A=i.map(T=>({...T,totalApy:u?B(u,T?.commission):null})),S=t.data??[];if(S.length===0)return A;let z=A.sort(st(S));return h?z.filter(T=>T.identityPubkey!==it.identityPublicKey):z},[i,t.data,u,h]),w=tt(k,y||"",rt),d=(0,U.useCallback)(()=>{r.isError&&!r.isFetching&&r.refetch(),t.isError&&!t.isFetching&&t.refetch()},[t,r]),p=!r.isFetched||!b||!t.isFetched,f=r.isError||t.isError,D=r.isSuccess;return{isLoading:p,isSuccess:D,hasError:f,searchResults:w,showApy:u!==null,onRefetch:d,searchTerm:a,setSearchTerm:m}}o();n();function _({stakePubkey:e,authorizedPubkey:r,votePubkey:i}){return s.StakeProgram.delegate({stakePubkey:e,authorizedPubkey:r,votePubkey:i})}var gt=e=>{let{t:r}=g(),i=v(),t=R(),{mutateAsync:u}=F(e);return x({mutationFn:async({accountIdentifier:a,senderAddress:m,stakePubkey:y,authorizedPubkey:k,votePubkey:w})=>{if(!m)throw K;let{networkID:d,address:p}=m,f=_({stakePubkey:y,authorizedPubkey:k,votePubkey:w}),D=await C(f,{connection:e}),A={ownerAddress:p??"",networkID:d,data:{signature:""},type:"delegateStake",display:{summary:{topLeft:{text:r("transactionsPendingDelegatingStake")}}}};t.approved({chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),type:"delegate"});let S=await u({accountIdentifier:a,feePayer:new s.PublicKey(p),transaction:D,pendingTransactionInput:A});return t.submittedTransaction(S,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),method:"signAndSendTransaction"}),{networkID:d,id:S??""}},onSuccess:a=>{V({connection:e,signature:a.id}).then(()=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"confirmed"}})}).catch(m=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"error"}}),N.captureError(m,"staking")}),E(e,a.id,i)}})};o();n();function ht({stakePubkey:e,authorizedPubkey:r,amount:i,transaction:t=new L.Transaction}){return t.add(s.StakeProgram.withdraw({stakePubkey:e,authorizedPubkey:r,toPubkey:r,lamports:i})),t}var wt=e=>{let{t:r}=g(),i=v(),t=R(),{mutateAsync:u}=F(e);return x({mutationFn:async({accountIdentifier:a,senderAddress:m,stakePubkey:y,authorizedPubkey:k,amount:w})=>{if(!m)throw K;let{networkID:d,address:p}=m,f=ht({stakePubkey:y,authorizedPubkey:k,amount:w}),D=await C(f,{connection:e}),A={ownerAddress:p??"",networkID:d,data:{signature:""},type:"withdrawStake",display:{summary:{topLeft:{text:r("transactionsPendingWithdrawingStake")}}}};t.approved({chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),type:"withdraw"});let S=await u({accountIdentifier:a,feePayer:new s.PublicKey(p),transaction:D,pendingTransactionInput:A});return t.submittedTransaction(S,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(d),method:"signAndSendTransaction"}),{networkID:d,id:S??""}},onSuccess:a=>{V({connection:e,signature:a.id}).then(()=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"confirmed"}})}).catch(m=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"error"}}),N.captureError(m,"staking")}),E(e,a.id,i)}})};o();n();function Dt({ownerPublicKey:e,lamports:r,transaction:i=new L.Transaction}){let t=s.Keypair.generate();return i.add(s.StakeProgram.createAccount({fromPubkey:e,stakePubkey:t.publicKey,authorized:new s.Authorized(e,e),lamports:r})),[i,t]}function Tt({lamports:e,votePubkey:r,authorizedPubkey:i}){let[t,u]=Dt({ownerPublicKey:i,lamports:e});return t.add(_({stakePubkey:u.publicKey,authorizedPubkey:i,votePubkey:r})),[t,u]}var bt=e=>{let{t:r}=g(),i=v(),t=R(),{mutateAsync:u}=F(e);return x({mutationFn:async({accountIdentifier:a,senderAddress:m,lamports:y,votePubkey:k,authorizedPubkey:w,usdPerSol:d})=>{if(!m)throw K;let{networkID:p,address:f}=m,[D,A]=Tt({accountIdentifier:a,senderAddress:m,lamports:y,votePubkey:k,authorizedPubkey:w}),S=await C(D,{connection:e}),z={ownerAddress:f??"",networkID:p,data:{signature:""},type:"createAccountAndDelegateStake",display:{summary:{topLeft:{text:r("transactionsPendingCreatingAndDelegatingStake")}}}};t.approved({chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(p),type:"delegate"});let T=await u({accountIdentifier:a,feePayer:new s.PublicKey(f),transaction:S,pendingTransactionInput:z,opts:{additionalSignerAccounts:[A]}});t.submittedTransaction(T,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(p),method:"signAndSendTransaction"});let H=q(y),ft=d?H.times(d):void 0;return t.createStakeAccountAndDelegateStake({sol:H.toNumber(),usd:ft?.toNumber(),voteAccountPubkey:k}),{networkID:p,id:T??""}},onSuccess:a=>{V({connection:e,signature:a.id}).then(()=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"confirmed"}})}).catch(m=>{t.transactionStatus(a.id,{chainType:"solana",chainName:"solana",networkId:c.getSolanaNetworkIDValue(a.networkID),status:{type:"error"}}),N.captureError(m,"staking")}),E(e,a.id,i)}})};o();n();o();n();var St=I(P());o();n();var Nt=I(P());o();n();var yt=I(P());function kt({navigateToConvertStakeAccount:e}){let{t:r}=g(),{pickedLSTProvider:i}=Q(c.solana.mainnetID),t=i($,!0),{hasConvertibleStakeAccounts:u}=nt(t),b=r("convertToPhantomLST"),h=(0,yt.useCallback)(()=>{e()},[e]);return{shouldShowLiquidStakingCTA:u,title:b,onPress:h}}o();n();var It=I(P());o();n();var Pt=I(P());o();n();export{At as a,kt as b,gt as c,wt as d,bt as e};
//# sourceMappingURL=chunk-DGD53LCE.js.map
