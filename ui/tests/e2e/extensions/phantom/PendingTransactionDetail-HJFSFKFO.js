import{a as R,c as Ve}from"./chunk-LRFHH3ZB.js";import{b as xe}from"./chunk-77HJ74OI.js";import{a as Ge}from"./chunk-6FQCFTF7.js";import"./chunk-6VBZ34UF.js";import{s as Z,u as Ne,w as Ae,ya as He}from"./chunk-ZPSIMYUC.js";import"./chunk-3W7DN42P.js";import"./chunk-66RATSMU.js";import"./chunk-3CN4PSQF.js";import{s as k}from"./chunk-N6BAVOMX.js";import"./chunk-BV3TS4XT.js";import"./chunk-MSKCA54N.js";import"./chunk-WIVKFT3Y.js";import"./chunk-2DLZSCTQ.js";import"./chunk-DGD53LCE.js";import"./chunk-SAN2LWG5.js";import"./chunk-JVLGNGOV.js";import"./chunk-EMDZTJKZ.js";import"./chunk-26BEY7UU.js";import"./chunk-KHFCJUHU.js";import"./chunk-75HMBX3C.js";import{g as O}from"./chunk-3JMYJD4J.js";import"./chunk-FLIG3OXX.js";import{a as de}from"./chunk-IRT22BM2.js";import{a as Be}from"./chunk-GDHNPAWS.js";import"./chunk-QCUZPSGD.js";import"./chunk-4NOCLPPV.js";import"./chunk-HRUBPS3N.js";import{c as Fe}from"./chunk-G46R4HGO.js";import{P as Te,tc as Ue}from"./chunk-QY5YIVDQ.js";import"./chunk-MUAOONPW.js";import"./chunk-BY77CZR3.js";import"./chunk-CEYX4EEL.js";import"./chunk-Q2MU5Q7Q.js";import"./chunk-CCUQPG33.js";import{$ as W,B as Q,F as De,G as ke,P as ve,W as ce,Z as be,x as Se}from"./chunk-IHXFHG2Y.js";import"./chunk-JAQNMSBC.js";import"./chunk-MYAJJRTU.js";import"./chunk-EBUZAGLB.js";import{sa as Ie}from"./chunk-QCKHHJ5F.js";import"./chunk-HPK5Q66L.js";import"./chunk-MEINW66A.js";import"./chunk-QMDPT5WS.js";import"./chunk-PQHYTRV5.js";import{a as Y,d as L}from"./chunk-Y6JOYO4T.js";import{B as pe,R as Me,db as S,m as f,p as le,q as me}from"./chunk-FABKKW5E.js";import"./chunk-ZWNJSFU4.js";import"./chunk-MZPVJTUS.js";import"./chunk-JSLOSOZX.js";import"./chunk-GCJPSL4T.js";import"./chunk-RY7HN3SK.js";import{a as Ee,c as $}from"./chunk-YI2NXTPE.js";import"./chunk-TCB6NDII.js";import{$ as H,f as A,h as G,n as V}from"./chunk-R5GARSZH.js";import"./chunk-F24UB3BO.js";import{$a as N}from"./chunk-VOCOWPRG.js";import{Kb as we,R as Pe,Rb as z,_a as ne}from"./chunk-F63TUCMM.js";import"./chunk-CJHTJRVG.js";import{Pc as J,Pd as it,Zb as P}from"./chunk-PJ6PRBE2.js";import{S as q,u as se}from"./chunk-DHKCVHRA.js";import{X as F,c as ae,cb as X,ya as s}from"./chunk-UTOBJRXZ.js";import"./chunk-3Q6WUW5S.js";import"./chunk-I5GRDOQ7.js";import"./chunk-3KRCODTN.js";import{f as oe,h as I,n as U}from"./chunk-SVG5OEFH.js";I();U();var a=oe(ae());I();U();I();U();var T=oe(ae());var st=f.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: scroll;
`,ct=f.div`
  flex: 1;
  padding-top: 20px;
  padding-bottom: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
`,lt=f(S)`
  margin-top: 20px;
  margin-bottom: 20px;
`,mt=f(S)`
  margin-top: 16px;
`,pt=f.div`
  margin-top: 16px;
  padding-bottom: 20px;
`,Le=({pendingTransaction:e,onSuccess:i})=>{let{t:o}=F(),[g,n]=(0,T.useState)(void 0),{popDetailView:u}=O(),t=e.networkID,p=P.getAddressType(t),M=e.data.transactions[e.data.transactions.length-1],{data:c}=N(),{data:r,status:v}=ce(e,()=>u(),c),{data:y}=Q(t,r),w=y?.gasEstimationPriceUSD??"",{data:D}=H(),B=[];if(D){let x=D.explorers[t]??A.get(t).defaultExplorer,d=V({networkID:t,endpoint:"transaction",explorerType:x,param:M.hash});d!==""&&B.push({label:o("richTransactionDetailViewOnExplorer",{explorer:G[x]}),value:d,type:"link"})}let{data:b,status:_}=W(t,r?.maxFeePerGas,r?.maxPriorityFeePerGas),h=z(o,_,b),E=[{label:o("richTransactionDetailNetworkFee"),value:w.length>0?o("gasUpTo",{amount:w}):T.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},{label:o("transactionEstimatedTime"),value:h!==""?h:T.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},...B],{mutateAsync:C}=xe(),ee=(0,T.useCallback)(async()=>{if(!c||!r)return;let x=c.addresses.find(d=>d.networkID===t);if(x){e.type==="cancel"?$.capture("transactionPrioritizeCancelConfirmClicked",{data:{chainID:t,chainType:p}}):$.capture("transactionCancelConfirmClicked",{data:{chainID:t,chainType:p}});try{n("inflight");let d=Ie({ethereumNetworkID:t,sender:x.address,destination:x.address,value:new q("0",10),nonce:e.data.nonce});await C({multichainTransaction:{networkID:t,unsignedTransaction:d},pendingTransactionInput:{networkID:t,pendingTransactionId:e.id,hash:"",unsignedTransaction:se.parse({from:e.ownerAddress})},senderAddress:x,gasEstimation:r}),u(),i(),n(void 0)}catch(d){J.captureError(d,"transaction"),n("error")}}},[c,t,p,e,r,C,u,i]);return T.default.createElement(st,null,T.default.createElement(ct,null,T.default.createElement(Ne,{image:{type:"icon",preset:"x-bold"},size:64}),T.default.createElement(lt,{size:28,weight:600},e.type==="cancel"?o("transactionPrioritizeCancel"):o("transactionCancel")),T.default.createElement(R,{rows:E}),g!=="error"&&T.default.createElement(mt,{lineHeight:16,color:s.colors.legacy.textDiminished,size:14},o("transactionCancelHelperText")),g==="error"&&T.default.createElement(pt,null,T.default.createElement(Z,{color:s.colors.legacy.spotNegative,title:T.default.createElement(S,{color:s.colors.legacy.spotNegative,lineHeight:16,size:14,weight:400},o("transactionReplaceError"))}))),T.default.createElement(L,{onSecondaryClicked:()=>u(),onPrimaryClicked:ee,primaryTheme:"warning",primaryText:g==="inflight"?T.default.createElement(Y,{trackColor:s.colors.legacy.spotNegative,color:"white",diameter:20}):o("commandConfirm"),primaryDisabled:!r?.maxFeePerGas||v==="error",secondaryText:o("commandClose")}))};I();U();var Oe=oe(it()),l=oe(ae());var ft=f.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: scroll;
`,ut=f.div`
  flex: 1;
  padding-top: 20px;
  padding-bottom: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
`,gt=f(S)`
  margin-top: 20px;
  margin-bottom: 20px;
`,Tt=f(S)`
  margin-top: 16px;
`,xt=f.div`
  margin-top: 16px;
  padding-bottom: 20px;
`,ht=({size:e})=>l.default.createElement(me,{size:e},l.default.createElement(le,{shape:"circle",color:de(s.colors.legacy.spotPositive,.1)},l.default.createElement(pe,{width:32}))),_e=({pendingTransaction:e,onSuccess:i})=>{let{t:o}=F(),[g,n]=(0,l.useState)(void 0),{popDetailView:u}=O(),t=e.networkID,{data:p}=N(),{data:M,status:c}=Se({networkID:t}),r=M?.fast,v=ne.get(t).transactionSpeedSeconds("fast"),{data:y}=H(),w=[];if(y){let h=y.explorers[t]??A.get(t).defaultExplorer,E=V({networkID:t,endpoint:"transaction",explorerType:h,param:e.data.txID});E!==""&&w.push({label:o("richTransactionDetailViewOnExplorer",{explorer:G[h]}),value:E,type:"link"})}let D=z(o,c,v?{timeToMineSeconds:v}:void 0),B=[{label:o("richTransactionDetailNetworkFee"),value:r?`${Pe(r.btcPerKilobyte)} sats/vB`:l.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},{label:o("transactionEstimatedTime"),value:D!==""?D:l.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},...w],b=ve(),_=(0,l.useCallback)(async()=>{if(!p||!r?.btcPerKilobyte)return;let h=p.addresses.filter(C=>C.networkID===t),E=h[0];h.length>1&&(E=h.find(C=>C.addressType==="bip122_p2wpkh")),$.capture("transactionSpeedUpConfirmClicked",{data:{chainID:t}});try{n("inflight"),await we(Ue(),{addressType:E.addressType,accountIdentifier:p.identifier,pendingTransaction:e,pendingTransactionInput:{...(0,Oe.default)(e)},desiredFeeRateInBtcPerKilobyte:r.btcPerKilobyte,safeToSendUtxos:await b.getSafeToSendUtxos(E.address),utxoManager:b},new Ee),u(),i(),n(void 0)}catch(C){J.captureError(C,"transaction"),n("error")}},[p,t,e,r?.btcPerKilobyte,u,i,b]);return l.default.createElement(ft,null,l.default.createElement(ut,null,l.default.createElement(ht,{size:64}),l.default.createElement(gt,{size:28,weight:600},o("transactionSpeedUp")),l.default.createElement(R,{rows:B}),g!=="error"&&l.default.createElement(Tt,{lineHeight:16,color:s.colors.legacy.textDiminished,size:14},o("transactionSpeedUplHelperText")),g==="error"&&l.default.createElement(xt,null,l.default.createElement(Z,{color:s.colors.legacy.spotNegative,title:l.default.createElement(S,{color:s.colors.legacy.spotNegative,lineHeight:16,size:14,weight:400},o("transactionReplaceError"))}))),l.default.createElement(L,{onSecondaryClicked:()=>u(),onPrimaryClicked:_,primaryText:g==="inflight"?l.default.createElement(Y,{color:"white",diameter:20}):o("commandConfirm"),primaryDisabled:c==="error"&&!r?.btcPerKilobyte,secondaryText:o("commandClose")}))};I();U();var m=oe(ae());var yt=f.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: scroll;
`,Ct=f.div`
  flex: 1;
  padding-top: 20px;
  padding-bottom: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
`,Pt=f(S)`
  margin-top: 20px;
  margin-bottom: 20px;
`,wt=f(S)`
  margin-top: 16px;
`,Et=f.div`
  margin-top: 16px;
  padding-bottom: 20px;
`,St=({size:e})=>m.default.createElement(me,{size:e},m.default.createElement(le,{shape:"circle",color:de(s.colors.legacy.spotPositive,.1)},m.default.createElement(pe,{width:32}))),Ke=({pendingTransaction:e,onSuccess:i})=>{let{t:o}=F(),[g,n]=(0,m.useState)(void 0),{popDetailView:u}=O(),t=e.networkID,p=P.getAddressType(t),M=e.data.transactions[e.data.transactions.length-1],{data:c}=N(),{data:r,status:v}=ce(e,()=>u(),c),{data:y}=Q(t,r),w=y?.gasEstimationPriceUSD??"",{data:D}=H(),B=[];if(D){let x=D.explorers[t]??A.get(t).defaultExplorer,d=V({networkID:t,endpoint:"transaction",explorerType:x,param:M.hash});d!==""&&B.push({label:o("richTransactionDetailViewOnExplorer",{explorer:G[x]}),value:d,type:"link"})}let{data:b,status:_}=W(t,r?.maxFeePerGas,r?.maxPriorityFeePerGas),h=z(o,_,b),E=[{label:o("richTransactionDetailNetworkFee"),value:w.length>0?o("gasUpTo",{amount:w}):m.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},{label:o("transactionEstimatedTime"),value:h!==""?h:m.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished})},...B],{mutateAsync:C}=be(),ee=(0,m.useCallback)(async()=>{if(!(!c||!r||!c.addresses.find(d=>d.networkID===t))){$.capture("transactionSpeedUpConfirmClicked",{data:{chainID:t,chainType:p}});try{n("inflight"),await C({chainType:"eip155",accountIdentifier:c.identifier,pendingTransaction:e,pendingTransactionInput:{networkID:t,pendingTransactionId:e.id,hash:"",unsignedTransaction:se.parse({from:e.ownerAddress})},gasEstimation:r,nonce:e.data.nonce}),u(),i(),n(void 0)}catch(d){J.captureError(d,"transaction"),n("error")}}},[c,t,p,e,r,C,i,u]);return m.default.createElement(yt,null,m.default.createElement(Ct,null,m.default.createElement(St,{size:64}),m.default.createElement(Pt,{size:28,weight:600},o("transactionSpeedUp")),m.default.createElement(R,{rows:E}),g!=="error"&&m.default.createElement(wt,{lineHeight:16,color:s.colors.legacy.textDiminished,size:14},o("transactionSpeedUplHelperText")),g==="error"&&m.default.createElement(Et,null,m.default.createElement(Z,{color:s.colors.legacy.spotNegative,title:m.default.createElement(S,{color:s.colors.legacy.spotNegative,lineHeight:16,size:14,weight:400},o("transactionReplaceError"))}))),m.default.createElement(L,{onSecondaryClicked:()=>u(),onPrimaryClicked:ee,primaryText:g==="inflight"?m.default.createElement(Y,{color:"white",diameter:20}):o("commandConfirm"),primaryDisabled:!r?.maxFeePerGas||v==="error",secondaryText:o("commandClose")}))};var Dt=e=>{let{networkID:i}=e,[o,g]=(0,a.useState)(Date.now());(0,a.useEffect)(()=>{let K=setInterval(()=>g(Date.now()),5e3);return()=>clearInterval(K)},[g]);let{t:n}=F(),{pushDetailView:u}=O(),{handleHideModalVisibility:t}=He(),p=(0,a.useCallback)(()=>t("pendingTransaction"),[t]),{data:M}=N(),{data:c}=ke(M?.addresses||[]),r=c?.pendingTransaction.filter(K=>e.networkID===K.networkID),v=r?r[r.length-1]?.id:void 0,y=ne.get(e.networkID).isPendingTransactionConfirmed(e),w=!1,D=e.type??"dappInteraction",B=Ge(e.timestamp??0,n("richTransactionDetailAt")),{header:b,assetSymbol:_,tokenUSDPrice:h,uiRecipient:E,logoUri:C}=(0,a.useMemo)(()=>({header:e.display.detail?.header??"",assetSymbol:e.display.detail?.assetSymbol??"",tokenUSDPrice:e.display.detail?.tokenUSDPrice??"",uiRecipient:e.display.detail?.uiRecipient??"",logoUri:e.display.detail?.logoUri??""}),[e]),ee=P.getNetworkName(i),x="",d=s.colors.legacy.textDiminished;y?w?(x=n("transactionsFailed"),d=s.colors.legacy.spotNegative):(x=n("transactionsSuccess"),d=s.colors.legacy.spotPositive):e.type==="cancel"?(x=n("pendingTransactionCancelling"),d=s.colors.legacy.spotNegative):x=n("pendingTransactionPending");let te;if("transactions"in e.data&&P.isEVMNetworkID(i)){let j=e.data.transactions[e.data.transactions.length-1].unsignedTransaction,ie=new q(j.maxFeePerGas??"0"),rt=new q(j.maxPriorityFeePerGas??"0");te={networkID:i,gasLimit:new q(j.gas??"0"),maxFeePerGas:ie,maxPriorityFeePerGas:rt},w=!!e.data?.transactions?.[e.data?.transactions?.length-1]?.error}let{data:je}=Q(i,te),Xe=n("gasUpTo",{amount:je?.gasEstimationPriceUSD}),{data:$e,status:qe}=W(i,te?.maxFeePerGas,te?.maxPriorityFeePerGas),he=z(n,qe,$e),{data:ye}=H(),Ce=[];if(ye){let K=ye.explorers[i]??A.get(i).defaultExplorer,j="";P.isEVMNetworkID(e.networkID)&&"transactions"in e.data&&(j=e.data.transactions[e.data.transactions.length-1].hash),P.isBitcoinNetworkID(e.networkID)&&(j=e.data.txID);let ie=V({networkID:i,endpoint:"transaction",explorerType:K,param:j});ie!==""&&Ce.push({label:n("richTransactionDetailViewOnExplorer",{explorer:G[K]}),value:ie,type:"link"})}let Je=P.getNetworkName(i),Qe={label:n("pendingTransactionDate"),value:B},We={label:n("pendingTransactionStatus"),value:x,color:d},Ye={label:n("transactionsTo"),value:E??""},Ze={label:n("historyNetwork"),value:ee},Re={label:n("pendingTransactionNetworkFee"),value:Xe,tooltipContent:n("networkFeesTooltipDescription",{chainName:Je})},et={label:n("pendingTransactionEstimatedTime"),value:he!==""?he:a.default.createElement(k,{width:"75px",height:"8px",borderRadius:"8px",backgroundColor:s.colors.legacy.borderDiminished}),tooltipContent:n("sendFungibleSummaryEstimatedTimeDescription")},ue=a.default.createElement(Ae,{pendingTransactionType:D,isError:w,isConfirmed:y,logoUri:C,size:"medium"}),re,tt=!y&&Te.get(i).showFeeRowInPendingTransactionDetail,ot=Te.get(i).showTimeToMineRowInPendingTransactionDetail&&!y,nt=e.display.detail?.secondaryHeader,ge=[Qe,We,Ye,Ze,...tt?[Re]:[],...ot?[et]:[],...Ce];switch(D){case"send":{re={sections:[{rows:ge}],title:y?n("richTransactionDetailSent"):n("pendingTransactionsSendingTitle",{assetSymbol:_}),primaryText:{value:b},secondaryText:{value:h},image:ue};break}case"cancel":{re={sections:[{rows:ge}],title:n(y?"transactionCancelled":"pendingTransactionCancelling"),primaryText:{value:b},secondaryText:{value:h},image:ue};break}case"dappInteraction":default:{re={sections:[{rows:ge}],title:n(y?"richTransactionDetailAppInteraction":"pendingTransactionPendingInteraction"),primaryText:{value:""},secondaryText:{value:nt??n("pendingTransactionUnknownApp")},image:ue};break}}return{detailsProps:re,pendingTransaction:e,isOldestPendingTx:v===e.id,leftButton:a.default.createElement(kt,{onClick:p},a.default.createElement(Me,null)),showCancelEvmTransactionModal:()=>{u(a.default.createElement(Le,{onSuccess:p,pendingTransaction:e}))},showSpeedUpEvmTransactionModal:()=>{u(a.default.createElement(Ke,{onSuccess:p,pendingTransaction:e}))},showSpeedUpBitcoinTransactionModal:()=>{u(a.default.createElement(_e,{onSuccess:p,pendingTransaction:e}))},hidePendingTransactionModal:p,now:o}},kt=f(Fe)`
  position: absolute;
  left: 5px;
`,vt=({pendingTransaction:e})=>{let i=Dt(e);return a.default.createElement(It,{...i})},bt=({pendingTransactionId:e})=>{let{data:i}=De(e),[o,g]=(0,a.useState)();return(0,a.useEffect)(()=>{i&&g(i)},[i]),o?a.default.createElement(vt,{pendingTransaction:o}):null},Nn=bt,It=a.default.memo(({detailsProps:e,showCancelEvmTransactionModal:i,showSpeedUpEvmTransactionModal:o,showSpeedUpBitcoinTransactionModal:g,hidePendingTransactionModal:n,leftButton:u,pendingTransaction:t,isOldestPendingTx:p,now:M})=>{let{t:c}=F(),r=a.default.createElement(X,{onClick:n},c("commandClose"));if(t&&(p||t.type!=="cancel")&&!ne.get(t.networkID).isPendingTransactionMined(t)){if(P.isPolygonNetworkID(t.networkID)){t=t;let v=t.data.transactions[t.data.transactions.length-1];M-v.timestamp>6e4&&(t.type==="cancel"?r=a.default.createElement(X,{theme:"warning",onClick:i},c("transactionPrioritizeCancel")):r=a.default.createElement(X,{theme:"warning",onClick:i},c("pendingTransactionCancel")))}P.isEthereumNetworkID(t.networkID)&&(t.type==="cancel"?r=a.default.createElement(X,{theme:"warning",onClick:i},c("transactionPrioritizeCancel")):p?r=a.default.createElement(L,{primaryText:c("pendingTransactionSpeedUp"),secondaryText:c("pendingTransactionCancel"),onPrimaryClicked:o,onSecondaryClicked:i,primaryTheme:"default",secondaryTheme:"warning"}):r=a.default.createElement(X,{theme:"warning",onClick:i},c("pendingTransactionCancel"))),P.isBitcoinNetworkID(t.networkID)&&(r=a.default.createElement(X,{onClick:g},c("pendingTransactionSpeedUp")))}return a.default.createElement(a.default.Fragment,null,a.default.createElement(Ve,{...e,leftButton:u}),a.default.createElement(Be,null,r))});export{bt as PendingTransactionDetail,Nn as default};
//# sourceMappingURL=PendingTransactionDetail-HJFSFKFO.js.map
